"use strict";(globalThis.webpackChunkdocusaurus=globalThis.webpackChunkdocusaurus||[]).push([[6529],{28453:(e,i,t)=>{t.d(i,{R:()=>o,x:()=>l});var n=t(96540);const a={},s=n.createContext(a);function o(e){const i=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),n.createElement(s.Provider,{value:i},e.children)}},36864:e=>{e.exports=JSON.parse('{"permalink":"/suggested-site/blog/2021/12/21/apache-ignite-2-11-1","editUrl":"https://github.com/apache/ignite-website/tree/master/blog/2021-12-21-apache-ignite-2-11-1.mdx","source":"@site/blog/2021-12-21-apache-ignite-2-11-1.mdx","title":"Apache Ignite 2.11.1: Emergency Log4j2 Update","description":"The new Apache Ignite 2.11.1 is an emergency release that fixes CVE-2021-44228, CVE-2021-45046, CVE-2021-45105 related to the ignite-log4j2 module usage.","date":"2021-12-21T00:00:00.000Z","tags":[{"inline":true,"label":"database","permalink":"/suggested-site/blog/tags/database"},{"inline":true,"label":"ignite","permalink":"/suggested-site/blog/tags/ignite"},{"inline":true,"label":"in-memory","permalink":"/suggested-site/blog/tags/in-memory"},{"inline":true,"label":"log4j2","permalink":"/suggested-site/blog/tags/log-4-j-2"},{"inline":true,"label":"open-source","permalink":"/suggested-site/blog/tags/open-source"},{"inline":true,"label":"release","permalink":"/suggested-site/blog/tags/release"},{"inline":true,"label":"archived","permalink":"/suggested-site/blog/tags/archived"}],"readingTime":2.14,"hasTruncateMarker":true,"authors":[{"name":"Maxim Muzafarov","title":"Apache Ignite Committer","url":"https://github.com/mmuzaf","imageURL":"/suggested-site/img/authors/mmuzaf.png","key":"maxim","page":null}],"frontMatter":{"title":"Apache Ignite 2.11.1: Emergency Log4j2 Update","authors":["maxim"],"date":"2021-12-21T00:00:00.000Z","tags":["database","ignite","in-memory","log4j2","open-source","release","archived"]},"unlisted":false,"prevItem":{"title":"Apache Ignite 2.12.0: CDC, Index Query API, Vulnerabilities Fixes","permalink":"/suggested-site/blog/2022/01/14/apache-ignite-2-12-0"},"nextItem":{"title":"Apache Ignite 2.11: Stabilization First","permalink":"/suggested-site/blog/2021/09/20/apache-ignite-2-11-stabilization"}}')},85149:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>d});var n=t(36864),a=t(74848),s=t(28453);const o={title:"Apache Ignite 2.11.1: Emergency Log4j2 Update",authors:["maxim"],date:new Date("2021-12-21T00:00:00.000Z"),tags:["database","ignite","in-memory","log4j2","open-source","release","archived"]},l=void 0,r={authorsImageUrls:[void 0]},d=[{value:"Apache Ignite with Log4j Vulnerability",id:"apache-ignite-with-log4j-vulnerability",level:3},{value:"Risk Mitigation Without Upgrading",id:"risk-mitigation-without-upgrading",level:3},{value:"Method 1: Removing the Vulnerable Classes",id:"method-1-removing-the-vulnerable-classes",level:4},{value:"Method 2: Disabling Message Lookups",id:"method-2-disabling-message-lookups",level:4},{value:"Method 3: Replace log4j2 Dependency Manually",id:"method-3-replace-log4j2-dependency-manually",level:4}];function c(e){const i={a:"a",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.p,{children:["The new ",(0,a.jsx)(i.a,{href:"https://ignite.apache.org/",children:"Apache Ignite"})," 2.11.1 is an emergency release that fixes ",(0,a.jsx)(i.a,{href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228",children:"CVE-2021-44228"}),", ",(0,a.jsx)(i.a,{href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046",children:"CVE-2021-45046"}),", ",(0,a.jsx)(i.a,{href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45105",children:"CVE-2021-45105"})," related to the ignite-log4j2 module usage."]}),"\n",(0,a.jsx)(i.h3,{id:"apache-ignite-with-log4j-vulnerability",children:"Apache Ignite with Log4j Vulnerability"}),"\n",(0,a.jsx)(i.p,{children:"All the following conditions must be met:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:"The Apache Ignite version lower than 2.11.0 is used (since these vulnerabilities are already fixed in 2.11.1, 2.12, and upper versions);"}),"\n",(0,a.jsxs)(i.li,{children:["The ",(0,a.jsx)(i.code,{children:"ignite-logj42"})," is used by Apache Ignite and located in the ",(0,a.jsx)(i.code,{children:"libs"})," directory (by default it is located in the ",(0,a.jsx)(i.code,{children:"libs/optional"})," directory, so these deployments are not affected);"]}),"\n",(0,a.jsxs)(i.li,{children:["The Java version in use is older than the following versions: ",(0,a.jsx)(i.code,{children:"8u191"}),", ",(0,a.jsx)(i.code,{children:"11.0.1"}),". This is due to the fact that later versions set the JVM property ",(0,a.jsx)(i.code,{children:"com.sun.jndi.ldap.object.trustURLCodebase"})," to ",(0,a.jsx)(i.code,{children:"false"})," by default, which disables JNDI loading of classes from arbitrary URL code bases."]}),"\n"]}),"\n",(0,a.jsx)(i.p,{children:"NOTE: Relying only on the Java version as a protection against these vulnerabilities is very risky and has not been tested."}),"\n",(0,a.jsx)(i.h3,{id:"risk-mitigation-without-upgrading",children:"Risk Mitigation Without Upgrading"}),"\n",(0,a.jsx)(i.p,{children:"Please note that all of these cases require a cluster downtime, but we still recommend to upgrade the Apache Ignite."}),"\n",(0,a.jsx)(i.h4,{id:"method-1-removing-the-vulnerable-classes",children:"Method 1: Removing the Vulnerable Classes"}),"\n",(0,a.jsx)(i.p,{children:"When using an older Apache Ignite version, it is possible to remove the JndiLookup class from any Java application by executing this command:"}),"\n",(0,a.jsx)(i.pre,{children:(0,a.jsx)(i.code,{children:'find $IGNITE_HOME/ -type f -name "*log4j-core-*.jar" -exec zip -q -d "{}" org/apache/logging/log4j/core/lookup/JndiLookup.class \\;\n'})}),"\n",(0,a.jsxs)(i.p,{children:["This will recursively find all log4j-core JAR files, starting from the ",(0,a.jsx)(i.code,{children:"IGNITE_HOME"})," directory, and remove the vulnerable JndiLookup class from them."]}),"\n",(0,a.jsx)(i.h4,{id:"method-2-disabling-message-lookups",children:"Method 2: Disabling Message Lookups"}),"\n",(0,a.jsxs)(i.p,{children:["This method can be used as an additional protection layer in case you suspect not all log4j dependencies have been properly updated. If you are using the Apache Ignite of an older version, we recommend to disable message lookups globally by setting the environment variable ",(0,a.jsx)(i.code,{children:"LOG4J_FORMAT_MSG_NO_LOOKUPS"})," to ",(0,a.jsx)(i.code,{children:"true"})," or, alternatively, run the Apache Ignite with the ",(0,a.jsx)(i.code,{children:"-Dlog4j2.formatMsgNoLookups=true"})," command-line option."]}),"\n",(0,a.jsx)(i.h4,{id:"method-3-replace-log4j2-dependency-manually",children:"Method 3: Replace log4j2 Dependency Manually"}),"\n",(0,a.jsx)(i.p,{children:"It is still possible to manually replace the Log4j of 2.x version in the Apache Ignite binary distribution to the 2.17.0 Log4j version if your log configuration does not imply to use the RoutingAppender. In case the RoutingAppender is used it may produce some error messages in a log file at the startup or empty lines during the execution, which are considered as a minor flow, however, we do not recommend this mitigation method in this case."})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,a.jsx)(i,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);