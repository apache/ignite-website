"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[5083],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var i=t(96540);const o={},r=i.createContext(o);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(r.Provider,{value:n},e.children)}},29292:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>g,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"getting-started/best-practices","title":"Configuration Tips","description":"Configuring Default Cluster Storage","source":"@site/docs/getting-started/best-practices.md","sourceDirName":"getting-started","slug":"/getting-started/best-practices","permalink":"/suggested-site/docs/3.1.0/getting-started/best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ignite-3/tree/main/docs/docs/getting-started/best-practices.md","tags":[],"version":"current","frontMatter":{"title":"Configuration Tips"},"sidebar":"tutorialSidebar","previous":{"title":"Embedded Mode","permalink":"/suggested-site/docs/3.1.0/getting-started/embedded-mode"},"next":{"title":"Migrating from Ignite 2","permalink":"/suggested-site/docs/3.1.0/getting-started/migrate-from-ignite-2"}}');var o=t(74848),r=t(28453);const a={title:"Configuration Tips"},s=void 0,l={},d=[{value:"Configuring Default Cluster Storage",id:"configuring-default-cluster-storage",level:2},{value:"Configuring Local Paths",id:"configuring-local-paths",level:2},{value:"Configuring Heap Usage",id:"configuring-heap-usage",level:2},{value:"Configuring Server Logging",id:"configuring-server-logging",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"configuring-default-cluster-storage",children:"Configuring Default Cluster Storage"}),"\n",(0,o.jsx)(n.p,{children:"When a cluster is created, the default distribution zone is used for storage configuration. While we recommend creating distribution zones for your clusters, you can still use the default zone and configure it to suit your needs."}),"\n",(0,o.jsxs)(n.p,{children:["To get default storage configuration, use the ",(0,o.jsx)(n.code,{children:"cluster config show ignite.zone"})," command. Below is an example of the default configuration in the JSON format."]}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsx)(n.p,{children:"In Ignite 3, you can create and maintain the configuration in either JSON or HOCON format."})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "ignite" : {\n    "zone" : {\n      "defaultDataStorage" : "aipersist",\n      "defaultDistributionZone" : {\n        "dataNodesAutoAdjustScaleDown" : 2147483647,\n        "dataNodesAutoAdjustScaleUp" : 0,\n        "dataStorage" : {\n          "dataRegion" : "default",\n          "name" : "aipersist"\n        },\n        "filter" : "$..*",\n        "partitions" : 25,\n        "replicas" : 1,\n        "zoneId" : 0\n      },\n      "distributionZones" : [ ],\n      "globalIdCounter" : 0\n    }\n  }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["To change the type of storage used for new distribution zones, change the ",(0,o.jsx)(n.code,{children:"zone.defaultDataStorage"})," value to ",(0,o.jsx)(n.code,{children:"aimem"})," or ",(0,o.jsx)(n.code,{children:"rocksDb"}),". You can also change the default data region used for new distribution zones by setting the ",(0,o.jsx)(n.code,{children:"zone.defaultDistributionZone.dataStorage.dataRegion"})," parameter. You will need to restart the cluster after changing the data region parameters."]}),"\n",(0,o.jsxs)(n.p,{children:["You can also change these properties for ",(0,o.jsx)(n.a,{href:"/docs/3.1.0/sql/reference/language-definition/distribution-zones",children:"distribution zones"})," you have created for yourself."]}),"\n",(0,o.jsxs)(n.p,{children:["You can get information about the data region by using the ",(0,o.jsx)(n.code,{children:"cluster config show ignite.aipersist"})," CLI command. Here is how the default data region may look like:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "ignite" : {\n    "checkpoint" : {\n      "checkpointDelayMillis" : 200,\n      "checkpointThreads" : 4,\n      "compactionThreads" : 4,\n      "frequency" : 180000,\n      "frequencyDeviation" : 40,\n      "logReadLockThresholdTimeoutMillis" : 0,\n      "readLockTimeoutMillis" : 10000,\n      "useAsyncFileIoFactory" : true\n    },\n    "defaultRegion" : {\n      "memoryAllocator" : {\n        "type" : "unsafe"\n      },\n      "replacementMode" : "CLOCK",\n      "size" : 268435456\n    },\n    "pageSizeBytes" : 16384,\n    "regions" : [ ]\n  }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["To change the size of the default region, use the ",(0,o.jsx)(n.code,{children:"cluster config update"})," command:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"cluster config update --url http://localhost:10300 ignite.aipersist.defaultRegion.size:9999999\n"})}),"\n",(0,o.jsx)(n.h2,{id:"configuring-local-paths",children:"Configuring Local Paths"}),"\n",(0,o.jsxs)(n.p,{children:["By default, all files generated by Ignite are stored in the installation folder. However, depending on your environment, you may need to change the path to your files. You can use the ",(0,o.jsx)(n.code,{children:"{IGNITE_HOME}\\etc\\vars.env"})," file to change the storage paths of your files. You can change paths to the following:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Work directory, where data is stored."}),"\n",(0,o.jsx)(n.li,{children:"Log folder, where logs are placed."}),"\n",(0,o.jsx)(n.li,{children:"The folder from which libraries are loaded."}),"\n",(0,o.jsx)(n.li,{children:"The configuration file that is used to set up the default node."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Additionally, in the node configuration you can set:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The location CMG information is stored to by setting the ",(0,o.jsx)(n.code,{children:"ignite.system.cmgPath"})," property."]}),"\n",(0,o.jsxs)(n.li,{children:["The location metastorage information is stored to by setting the ",(0,o.jsx)(n.code,{children:"ignite.system.metastoragePath"})," property."]}),"\n",(0,o.jsxs)(n.li,{children:["The location data partitions are stored in by setting the ",(0,o.jsx)(n.code,{children:"ignite.system.partitionsBasePath"})," property."]}),"\n",(0,o.jsxs)(n.li,{children:["The location RAFT logs are stored in by setting the ",(0,o.jsx)(n.code,{children:"ignite.system.partitionsLogPath"})," property. These logs are separate from node logs."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"configuring-heap-usage",children:"Configuring Heap Usage"}),"\n",(0,o.jsxs)(n.p,{children:["Ignite stores data in off-heap memory, reserved individually for each ",(0,o.jsx)(n.a,{href:"/docs/3.1.0/configure-and-operate/configuration/config-storage-overview",children:"storage engine"})," as required. However, Java Heap memory is still used to handle intermediary objects generated by workloads. For example:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Cluster and node metadata. This includes information about what nodes are part of the cluster, internal logs, table ",(0,o.jsx)(n.a,{href:"/docs/3.1.0/understand/core-concepts/data-partitioning#version-storage",children:"version chains"}),", what keys are locked for transactions, and all other information required for Ignite to operate normally."]}),"\n",(0,o.jsx)(n.li,{children:"Intermediary query results. This may lead to needing more heap memory when executing queries on especially large data sets."}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"/docs/3.1.0/develop/work-with-data/compute",children:"Compute"})," operations are likely to use heap memory to store data. Specific requirements for compute jobs vary depending on what job is being performed."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"By default, Ignite allocates 16GB to heap storage. Depending on your environment and workload, you may want to change this value. Smaller heap would mean faster garbage collection, and less resources allocated to Ignite. Larger heap allows to handle more objects, but garbage collection may take longer."}),"\n",(0,o.jsxs)(n.p,{children:["To configure allocated heap, you can use the ",(0,o.jsx)(n.code,{children:"JVM_MAX_MEM"})," and ",(0,o.jsx)(n.code,{children:"JVM_MIN_MEM"})," variables stored in the ",(0,o.jsx)(n.code,{children:"{IGNITE_HOME}\\etc\\vars.env"})," file. These variables are the equivalent of setting the ",(0,o.jsx)(n.code,{children:"Xmx"})," and ",(0,o.jsx)(n.code,{children:"Xms"})," variables in JVM."]}),"\n",(0,o.jsx)(n.h2,{id:"configuring-server-logging",children:"Configuring Server Logging"}),"\n",(0,o.jsxs)(n.p,{children:["By default, Ignite 3 uses the ",(0,o.jsx)(n.code,{children:"java.util.logging"})," (JUL) logging framework. It utilizes the ",(0,o.jsx)(n.code,{children:"etc/ignite.java.util.logging.properties"})," configuration and outputs logs to the folder the ",(0,o.jsx)(n.code,{children:"LOG_DIR"})," variable points to (can be configured in the ",(0,o.jsx)(n.code,{children:"etc/vars.env"})," file). By default, logs are stored in the ",(0,o.jsx)(n.code,{children:"{IGNITE_HOME}/log"})," folder. You can provide a custom configuration file using the ",(0,o.jsx)(n.code,{children:"java.util.logging.config.file"})," property."]}),"\n",(0,o.jsxs)(n.p,{children:["For more information on configuring JUL logging, see the ",(0,o.jsx)(n.a,{href:"https://docs.oracle.com/en/java/javase/11/core/java-logging-overview.html",children:"Java Logging Overview"})," in Oracle documentation."]}),"\n",(0,o.jsx)(n.admonition,{type:"note",children:(0,o.jsxs)(n.p,{children:["You can also configure client logging for the ",(0,o.jsx)(n.a,{href:"/docs/3.1.0/develop/ignite-clients/java-client",children:"Java client"}),"."]})})]})}function g(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);