"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[1411],{28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>r});var s=t(96540);const a={},i=s.createContext(a);function l(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),s.createElement(i.Provider,{value:n},e.children)}},88960:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"api-reference/native-clients/java/sql-api","title":"SQL API","description":"The SQL API executes queries and DML statements against Ignite tables. Applications use standard SQL syntax to retrieve, insert, update, and delete data. The API supports parameterized queries, prepared statements, batch operations, and result streaming.","source":"@site/docs/api-reference/native-clients/java/sql-api.md","sourceDirName":"api-reference/native-clients/java","slug":"/api-reference/native-clients/java/sql-api","permalink":"/suggested-site/docs/3.1.0/api-reference/native-clients/java/sql-api","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ignite-3/tree/main/docs/docs/api-reference/native-clients/java/sql-api.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"SQL API","id":"sql-api","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Data Streamer API","permalink":"/suggested-site/docs/3.1.0/api-reference/native-clients/java/data-streamer-api"},"next":{"title":"Transactions API","permalink":"/suggested-site/docs/3.1.0/api-reference/native-clients/java/transactions-api"}}');var a=t(74848),i=t(28453);const l={title:"SQL API",id:"sql-api",sidebar_position:5},r="SQL API",c={},d=[{value:"Key Concepts",id:"key-concepts",level:2},{value:"Basic Query Execution",id:"basic-query-execution",level:2},{value:"Prepared Statements",id:"prepared-statements",level:2},{value:"Statement Configuration",id:"statement-configuration",level:2},{value:"Result Set Processing",id:"result-set-processing",level:2},{value:"DML Operations",id:"dml-operations",level:2},{value:"DDL Operations",id:"ddl-operations",level:2},{value:"Batch Operations",id:"batch-operations",level:2},{value:"Typed Result Mapping",id:"typed-result-mapping",level:2},{value:"Asynchronous Execution",id:"asynchronous-execution",level:2},{value:"Query Cancellation",id:"query-cancellation",level:2},{value:"Transaction Integration",id:"transaction-integration",level:2},{value:"Result Set Types",id:"result-set-types",level:2},{value:"SqlRow Access",id:"sqlrow-access",level:2},{value:"Reference",id:"reference",level:2},{value:"IgniteSql Methods",id:"ignitesql-methods",level:3},{value:"Statement Configuration",id:"statement-configuration-1",level:3},{value:"Statement Builder Methods",id:"statement-builder-methods",level:3},{value:"ResultSet Methods",id:"resultset-methods",level:3},{value:"ResultSetMetadata Methods",id:"resultsetmetadata-methods",level:3},{value:"ColumnMetadata Methods",id:"columnmetadata-methods",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"sql-api",children:"SQL API"})}),"\n",(0,a.jsx)(n.p,{children:"The SQL API executes queries and DML statements against Ignite tables. Applications use standard SQL syntax to retrieve, insert, update, and delete data. The API supports parameterized queries, prepared statements, batch operations, and result streaming."}),"\n",(0,a.jsx)(n.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,a.jsx)(n.p,{children:"SQL execution operates through the IgniteSql facade. Query results stream through ResultSet cursors that must be closed to release resources. Statements configure query behavior including timeouts, schemas, and pagination."}),"\n",(0,a.jsx)(n.p,{children:"Queries execute within optional transaction contexts. Pass null for auto-commit execution or provide a Transaction for multi-statement atomicity. Query parameters use positional binding with question mark placeholders."}),"\n",(0,a.jsx)(n.h2,{id:"basic-query-execution",children:"Basic Query Execution"}),"\n",(0,a.jsx)(n.p,{children:"Execute queries with parameters:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'try (ResultSet<SqlRow> rs = ignite.sql().execute(\n    null,\n    "SELECT name, age FROM users WHERE age > ?",\n    25\n)) {\n    while (rs.hasNext()) {\n        SqlRow row = rs.next();\n        System.out.println(row.stringValue("name") + ": " + row.intValue("age"));\n    }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Always close ResultSet instances to free server resources."}),"\n",(0,a.jsx)(n.h2,{id:"prepared-statements",children:"Prepared Statements"}),"\n",(0,a.jsx)(n.p,{children:"Create prepared statements for repeated execution:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'Statement stmt = ignite.sql().createStatement(\n    "SELECT * FROM users WHERE age > ? AND status = ?"\n);\n\ntry (ResultSet<SqlRow> rs = ignite.sql().execute(\n    null,\n    stmt,\n    30,\n    "active"\n)) {\n    // Process results\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Use the statement builder for configuration:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'Statement stmt = ignite.sql().statementBuilder()\n    .query("SELECT * FROM users WHERE age > ?")\n    .defaultSchema("public")\n    .queryTimeout(30, TimeUnit.SECONDS)\n    .pageSize(1000)\n    .build();\n'})}),"\n",(0,a.jsx)(n.h2,{id:"statement-configuration",children:"Statement Configuration"}),"\n",(0,a.jsx)(n.p,{children:"Configure statement behavior through builder options:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'Statement stmt = ignite.sql().statementBuilder()\n    .query("SELECT * FROM products WHERE category = ?")\n    .defaultSchema("inventory")\n    .queryTimeout(60, TimeUnit.SECONDS)\n    .pageSize(500)\n    .timeZoneId(ZoneId.of("UTC"))\n    .build();\n\ntry (ResultSet<SqlRow> rs = ignite.sql().execute(null, stmt, "electronics")) {\n    // Process results\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"The defaultSchema setting determines table resolution when queries omit schema names. The queryTimeout parameter limits execution time. The pageSize controls result batching for large result sets."}),"\n",(0,a.jsx)(n.h2,{id:"result-set-processing",children:"Result Set Processing"}),"\n",(0,a.jsx)(n.p,{children:"Access result metadata and values:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'try (ResultSet<SqlRow> rs = ignite.sql().execute(\n    null,\n    "SELECT id, name, created FROM users"\n)) {\n    ResultSetMetadata metadata = rs.metadata();\n    System.out.println("Columns: " + metadata.columns().size());\n\n    while (rs.hasNext()) {\n        SqlRow row = rs.next();\n\n        int id = row.intValue("id");\n        String name = row.stringValue("name");\n        LocalDateTime created = row.value("created");\n\n        System.out.println(id + ": " + name + " created at " + created);\n    }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Column metadata provides type information:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'for (int i = 0; i < metadata.columns().size(); i++) {\n    ColumnMetadata col = metadata.columns().get(i);\n    System.out.println(col.name() + " " + col.type() +\n        " nullable=" + col.nullable());\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"dml-operations",children:"DML Operations"}),"\n",(0,a.jsx)(n.p,{children:"Execute insert, update, and delete statements:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'try (ResultSet<SqlRow> rs = ignite.sql().execute(\n    null,\n    "INSERT INTO users (id, name, age) VALUES (?, ?, ?)",\n    1, "Alice", 30\n)) {\n    long affected = rs.affectedRows();\n    System.out.println("Inserted " + affected + " rows");\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Check affected row counts for DML statements:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'try (ResultSet<SqlRow> rs = ignite.sql().execute(\n    null,\n    "UPDATE users SET status = ? WHERE age > ?",\n    "senior", 60\n)) {\n    System.out.println("Updated " + rs.affectedRows() + " rows");\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"ddl-operations",children:"DDL Operations"}),"\n",(0,a.jsx)(n.p,{children:"Execute schema definition statements:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'try (ResultSet<SqlRow> rs = ignite.sql().execute(\n    null,\n    "CREATE TABLE products (id INT PRIMARY KEY, name VARCHAR, price DECIMAL)"\n)) {\n    boolean applied = rs.wasApplied();\n    System.out.println("DDL applied: " + applied);\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"DDL statements return applied status rather than row counts."}),"\n",(0,a.jsx)(n.h2,{id:"batch-operations",children:"Batch Operations"}),"\n",(0,a.jsx)(n.p,{children:"Execute multiple statements with different parameters:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'BatchedArguments batch = BatchedArguments.create();\n\nbatch.add(1, "Alice");\nbatch.add(2, "Bob");\nbatch.add(3, "Carol");\n\nlong[] results = ignite.sql().executeBatch(null, "INSERT INTO users (id, name) VALUES (?, ?)", batch);\nSystem.out.println("Inserted " + results.length + " batches");\n'})}),"\n",(0,a.jsx)(n.p,{children:"Batch operations reduce network overhead for multiple similar statements."}),"\n",(0,a.jsx)(n.h2,{id:"typed-result-mapping",children:"Typed Result Mapping"}),"\n",(0,a.jsx)(n.p,{children:"Map results to custom types using mappers:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'class User {\n    public int id;\n    public String name;\n    public int age;\n}\n\ntry (ResultSet<User> rs = ignite.sql().execute(\n    null,\n    Mapper.of(User.class),\n    "SELECT id, name, age FROM users WHERE age > ?",\n    25\n)) {\n    while (rs.hasNext()) {\n        User user = rs.next();\n        System.out.println(user.name + " is " + user.age + " years old");\n    }\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"The mapper automatically converts rows to objects based on column names and field names."}),"\n",(0,a.jsx)(n.h2,{id:"asynchronous-execution",children:"Asynchronous Execution"}),"\n",(0,a.jsx)(n.p,{children:"Execute queries asynchronously:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'CompletableFuture<AsyncResultSet<SqlRow>> future = ignite.sql().executeAsync(\n    null,\n    "SELECT * FROM users WHERE age > ?",\n    30\n);\n\nfuture.thenAccept(rs -> {\n    try (rs) {\n        while (rs.hasNext()) {\n            SqlRow row = rs.next();\n            System.out.println(row.stringValue("name"));\n        }\n    }\n});\n'})}),"\n",(0,a.jsx)(n.p,{children:"Asynchronous execution returns immediately without blocking the calling thread."}),"\n",(0,a.jsx)(n.h2,{id:"query-cancellation",children:"Query Cancellation"}),"\n",(0,a.jsx)(n.p,{children:"Cancel long-running queries using cancellation handles:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'CancelHandle cancelHandle = CancelHandle.create();\n\nCompletableFuture<AsyncResultSet<SqlRow>> future = ignite.sql().executeAsync(\n    null,\n    cancelHandle.token(),\n    "SELECT * FROM large_table",\n    new Object[0]\n);\n\n// Cancel after 5 seconds\nCompletableFuture.delayedExecutor(5, TimeUnit.SECONDS)\n    .execute(cancelHandle::cancel);\n'})}),"\n",(0,a.jsx)(n.p,{children:"Cancelled queries stop execution and release resources."}),"\n",(0,a.jsx)(n.h2,{id:"transaction-integration",children:"Transaction Integration"}),"\n",(0,a.jsx)(n.p,{children:"Execute queries within transactions:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'ignite.transactions().runInTransaction(tx -> {\n    try (ResultSet<SqlRow> rs = ignite.sql().execute(\n        tx,\n        "SELECT balance FROM accounts WHERE id = ?",\n        1\n    )) {\n        SqlRow row = rs.next();\n        int balance = row.intValue("balance");\n\n        ignite.sql().execute(\n            tx,\n            "UPDATE accounts SET balance = ? WHERE id = ?",\n            balance + 100,\n            1\n        ).close();\n    }\n});\n'})}),"\n",(0,a.jsx)(n.p,{children:"All statements using the same transaction see consistent data and commit atomically."}),"\n",(0,a.jsx)(n.h2,{id:"result-set-types",children:"Result Set Types"}),"\n",(0,a.jsx)(n.p,{children:"ResultSet indicates result type through metadata:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'try (ResultSet<SqlRow> rs = ignite.sql().execute(null, query)) {\n    if (rs.hasRowSet()) {\n        // SELECT query, process rows\n        while (rs.hasNext()) {\n            SqlRow row = rs.next();\n            // Process row\n        }\n    } else {\n        // DML or DDL\n        if (rs.affectedRows() >= 0) {\n            // DML operation\n            System.out.println("Affected: " + rs.affectedRows());\n        } else {\n            // DDL operation\n            System.out.println("Applied: " + rs.wasApplied());\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"sqlrow-access",children:"SqlRow Access"}),"\n",(0,a.jsx)(n.p,{children:"Access row values by name or index:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'SqlRow row = rs.next();\n\n// By column name\nint id = row.intValue("id");\nString name = row.stringValue("name");\nDouble price = row.value("price");\n\n// By index\nObject value0 = row.value(0);\nString column0 = row.columnName(0);\n\n// Access metadata\nResultSetMetadata metadata = row.metadata();\nint columnCount = row.columnCount();\n'})}),"\n",(0,a.jsx)(n.p,{children:"SqlRow extends Tuple, providing all tuple access methods."}),"\n",(0,a.jsx)(n.h2,{id:"reference",children:"Reference"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["SQL facade: ",(0,a.jsx)(n.code,{children:"org.apache.ignite.sql.IgniteSql"})]}),"\n",(0,a.jsxs)(n.li,{children:["Statements: ",(0,a.jsx)(n.code,{children:"org.apache.ignite.sql.Statement"})]}),"\n",(0,a.jsxs)(n.li,{children:["Results: ",(0,a.jsx)(n.code,{children:"org.apache.ignite.sql.ResultSet<T>"})]}),"\n",(0,a.jsxs)(n.li,{children:["Rows: ",(0,a.jsx)(n.code,{children:"org.apache.ignite.sql.SqlRow"})]}),"\n",(0,a.jsxs)(n.li,{children:["Metadata: ",(0,a.jsx)(n.code,{children:"org.apache.ignite.sql.ResultSetMetadata"}),", ",(0,a.jsx)(n.code,{children:"org.apache.ignite.sql.ColumnMetadata"})]}),"\n",(0,a.jsxs)(n.li,{children:["Batching: ",(0,a.jsx)(n.code,{children:"org.apache.ignite.sql.BatchedArguments"})]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"ignitesql-methods",children:"IgniteSql Methods"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Statement createStatement(String query)"})," - Create statement from query"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Statement.StatementBuilder statementBuilder()"})," - Create statement builder"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ResultSet<SqlRow> execute(Transaction, String query, Object...)"})," - Execute query with parameters"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ResultSet<SqlRow> execute(Transaction, Statement, Object...)"})," - Execute prepared statement"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"CompletableFuture<AsyncResultSet<SqlRow>> executeAsync(...)"})," - Async execution"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ResultSet<SqlRow> execute(Transaction, CancellationToken, String query, Object...)"})," - Execute with cancellation"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"<R> ResultSet<R> execute(Transaction, Mapper<R>, String query, Object...)"})," - Execute with result mapping"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"long[] executeBatch(Transaction, String dmlQuery, BatchedArguments)"})," - Execute batch"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"CompletableFuture<long[]> executeBatchAsync(Transaction, String query, BatchedArguments)"})," - Execute batch asynchronously"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"statement-configuration-1",children:"Statement Configuration"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"String query()"})," - Get query string"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"long queryTimeout(TimeUnit)"})," - Get timeout"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"String defaultSchema()"})," - Get default schema"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"int pageSize()"})," - Get result page size"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ZoneId timeZoneId()"})," - Get time zone"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"statement-builder-methods",children:"Statement Builder Methods"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"query(String)"})," - Set query string"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"defaultSchema(String)"})," - Set default schema"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"queryTimeout(long, TimeUnit)"})," - Set query timeout"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"pageSize(int)"})," - Set result page size"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"timeZoneId(ZoneId)"})," - Set time zone"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"build()"})," - Build statement"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"resultset-methods",children:"ResultSet Methods"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ResultSetMetadata metadata()"})," - Get result metadata"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"boolean hasRowSet()"})," - Check if contains rows"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"long affectedRows()"})," - Get affected row count"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"boolean wasApplied()"})," - Check if DDL was applied"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"boolean hasNext()"})," - Check for more rows"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"T next()"})," - Get next row"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"void close()"})," - Close result set"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"resultsetmetadata-methods",children:"ResultSetMetadata Methods"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"List<ColumnMetadata> columns()"})," - Get list of column metadata"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"int indexOf(String columnName)"})," - Get column index by name"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"columnmetadata-methods",children:"ColumnMetadata Methods"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"String name()"})," - Column name"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ColumnType type()"})," - Column type"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"boolean nullable()"})," - Nullability"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"int precision()"})," - Precision"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"int scale()"})," - Scale"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Class<?> valueClass()"})," - Value class"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ColumnOrigin origin()"})," - Column origin"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}}}]);