"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[7363],{11470:(e,n,r)=>{r.d(n,{A:()=>w});var s=r(96540),i=r(34164),t=r(17559),l=r(23104),o=r(56347),a=r(205),c=r(57485),d=r(31682),u=r(70679);function h(e){return s.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function x(e){const{values:n,children:r}=e;return(0,s.useMemo)(()=>{const e=n??function(e){return h(e).map(({props:{value:e,label:n,attributes:r,default:s}})=>({value:e,label:n,attributes:r,default:s}))}(r);return function(e){const n=(0,d.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,r])}function p({value:e,tabValues:n}){return n.some(n=>n.value===e)}function g({queryString:e=!1,groupId:n}){const r=(0,o.W6)(),i=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(i),(0,s.useCallback)(e=>{if(!i)return;const n=new URLSearchParams(r.location.search);n.set(i,e),r.replace({...r.location,search:n.toString()})},[i,r])]}function j(e){const{defaultValue:n,queryString:r=!1,groupId:i}=e,t=x(e),[l,o]=(0,s.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const r=n.find(e=>e.default)??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:t})),[c,d]=g({queryString:r,groupId:i}),[h,j]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[r,i]=(0,u.Dv)(n);return[r,(0,s.useCallback)(e=>{n&&i.set(e)},[n,i])]}({groupId:i}),y=(()=>{const e=c??h;return p({value:e,tabValues:t})?e:null})();(0,a.A)(()=>{y&&o(y)},[y]);return{selectedValue:l,selectValue:(0,s.useCallback)(e=>{if(!p({value:e,tabValues:t}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),j(e)},[d,j,t]),tabValues:t}}var y=r(92303);const m={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=r(74848);function A({className:e,block:n,selectedValue:r,selectValue:s,tabValues:t}){const o=[],{blockElementScrollPositionUntilNextRender:a}=(0,l.a_)(),c=e=>{const n=e.currentTarget,i=o.indexOf(n),l=t[i].value;l!==r&&(a(n),s(l))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=o.indexOf(e.currentTarget)+1;n=o[r]??o[0];break}case"ArrowLeft":{const r=o.indexOf(e.currentTarget)-1;n=o[r]??o[o.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:t.map(({value:e,label:n,attributes:s})=>(0,b.jsx)("li",{role:"tab",tabIndex:r===e?0:-1,"aria-selected":r===e,ref:e=>{o.push(e)},onKeyDown:d,onClick:c,...s,className:(0,i.A)("tabs__item",m.tabItem,s?.className,{"tabs__item--active":r===e}),children:n??e},e))})}function v({lazy:e,children:n,selectedValue:r}){const t=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=t.find(e=>e.props.value===r);return e?(0,s.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:t.map((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==r}))})}function f(e){const n=j(e);return(0,b.jsxs)("div",{className:(0,i.A)(t.G.tabs.container,"tabs-container",m.tabList),children:[(0,b.jsx)(A,{...n,...e}),(0,b.jsx)(v,{...n,...e})]})}function w(e){const n=(0,y.A)();return(0,b.jsx)(f,{...e,children:h(e.children)},String(n))}},19365:(e,n,r)=>{r.d(n,{A:()=>l});r(96540);var s=r(34164);const i={tabItem:"tabItem_Ymn6"};var t=r(74848);function l({children:e,hidden:n,className:r}){return(0,t.jsx)("div",{role:"tabpanel",className:(0,s.A)(i.tabItem,r),hidden:n,children:e})}},28453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>o});var s=r(96540);const i={},t=s.createContext(i);function l(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:n},e.children)}},43205:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>x,frontMatter:()=>a,metadata:()=>s,toc:()=>u});const s=JSON.parse('{"id":"developers-guide/clients/linq","title":".NET LINQ Queries","description":"{/*","source":"@site/versioned_docs/version-3.0.0/developers-guide/clients/linq.md","sourceDirName":"developers-guide/clients","slug":"/developers-guide/clients/linq","permalink":"/suggested-site/docs/ignite3/3.0.0/developers-guide/clients/linq","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ignite-3/tree/main/docs/versioned_docs/version-3.0.0/developers-guide/clients/linq.md","tags":[],"version":"3.0.0","frontMatter":{"title":".NET LINQ Queries","sidebar_label":"LINQ"},"sidebar":"tutorialSidebar","previous":{"title":"ADO.NET","permalink":"/suggested-site/docs/ignite3/3.0.0/developers-guide/clients/ado"},"next":{"title":"JDBC","permalink":"/suggested-site/docs/ignite3/3.0.0/developers-guide/clients/jdbc-driver"}}');var i=r(74848),t=r(28453),l=r(11470),o=r(19365);const a={title:".NET LINQ Queries",sidebar_label:"LINQ"},c=void 0,d={},u=[{value:"Getting Started With LINQ",id:"getting-started-with-linq",level:2},{value:"Using LINQ",id:"using-linq",level:2},{value:"Inspecting Generated SQL",id:"inspecting-generated-sql",level:3},{value:"Transactions",id:"transactions",level:3},{value:"Custom Query Options",id:"custom-query-options",level:3},{value:"Result Materialization",id:"result-materialization",level:3},{value:"Iteration",id:"iteration",level:4},{value:"Converting to Collections",id:"converting-to-collections",level:4},{value:"Ignite-specific IResultSet",id:"ignite-specific-iresultset",level:4},{value:"Supported LINQ Features",id:"supported-linq-features",level:2},{value:"Projection",id:"projection",level:3},{value:"Inner Joins",id:"inner-joins",level:3},{value:"Outer Joins",id:"outer-joins",level:3},{value:"Grouping",id:"grouping",level:3},{value:"Ordering",id:"ordering",level:3},{value:"Union, Intersect, Except",id:"union-intersect-except",level:3},{value:"Aggregate Functions",id:"aggregate-functions",level:3},{value:"Math Functions",id:"math-functions",level:3},{value:"String Functions",id:"string-functions",level:3},{value:"Regular Expressions",id:"regular-expressions",level:3},{value:"DML (Bulk Update and Delete)",id:"dml-bulk-update-and-delete",level:3},{value:"Composing Queries",id:"composing-queries",level:3},{value:"Column Name Mapping",id:"column-name-mapping",level:3},{value:"KeyValueView",id:"keyvalueview",level:3}];function h(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:["\n","\n",(0,i.jsx)(n.p,{children:"Ignite .NET client provides LINQ support that is integrated with Ignite SQL APIs. You can avoid working with SQL syntax directly and write queries in C# with LINQ. C# LINQ expressions are then translated into Ignite-specific SQL. For example, the following two snippets achieve the same result:"}),"\n",(0,i.jsxs)(l.A,{groupId:"programming-languages",children:[(0,i.jsx)(o.A,{value:"LINQ",label:"LINQ",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'var table = await Client.Tables.GetTableAsync("TBL1");\nIQueryable<Poco> query = table!.GetRecordView<Poco>().AsQueryable()\n    .Where(x => x.Key > 3)\n    .OrderBy(x => x.Key);\nList<Poco> queryResults = await query.ToListAsync();\n'})})}),(0,i.jsx)(o.A,{value:"SQL",label:"SQL",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'var query = "select KEY, VAL from PUBLIC.TBL1 where (KEY > ?) order by KEY asc";\nawait using IResultSet<IIgniteTuple> resultSet = await Client.Sql.\n    ExecuteAsync(transaction: null, query, 3);\nvar queryResults = new List<Poco>();\nawait foreach (IIgniteTuple row in resultSet)\n{\n    queryResults.Add(new Poco { Key = (long)row[0]!, Val = (string?)row[1] });\n}\n'})})})]}),"\n",(0,i.jsx)(n.p,{children:"LINQ has the following advantages over SQL:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Queries are strongly typed and checked at compilation;"}),"\n",(0,i.jsx)(n.li,{children:"It is easier to write and maintain with IDE support (auto-completion, navigation, find usages);"}),"\n",(0,i.jsx)(n.li,{children:"LINQ is refactoring-friendly: rename a column and all queries are updated at once;"}),"\n",(0,i.jsx)(n.li,{children:"Ignite-specific SQL knowledge is not required, and most C# developers are already familiar with LINQ;"}),"\n",(0,i.jsx)(n.li,{children:"LINQ is safe against SQL injections;"}),"\n",(0,i.jsx)(n.li,{children:"Results are mapped to types naturally."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"In real-world scenarios the performance of Ignite LINQ queries is on par with equivalent SQL queries.\nHowever, a small overhead still exists (due to query translation), and your mileage may vary depending on the query complexity, so it is recommended to measure the performance of your queries."}),"\n",(0,i.jsx)(n.h2,{id:"getting-started-with-linq",children:"Getting Started With LINQ"}),"\n",(0,i.jsx)(n.p,{children:"Here is how you can create a simple table in Ignite:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a table:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'await Client.Sql.ExecuteAsync(\n    null, @"CREATE TABLE PUBLIC.PERSON (NAME VARCHAR PRIMARY KEY, AGE INT)");\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Define the classes (or records) that represent tables:"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Member names should match column names (case-insensitive)."}),"\n",(0,i.jsxs)(n.li,{children:["If a column name is not a valid C# identifier, use ",(0,i.jsx)(n.code,{children:'[Column("name")]'})," attribute to specify the name."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public record Person(string Name, int Age, string Address, string Status);\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Obtain a table reference:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'ITable table = await Client.Tables.GetTableAsync("PERSON");\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:["Use the ",(0,i.jsx)(n.code,{children:"GetRecordView<T>()"})," method to get a typed view of the table:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"IRecordView<Person> view = table.GetRecordView<Person>();\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"AsQueryable()"})," to perform LINQ queries on ",(0,i.jsx)(n.code,{children:"IRecordView<T>"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"List<string> names = await view.AsQueryable()\n    .Where(x => x.Age > 30)\n    .Select(x => x.Name)\n    .ToListAsync();\n"})}),"\n",(0,i.jsx)(n.h2,{id:"using-linq",children:"Using LINQ"}),"\n",(0,i.jsx)(n.h3,{id:"inspecting-generated-sql",children:"Inspecting Generated SQL"}),"\n",(0,i.jsx)(n.p,{children:"Viewing generated SQL is useful for debugging and performance tuning. There are two ways to do it:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"IgniteQueryableExtensions.ToQueryString()"})," extension method:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"IQueryable<Person> query = table.GetRecordView<Person>()\n    .AsQueryable()\n    .Where(x => x.Age > 30);\nstring sql = query.ToQueryString();\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Debug logging:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var cfg = new IgniteClientConfiguration\n{\n    Logger = new ConsoleLogger { MinLevel = LogLevel.Debug },\n    ...\n};\nusing var client = IgniteClient.StartAsync(cfg);\n...\n"})}),"\n",(0,i.jsxs)(n.p,{children:["All generated SQL will be logged with ",(0,i.jsx)(n.code,{children:"Debug"})," level to the specified logger."]}),"\n",(0,i.jsx)(n.h3,{id:"transactions",children:"Transactions"}),"\n",(0,i.jsxs)(n.p,{children:["Transaction can be passed to the LINQ provider by using the ",(0,i.jsx)(n.code,{children:"AsQueryable"})," parameter:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'await using var tx = await client.Transactions.BeginAsync();\nvar view = (await client.Tables.GetTableAsync("person"))!.GetRecordView<Person>();\npocoView.AsQueryable(tx)...;\n'})}),"\n",(0,i.jsx)(n.h3,{id:"custom-query-options",children:"Custom Query Options"}),"\n",(0,i.jsxs)(n.p,{children:["Custom query options (timeout, page size) can be specified by using the second ",(0,i.jsx)(n.code,{children:"AsQueryable"})," parameter with ",(0,i.jsx)(n.code,{children:"QueryableOptions"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var options = new QueryableOptions\n{\n    PageSize = 512,\n    Timeout = TimeSpan.FromSeconds(30)\n};\ntable.GetRecordView<Person>().AsQueryable(options: options)...;\n"})}),"\n",(0,i.jsx)(n.h3,{id:"result-materialization",children:"Result Materialization"}),"\n",(0,i.jsxs)(n.p,{children:["Materialization is the process of converting query results (",(0,i.jsx)(n.code,{children:"IQueryable<T>"}),") into an object or a collection of objects."]}),"\n",(0,i.jsx)(n.p,{children:"LINQ is lazy. Nothing happens (no network calls, no SQL translation) until the query is materialized.\nFor example, the following code only constructs an expression, but does not execute anything:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"IQueryable<Person> query = table!.GetRecordView<Person>().AsQueryable()\n    .Where(x => x.Key > 3)\n    .OrderBy(x => x.Key);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Query execution and materialization can be triggered in multiple ways:"}),"\n",(0,i.jsx)(n.h4,{id:"iteration",children:"Iteration"}),"\n",(0,i.jsxs)(n.p,{children:["You can iterate through query results by using ",(0,i.jsx)(n.code,{children:"foreach"})," statement, or asynchronously by using the  ",(0,i.jsx)(n.code,{children:"AsAsyncEnumerable"})," method:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"foreach (var person in query) { ... }\nawait foreach (var person in query.AsAsyncEnumerable()) { ... }\n"})}),"\n",(0,i.jsx)(n.h4,{id:"converting-to-collections",children:"Converting to Collections"}),"\n",(0,i.jsxs)(n.p,{children:["You can convert queries to collections by using the ",(0,i.jsx)(n.code,{children:"ToList"})," and ",(0,i.jsx)(n.code,{children:"ToDictionary"})," methods, or ",(0,i.jsx)(n.code,{children:"ToListAsync"})," and ",(0,i.jsx)(n.code,{children:"ToDictionaryAsync"})," methods to do it asynchronously:"]}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(o.A,{value:"Synchronous",label:"Synchronous",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"List<Person> list = query.ToList();\nDictionary<string, int> dict = query.ToDictionary(x => x.Name, x => x.Age);\n"})})}),(0,i.jsx)(o.A,{value:"Asynchronous",label:"Asynchronous",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"List<Person> list = await query.ToListAsync();\nDictionary<string, int> dict = await query.\n    ToDictionaryAsync(x => x.Name, x => x.Age);\n"})})})]}),"\n",(0,i.jsx)(n.h4,{id:"ignite-specific-iresultset",children:"Ignite-specific IResultSet"}),"\n",(0,i.jsxs)(n.p,{children:["Underlying ",(0,i.jsx)(n.code,{children:"IResultSet"})," can be obtained by using the ",(0,i.jsx)(n.code,{children:"IgniteQueryableExtensions.ToResultSetAsync()"})," extension method:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"await using IResultSet<Person> resultSet = await query.ToResultSetAsync();\nConsole.WriteLine(resultSet.Metadata);\nvar rows = resultSet.CollectAsync(...);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Obtaining ",(0,i.jsx)(n.code,{children:"IResultSet"})," can be useful for access to metadata and ",(0,i.jsx)(n.code,{children:"CollectAsync"})," method, which provides more control over result materialization."]}),"\n",(0,i.jsx)(n.h2,{id:"supported-linq-features",children:"Supported LINQ Features"}),"\n",(0,i.jsx)(n.h3,{id:"projection",children:"Projection"}),"\n",(0,i.jsx)(n.p,{children:"Projection is the process of converting query results into a different type.\nAmong other things, projections are used to select a subset of columns."}),"\n",(0,i.jsxs)(n.p,{children:["For example, ",(0,i.jsx)(n.code,{children:"Person"})," table may have many columns, but we only need ",(0,i.jsx)(n.code,{children:"Name"})," and ",(0,i.jsx)(n.code,{children:"Age"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"First, create a projection class:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public record PersonInfo(string Name, int Age);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Then, use ",(0,i.jsx)(n.code,{children:"Select"})," to project query results:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"List<PersonInfo> result = query\n    .Select(x => new PersonInfo(x.Name, x.Age))\n    .ToList();\n"})}),"\n",(0,i.jsx)(n.p,{children:"Resulting SQL will select only those two columns, avoiding overfetching\n(a common issue that happens when ORM-generated query includes all table columns, but only a few of them are needed by the business logic)."}),"\n",(0,i.jsx)(n.p,{children:"Ignite also supports anonymous type projections:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var result = query.Select(x => new { x.Name, x.Age }).ToList();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"inner-joins",children:"Inner Joins"}),"\n",(0,i.jsxs)(n.p,{children:["Use the standard ",(0,i.jsx)(n.code,{children:"Join"})," method to perform joins on other tables:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var customerQuery = customerTable.GetRecordView<Customer>().AsQueryable();\nvar orderQuery = orderTable.GetRecordView<Order>().AsQueryable();\nvar ordersByCustomer = customerQuery\n    .Join(orderQuery,\n        cust => cust.Id,\n        order => order.CustId,\n        (cust, order) => new { cust.Name, order.Amount })\n    .ToList();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"outer-joins",children:"Outer Joins"}),"\n",(0,i.jsxs)(n.p,{children:["Outer joins are supported through the ",(0,i.jsx)(n.code,{children:"DefaultIfEmpty"})," method.\nFor example, not every book in a library is borrowed by a student, so a left outer join is used to retrieve all books and their current borrowers (if any):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var bookQuery = bookTable.GetRecordView<Book>().AsQueryable();\nvar studentQuery = studentTable.GetRecordView<Student>().AsQueryable();\nvar booksWithStudents = bookQuery\n    .Join(studentQuery.DefaultIfEmpty(),\n        book => book.StudentId,\n        student => student.Id,\n        (book, student) => new { book.Title, student.Name })\n    .ToList();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"grouping",children:"Grouping"}),"\n",(0,i.jsxs)(n.p,{children:["Grouping is supported through ",(0,i.jsx)(n.code,{children:"GroupBy"})," method. This is equivalent to SQL GROUP BY operator. You can get both single and multiple columns in your queries. When working with multiple columns, use anonymous type:"]}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(o.A,{value:"Single Column",label:"Single Column",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var bookCountByAuthor = bookTable.GetRecordView<Book>().AsQueryable()\n    .GroupBy(book => book.Author)\n    .Select(grp => new { Author = grp.Key, Count = grp.Count() })\n    .ToList();\n"})})}),(0,i.jsx)(o.A,{value:"Multiple Columns",label:"Multiple Columns",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var bookCountByAuthorAndYear = bookTable.GetRecordView<Book>().AsQueryable()\n    .GroupBy(book => new { book.Author, book.Year })\n    .Select(grp => new { Author = grp.Key.Author,\n                                  Year = grp.Key.Year,\n                                  Count = grp.Count() })\n    .ToList();\n"})})})]}),"\n",(0,i.jsxs)(n.p,{children:["Aggregate functions ",(0,i.jsx)(n.code,{children:"Count"}),", ",(0,i.jsx)(n.code,{children:"Sum"}),", ",(0,i.jsx)(n.code,{children:"Min"}),", ",(0,i.jsx)(n.code,{children:"Max"}),", ",(0,i.jsx)(n.code,{children:"Average"})," can be used with groupings."]}),"\n",(0,i.jsx)(n.h3,{id:"ordering",children:"Ordering"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"OrderBy"}),", ",(0,i.jsx)(n.code,{children:"OrderByDescending"}),", ",(0,i.jsx)(n.code,{children:"ThenBy"}),", ",(0,i.jsx)(n.code,{children:"ThenByDescending"})," are supported. You can combine them to order by multiple columns:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var booksOrderedByAuthorAndYear = bookTable.GetRecordView<Book>().AsQueryable()\n    .OrderBy(book => book.Author)\n    .ThenByDescending(book => book.Year)\n    .ToList();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"union-intersect-except",children:"Union, Intersect, Except"}),"\n",(0,i.jsxs)(n.p,{children:["Multiple result sets can be combined by using the ",(0,i.jsx)(n.code,{children:"Union"}),", ",(0,i.jsx)(n.code,{children:"Intersect"}),", ",(0,i.jsx)(n.code,{children:"Except"})," methods. For example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"IQueryable<string> employeeEmails = employeeTable\n    .GetRecordView<Employee>().AsQueryable()\n    .Select(x => x.Email);\n\nIQueryable<string> customerEmails = customerTable\n    .GetRecordView<Customer>().AsQueryable()\n    .Select(x => x.Email);\n\nList<string> allEmails = employeeEmails.Union(customerEmails)\n    .OrderBy(x => x)\n    .ToList();\n\nList<string> employeesThatAreCustomers = employeeEmails\n    .Intersect(customerEmails).ToList();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"aggregate-functions",children:"Aggregate Functions"}),"\n",(0,i.jsx)(n.p,{children:"Below is a list of .NET aggregate functions and their SQL equivalents that are supported in Ignite:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"LINQ synchronous method"}),(0,i.jsx)(n.th,{children:"LINQ asynchronous method"}),(0,i.jsx)(n.th,{children:"SQL Operator"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"First"}),(0,i.jsx)(n.td,{children:"FirstAsync"}),(0,i.jsx)(n.td,{children:"FIRST"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FirstOrDefault"}),(0,i.jsx)(n.td,{children:"FirstOrDefaultAsync"}),(0,i.jsx)(n.td,{children:"FIRST ... LIMIT 1"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Single"}),(0,i.jsx)(n.td,{children:"SingleAsync"}),(0,i.jsx)(n.td,{children:"FIRST"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"SingleOrDefault"}),(0,i.jsx)(n.td,{children:"SingleOrDefaultAsync"}),(0,i.jsx)(n.td,{children:"FIRST ... LIMIT 2"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Max"}),(0,i.jsx)(n.td,{children:"MaxAsync"}),(0,i.jsx)(n.td,{children:"MAX"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Min"}),(0,i.jsx)(n.td,{children:"MinAsync"}),(0,i.jsx)(n.td,{children:"MIN"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Average"}),(0,i.jsx)(n.td,{children:"AverageAsync"}),(0,i.jsx)(n.td,{children:"AVG"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Sum"}),(0,i.jsx)(n.td,{children:"SumAsync"}),(0,i.jsx)(n.td,{children:"SUM"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Count"}),(0,i.jsx)(n.td,{children:"CountAsync"}),(0,i.jsx)(n.td,{children:"COUNT"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"LongCount"}),(0,i.jsx)(n.td,{children:"LongCountAsync"}),(0,i.jsx)(n.td,{children:"COUNT"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Any"}),(0,i.jsx)(n.td,{children:"AnyAsync"}),(0,i.jsx)(n.td,{children:"ANY"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"All"}),(0,i.jsx)(n.td,{children:"AllAsync"}),(0,i.jsx)(n.td,{children:"ALL"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"Here are examples of how you can use these methods:"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(o.A,{value:"Synchronous",label:"Synchronous",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"Person first = query.First();\nPerson? firstOrDefault = query.FirstOrDefault();\nPerson single = query.Single();\nPerson? singleOrDefault = query.SingleOrDefault();\nint maxAge = query.Max(x => x.Age);\nint minAge = query.Min(x => x.Age);\nint avgAge = query.Average(x => x.Age);\nint sumAge = query.Sum(x => x.Age);\nint count = query.Count();\nlong longCount = query.LongCount();\nbool any = query.Any(x => x.Age > 30);\nbool all = query.All(x => x.Age > 30);\n"})})}),(0,i.jsx)(o.A,{value:"Asynchronous",label:"Asynchronous",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"Person first = await query.FirstAsync();\nPerson? firstOrDefault = await query.FirstOrDefaultAsync();\nPerson single = await query.SingleAsync();\nPerson? singleOrDefault = await query.SingleOrDefaultAsync();\nint maxAge = await query.MaxAsync(x => x.Age);\nint minAge = await query.MinAsync(x => x.Age);\nint avgAge = await query.AverageAsync(x => x.Age);\nint sumAge = await query.SumAsync(x => x.Age);\nint count = await query.CountAsync();\nlong longCount = await query.LongCountAsync();\nbool any = await query.AnyAsync(x => x.Age > 30);\nbool all = await query.AllAsync(x => x.Age > 30);\n"})})})]}),"\n",(0,i.jsx)(n.h3,{id:"math-functions",children:"Math Functions"}),"\n",(0,i.jsxs)(n.p,{children:["The following ",(0,i.jsx)(n.code,{children:"Math"})," functions are supported (will be translated to SQL equivalents):\n",(0,i.jsx)(n.code,{children:"Abs"}),", ",(0,i.jsx)(n.code,{children:"Cos"}),", ",(0,i.jsx)(n.code,{children:"Cosh"}),", ",(0,i.jsx)(n.code,{children:"Acos"}),", ",(0,i.jsx)(n.code,{children:"Sin"}),", ",(0,i.jsx)(n.code,{children:"Sinh"}),", ",(0,i.jsx)(n.code,{children:"Asin"}),", ",(0,i.jsx)(n.code,{children:"Tan"}),", ",(0,i.jsx)(n.code,{children:"Tanh"}),", ",(0,i.jsx)(n.code,{children:"Atan"}),", ",(0,i.jsx)(n.code,{children:"Ceiling"}),", ",(0,i.jsx)(n.code,{children:"Floor"}),",\n",(0,i.jsx)(n.code,{children:"Exp"}),", ",(0,i.jsx)(n.code,{children:"Log"}),", ",(0,i.jsx)(n.code,{children:"Log10"}),", ",(0,i.jsx)(n.code,{children:"Pow"}),", ",(0,i.jsx)(n.code,{children:"Round"}),", ",(0,i.jsx)(n.code,{children:"Sign"}),", ",(0,i.jsx)(n.code,{children:"Sqrt"}),", ",(0,i.jsx)(n.code,{children:"Truncate"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["The following ",(0,i.jsx)(n.code,{children:"Math"})," functions are NOT supported (no equivalent in Ignite SQL engine):\n",(0,i.jsx)(n.code,{children:"Acosh"}),", ",(0,i.jsx)(n.code,{children:"Asinh"}),", ",(0,i.jsx)(n.code,{children:"Atanh"}),", ",(0,i.jsx)(n.code,{children:"Atan2"}),", ",(0,i.jsx)(n.code,{children:"Log2"}),", ",(0,i.jsx)(n.code,{children:"Log(x, y)"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Here is the example of how you can use math functions:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var triangles = table.GetRecordView<Triangle>().AsQueryable()\n    .Select(t => new {\n            Hypotenuse,\n            Opposite = t.Hypotenuse * Math.Sin(t.Angle),\n            Adjacent = t.Hypotenuse * Math.Cos(t.Angle)\n        })\n    .ToList();\n"})}),"\n",(0,i.jsx)(n.h3,{id:"string-functions",children:"String Functions"}),"\n",(0,i.jsxs)(n.p,{children:["The following string functions are supported: ",(0,i.jsx)(n.code,{children:"string.Compare(string)"}),", ",(0,i.jsx)(n.code,{children:"string.Compare(string, bool ignoreCase)"}),", concatenation ",(0,i.jsx)(n.code,{children:"s1 + s2 + s3"}),", ",(0,i.jsx)(n.code,{children:"ToUpper"}),", ",(0,i.jsx)(n.code,{children:"ToLower"}),",\n",(0,i.jsx)(n.code,{children:"Substring(start)"}),", ",(0,i.jsx)(n.code,{children:"Substring(start, len)"}),",\n",(0,i.jsx)(n.code,{children:"Trim"}),", ",(0,i.jsx)(n.code,{children:"Trim(char)"}),", ",(0,i.jsx)(n.code,{children:"TrimStart"}),", ",(0,i.jsx)(n.code,{children:"TrimStart(char)"}),", ",(0,i.jsx)(n.code,{children:"TrimEnd"}),", ",(0,i.jsx)(n.code,{children:"TrimEnd(char)"}),",\n",(0,i.jsx)(n.code,{children:"Contains"}),", ",(0,i.jsx)(n.code,{children:"StartsWith"}),", ",(0,i.jsx)(n.code,{children:"EndsWith"}),", ",(0,i.jsx)(n.code,{children:"IndexOf"}),", ",(0,i.jsx)(n.code,{children:"Length"}),", ",(0,i.jsx)(n.code,{children:"Replace"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Here is the example of how you can use string functions:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'List<string> fullNames = table.GetRecordView<Person>().AsQueryable()\n    .Where(p => p.FirstName.StartsWith("Jo"))\n    .Select(p => new {\n        FullName = p.FirstName.ToUpper() +\n        " " +\n        p.LastName.ToLower() })\n    .ToList();\n'})}),"\n",(0,i.jsx)(n.h3,{id:"regular-expressions",children:"Regular Expressions"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Regex.Replace"})," is translated to ",(0,i.jsx)(n.code,{children:"regexp_replace"})," function. Here is how you can use regular expressions in your code:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'List<string> addresses = table.GetRecordView<Person>().AsQueryable()\n    .Select(p => new { Address = Regex.Replace(p.Address, @"(\\d+)", "[$1]")\n    .ToList();\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"Regular expression engine within SQL may behave differently from .NET engine."})}),"\n",(0,i.jsx)(n.h3,{id:"dml-bulk-update-and-delete",children:"DML (Bulk Update and Delete)"}),"\n",(0,i.jsxs)(n.p,{children:["Bulk update and delete with optional conditions are supported through ",(0,i.jsx)(n.code,{children:"ExecuteUpdateAsync"})," and ",(0,i.jsx)(n.code,{children:"ExecuteDeleteAsync"})," extensions methods on ",(0,i.jsx)(n.code,{children:"IQueryable<T>"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"var orders = orderTable.GetRecordView<Order>().AsQueryable();\nawait orders.Where(x => x.Amount == 0).ExecuteDeleteAsync();\n"})}),"\n",(0,i.jsx)(n.p,{children:"Update statement can set properties to constant values or to an expression based on other properties of the same row:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'var orders = orderTable.GetRecordView<Order>().AsQueryable();\nawait orders\n    .Where(x => x.CustomerId == customerId)\n    .ExecuteUpdateAsync(\n        order => order.SetProperty(x => x.Discount, 0.1m)\n                      .SetProperty(x => x.Note, x => x.Note +\n                            " Happy birthday, " +\n                            x.CustomerName));\n'})}),"\n",(0,i.jsx)(n.p,{children:"Resulting SQL:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"update PUBLIC.tbl1 as _T0\nset NOTE = concat(concat(_T0.NOTE, ?), _T0.CUSTOMERNAME), DISCOUNT = ?\nwhere (_T0.CUSTOMERID IS NOT DISTINCT FROM ?)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"composing-queries",children:"Composing Queries"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"IQueryable<T>"})," expressions can be composed dynamically. A common use case is to compose a query based on user input.\nFor example, optional filters on different columns can be applied to a query:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public List<Book> GetBooks(string? author, int? year)\n{\n    IQueryable<Book> query = bookTable.GetRecordView<Book>().AsQueryable();\n    if (!string.IsNullOrEmpty(author))\n        query = query.Where(x => x.Author == author);\n\n    if (year != null)\n        query = query.Where(x => x.Year == year);\n    return query.ToList();\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"column-name-mapping",children:"Column Name Mapping"}),"\n",(0,i.jsxs)(n.p,{children:["Unless custom mapping is provided with ",(0,i.jsx)(n.code,{children:"[Column]"}),", LINQ provider will use property or field names as column names,\nusing unquoted identifiers, which are case-insensitive."]}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(o.A,{value:"C#",label:"C#",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"bookTable.GetRecordView<Book>().AsQueryable().Select(x => x.Author).ToList();\n"})})}),(0,i.jsx)(o.A,{value:"Resulting SQL",label:"Resulting SQL",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"select _T0.AUTHOR from PUBLIC.books as _T0\n"})})})]}),"\n",(0,i.jsxs)(n.p,{children:["To use quoted identifiers, or to map column names to different property names, use ",(0,i.jsx)(n.code,{children:"[Column]"})," attribute:"]}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(o.A,{value:"C#",label:"C#",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'public class Book\n{\n    [Column("book_author")]\n    public string Author { get; set; }\n}\n// Or a record:\npublic record Book([property: Column("book_author")] string Author);\n'})})}),(0,i.jsx)(o.A,{value:"Resulting SQL",label:"Resulting SQL",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'SELECT _T0."book_author" FROM PUBLIC.books AS _T0\n'})})})]}),"\n",(0,i.jsx)(n.h3,{id:"keyvalueview",children:"KeyValueView"}),"\n",(0,i.jsxs)(n.p,{children:["All examples above use ",(0,i.jsx)(n.code,{children:"IRecordView<T>"})," to perform queries; LINQ provider supports ",(0,i.jsx)(n.code,{children:"IKeyValueView<TK, TV>"})," equally well:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"IQueryable<KeyValuePair<int, Book>> query =\n    bookTable.GetKeyValueView<int, Book>().AsQueryable();\nList<Book> books = query\n    .Where(x => x.Key > 10)\n    .Select(x => x.Value)\n    .ToList();\n"})})]})}function x(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);