"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[6891],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>c});var i=t(96540);const r={},o=i.createContext(r);function s(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:n},e.children)}},99491:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"developers-guide/clients/python","title":"Python Database API Driver","description":"{/*","source":"@site/versioned_docs/version-3.0.0/developers-guide/clients/python.md","sourceDirName":"developers-guide/clients","slug":"/developers-guide/clients/python","permalink":"/docs/ignite3/3.0.0/developers-guide/clients/python","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ignite-3/tree/main/docs/versioned_docs/version-3.0.0/developers-guide/clients/python.md","tags":[],"version":"3.0.0","frontMatter":{"title":"Python Database API Driver","sidebar_label":"Python"},"sidebar":"tutorialSidebar","previous":{"title":"C++","permalink":"/docs/ignite3/3.0.0/developers-guide/clients/cpp"},"next":{"title":"ADO.NET","permalink":"/docs/ignite3/3.0.0/developers-guide/clients/ado"}}');var r=t(74848),o=t(28453);const s={title:"Python Database API Driver",sidebar_label:"Python"},c=void 0,a={},l=[{value:"Getting Started",id:"getting-started",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Limitations",id:"limitations",level:3},{value:"Installation",id:"installation",level:3},{value:"Connecting to Cluster",id:"connecting-to-cluster",level:2},{value:"Configuring SSL for Connection",id:"configuring-ssl-for-connection",level:3},{value:"Configuring Authorization",id:"configuring-authorization",level:3},{value:"Configuring Data Access",id:"configuring-data-access",level:3},{value:"Getting Cursor Object",id:"getting-cursor-object",level:2},{value:"Executing Single Query",id:"executing-single-query",level:2},{value:"Executing a Batched Query",id:"executing-a-batched-query",level:2},{value:"Getting Query Results",id:"getting-query-results",level:2},{value:"Working with Transactions",id:"working-with-transactions",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:["\n",(0,r.jsx)(n.p,{children:"Apache Ignite 3 clients connect to the cluster via a standard socket connection. Clients do not become a part of the cluster topology, never hold any data, and are not used as a destination for compute calculations."}),"\n",(0,r.jsxs)(n.p,{children:["Apache Ignite DB API driver uses the ",(0,r.jsx)(n.a,{href:"https://peps.python.org/pep-0249/",children:"Python Database API"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,r.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"To run the Python driver, the following is required:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"CMake 3.18 or newer to build the driver"}),"\n",(0,r.jsx)(n.li,{children:"Python 3.9 or newer (3.9, 3.10, 3.11 and 3.12 are tested)"}),"\n",(0,r.jsx)(n.li,{children:"Access to a running Ignite 3 node"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"limitations",children:"Limitations"}),"\n",(0,r.jsx)(n.p,{children:"Script execution of SQL statements is not supported in current release."}),"\n",(0,r.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.p,{children:"To install Python DB API driver, download it from pip."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"pip install pyignite3_dbapi\n"})}),"\n",(0,r.jsxs)(n.p,{children:["After this, you can import ",(0,r.jsx)(n.code,{children:"pyignite3_dbapi"})," into your project and use it."]}),"\n",(0,r.jsx)(n.h2,{id:"connecting-to-cluster",children:"Connecting to Cluster"}),"\n",(0,r.jsxs)(n.p,{children:["To connect to the cluster, use the ",(0,r.jsx)(n.code,{children:"connect()"})," method:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"addr = ['127.0.0.1:10800']\nreturn pyignite_dbapi.connect(address=addr, timeout=10)\n"})}),"\n",(0,r.jsx)(n.p,{children:"After you are done working with the cluster, remember to always close the connection to it."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"conn.close()\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Alternatively, you can use the ",(0,r.jsx)(n.code,{children:"with"})," statement to automatically close the connection when no longer necessary:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"with pyignite_dbapi.connect(address=addr, timeout=10) as conn:\n    conn.cursor()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"configuring-ssl-for-connection",children:"Configuring SSL for Connection"}),"\n",(0,r.jsx)(n.p,{children:"To ensure secure connection to the cluster, you can enable SSL for it by providing the key file and certificate, for example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def create_ssl_connection():\n  \"\"\"Create SSL-enabled connection to GridGain cluster.\"\"\"\n  addr = ['127.0.0.1:10800']\n  return pyignite_dbapi.connect(\n      address=addr,\n      timeout=10,\n      use_ssl=True,\n      ssl_keyfile='<path_to_ssl_keyfile.pem>',\n      ssl_certfile='<path_to_ssl_certfile.pem>',\n      # Optional: ssl_ca_certfile='<path_to_ssl_ca_certfile.pem>'\n  )\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"All paths to certificate file and keys should be provided in string format appropriate for the system."})}),"\n",(0,r.jsx)(n.h3,{id:"configuring-authorization",children:"Configuring Authorization"}),"\n",(0,r.jsxs)(n.p,{children:["If the cluster uses ",(0,r.jsx)(n.a,{href:"/docs/ignite3/3.0.0/administrators-guide/security/authentication#basic-authentication",children:"basic authorization"}),", you need to provide user ",(0,r.jsx)(n.code,{children:"identity"})," and ",(0,r.jsx)(n.code,{children:"secret"})," to authorize on it, for example:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def create_authenticated_connection():\n  \"\"\"Create authenticated connection to GridGain cluster.\"\"\"\n  addr = ['127.0.0.1:10800']\n  return pyignite_dbapi.connect(\n      address=addr,\n      timeout=10,\n      identity='user',\n      secret='password'\n  )\n"})}),"\n",(0,r.jsx)(n.h3,{id:"configuring-data-access",children:"Configuring Data Access"}),"\n",(0,r.jsx)(n.p,{children:"You can configure optional properties to fine-tune how data is accessed."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Configuration name"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"schema"}),(0,r.jsx)(n.td,{children:"A schema name to be used by default. Default value: 'PUBLIC'."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"page_size"}),(0,r.jsx)(n.td,{children:"Maximum number of rows that can be received or sent in a single request. Default value: 1024"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"The example below shows how to set these properties:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def create_configured_connection():\n  """Create authenticated connection to GridGain cluster."""\n  addr = [\'127.0.0.1:10800\']\n  return conn = pyignite_dbapi.connect(\n    address=addr,\n    timeout=10,\n    schema=\'CUSTOM\',\n    page_size=2048\n  )\n'})}),"\n",(0,r.jsx)(n.h2,{id:"getting-cursor-object",children:"Getting Cursor Object"}),"\n",(0,r.jsxs)(n.p,{children:["To work with tables from Python client, you use the ",(0,r.jsx)(n.code,{children:"cursor"})," object that can be retrieved from the connection object:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"conn.cursor()\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Similar to the connection, you can use the ",(0,r.jsx)(n.code,{children:"with"})," statement when getting the cursor:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"with conn.cursor() as cursor:\n"})}),"\n",(0,r.jsx)(n.h2,{id:"executing-single-query",children:"Executing Single Query"}),"\n",(0,r.jsxs)(n.p,{children:["The cursor object can be used to execute SQL statements with the ",(0,r.jsx)(n.code,{children:"execute"})," command:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Create table\ncursor.execute('''\n          CREATE TABLE Person(\n              id INT PRIMARY KEY,\n              name VARCHAR,\n              age INT\n          )\n      ''')\n"})}),"\n",(0,r.jsx)(n.h2,{id:"executing-a-batched-query",children:"Executing a Batched Query"}),"\n",(0,r.jsxs)(n.p,{children:["You can use the ",(0,r.jsx)(n.code,{children:"executemany"})," command to execute SQL queries with a batch of parameters. This kind of operation offers much higher performance than executing individual queries. The example below inserts two rows into the Person table:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Sample data\nsample_data = [\n  [1, "John", 30],\n  [2, "Jane", 32],\n  [3, "Bob", 28]\n]\n\n# Insert data (fixed table name)\ncursor.executemany(\'INSERT INTO Person VALUES(?, ?, ?)\', sample_data)\n'})}),"\n",(0,r.jsx)(n.h2,{id:"getting-query-results",children:"Getting Query Results"}),"\n",(0,r.jsxs)(n.p,{children:["The cursor retains a reference to the operation. If the operation returns results (for example, a ",(0,r.jsx)(n.code,{children:"SELECT"}),"), they will also be stored in the cursor. You can then use the ",(0,r.jsx)(n.code,{children:"fetchone()"})," method to retrieve query results from the cursor:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Query data\ncursor.execute(\'SELECT * FROM Person ORDER BY id\')\nresults = cursor.fetchall()\n\nprint("All persons in database:")\nfor row in results:\n  print(f"ID: {row[0]}, Name: {row[1]}, Age: {row[2]}")\n'})}),"\n",(0,r.jsx)(n.h2,{id:"working-with-transactions",children:"Working with Transactions"}),"\n",(0,r.jsx)(n.p,{children:"By default, transactions required for database operations are handled implicitly. However, you can disable automatic transaction handling and manually handle commits."}),"\n",(0,r.jsx)(n.p,{children:"To do this, first, disable autocommit:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"conn.autocommit = False\n"})}),"\n",(0,r.jsx)(n.p,{children:"Once autocommit is disabled, you need to commit your operations manually:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Insert valid records\ncursor.execute(\'INSERT INTO Person VALUES(?, ?, ?)\', [4, "Alice", 29])\ncursor.execute(\'INSERT INTO Person VALUES(?, ?, ?)\', [5, "Charlie", 31])\n\ncursor.execute(\'INSERT INTO Person VALUES(?, ?, ?)\', [6, "Invalid", new_age])\n\nconn.commit()\nprint("Transaction committed successfully")\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Operations that are not committed are sent to the cluster, but not yet written to the table. The table is only updated when the ",(0,r.jsx)(n.code,{children:"commit"})," method is called. You can roll back all uncommitted operations with the ",(0,r.jsx)(n.code,{children:"rollback"})," command:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'with conn.cursor() as cursor:\n  try:\n    # Insert valid records\n    cursor.execute(\'INSERT INTO Person VALUES(?, ?, ?)\', [4, "Alice", 29])\n    cursor.execute(\'INSERT INTO Person VALUES(?, ?, ?)\', [5, "Charlie", 31])\n\n    cursor.execute(\'INSERT INTO Person VALUES(?, ?, ?)\', [6, "Invalid", new_age])\n\n    conn.commit()\n    print("Transaction committed successfully")\n\n  except Exception as e:\n    # Rollback on any error\n    conn.rollback()\n    print(f"Transaction rolled back due to error: {e}")\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"rollback"})," command rolls back all uncommitted data."]})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);