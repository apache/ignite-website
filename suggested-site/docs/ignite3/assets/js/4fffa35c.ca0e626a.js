"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[1929],{28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var t=i(96540);const a={},s=t.createContext(a);function o(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),t.createElement(s.Provider,{value:n},e.children)}},79782:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"quick-start/explore-sql","title":"Getting Started with SQL","description":"{/*","source":"@site/versioned_docs/version-3.0.0/quick-start/explore-sql.md","sourceDirName":"quick-start","slug":"/quick-start/explore-sql","permalink":"/suggested-site/docs/ignite3/3.0.0/quick-start/explore-sql","draft":false,"unlisted":false,"tags":[],"version":"3.0.0","frontMatter":{"title":"Getting Started with SQL","sidebar_label":"Explore SQL"},"sidebar":"tutorialSidebar","previous":{"title":"Start Cluster in Docker","permalink":"/suggested-site/docs/ignite3/3.0.0/quick-start/start-cluster"},"next":{"title":"Persist Data","permalink":"/suggested-site/docs/ignite3/3.0.0/quick-start/persist-data"}}');var a=i(74848),s=i(28453);const o={title:"Getting Started with SQL",sidebar_label:"Explore SQL"},r=void 0,l={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Before Starting",id:"before-starting",level:2},{value:"Setting Up an Apache Ignite 3 Cluster",id:"setting-up-an-apache-ignite-3-cluster",level:2},{value:"Starting the Cluster",id:"starting-the-cluster",level:3},{value:"Connecting to the Cluster Using Ignite CLI",id:"connecting-to-the-cluster-using-ignite-cli",level:2},{value:"Starting the CLI",id:"starting-the-cli",level:3},{value:"Initializing the Cluster",id:"initializing-the-cluster",level:3},{value:"Creating the Chinook Database Schema",id:"creating-the-chinook-database-schema",level:2},{value:"Entering SQL Mode",id:"entering-sql-mode",level:3},{value:"Creating Distribution Zones",id:"creating-distribution-zones",level:3},{value:"Database Entity Relationship",id:"database-entity-relationship",level:3},{value:"Creating Core Tables",id:"creating-core-tables",level:3},{value:"Verifying Table Creation",id:"verifying-table-creation",level:3},{value:"Inserting Sample Data",id:"inserting-sample-data",level:2},{value:"Adding Artists and Albums",id:"adding-artists-and-albums",level:3},{value:"Adding Genres and Media Types",id:"adding-genres-and-media-types",level:3},{value:"Adding Tracks",id:"adding-tracks",level:3},{value:"Adding Employees and Customers",id:"adding-employees-and-customers",level:3},{value:"Adding Invoices and Invoice Lines",id:"adding-invoices-and-invoice-lines",level:3},{value:"Querying Data in Ignite SQL",id:"querying-data-in-ignite-sql",level:2},{value:"Basic Queries",id:"basic-queries",level:3},{value:"Joins",id:"joins",level:3},{value:"Data Manipulation in Ignite SQL",id:"data-manipulation-in-ignite-sql",level:2},{value:"Understanding Distributed Updates",id:"understanding-distributed-updates",level:3},{value:"Inserting New Data",id:"inserting-new-data",level:3},{value:"Updating Existing Data",id:"updating-existing-data",level:3},{value:"Deleting Data",id:"deleting-data",level:3},{value:"Advanced SQL Features",id:"advanced-sql-features",level:2},{value:"Querying System Views",id:"querying-system-views",level:3},{value:"Creating Indexes for Better Performance",id:"creating-indexes-for-better-performance",level:3},{value:"Creating a Dashboard Using SQL",id:"creating-a-dashboard-using-sql",level:2},{value:"Monthly Sales Summary",id:"monthly-sales-summary",level:3},{value:"Top Selling Genres",id:"top-selling-genres",level:3},{value:"Sales Performance by Employee",id:"sales-performance-by-employee",level:3},{value:"Top 20 Longest Tracks with Genres",id:"top-20-longest-tracks-with-genres",level:3},{value:"Customer Purchase Patterns by Month",id:"customer-purchase-patterns-by-month",level:3},{value:"Performance Tuning with Colocated Tables",id:"performance-tuning-with-colocated-tables",level:2},{value:"Colocated Queries",id:"colocated-queries",level:3},{value:"Key Observations in the Execution Plan",id:"key-observations-in-the-execution-plan",level:4},{value:"Improved Cololocation Strategy",id:"improved-cololocation-strategy",level:3},{value:"Key Observations in the Execution Plan",id:"key-observations-in-the-execution-plan-1",level:4},{value:"Colocation Impact",id:"colocation-impact",level:4},{value:"Cleaning Up",id:"cleaning-up",level:2},{value:"Best Practices for Ignite SQL",id:"best-practices-for-ignite-sql",level:2},{value:"Schema Design",id:"schema-design",level:3},{value:"Query Optimization",id:"query-optimization",level:3},{value:"Transaction Management",id:"transaction-management",level:3},{value:"Resource Management",id:"resource-management",level:3},{value:"What&#39;s Next",id:"whats-next",level:2}];function c(e){const n={admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:["\n",(0,a.jsx)(n.p,{children:"This guide walks you through using Apache Ignite 3 SQL capabilities via the command-line interface. You'll set up a distributed Apache Ignite cluster, create and manipulate the Chinook database (a sample database representing a digital media store), and learn to leverage Apache Ignite's powerful SQL features."}),"\n",(0,a.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Docker and Docker Compose installed on your system;"}),"\n",(0,a.jsx)(n.li,{children:"Basic familiarity with SQL;"}),"\n",(0,a.jsx)(n.li,{children:"Command-line terminal access;"}),"\n",(0,a.jsx)(n.li,{children:"8GB+ of available RAM for running the containers;"}),"\n",(0,a.jsx)(n.li,{children:"SQL directory with Chinook Database files downloaded."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"before-starting",children:"Before Starting"}),"\n",(0,a.jsx)(n.p,{children:"This tutorial uses prepared files to streamline deployment. Make sure you have the required files:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"docker-compose.yml"})," - Docker Compose configuration for the cluster"]}),"\n",(0,a.jsx)(n.li,{children:"SQL files for the Chinook Database"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["The SQL files should be placed in a ",(0,a.jsx)(n.code,{children:"sql/"})," directory and mounted to the container. The tutorial expects these SQL files to be available at ",(0,a.jsx)(n.code,{children:"/opt/ignite/downloads/"})," inside the container."]}),"\n",(0,a.jsx)(n.admonition,{type:"caution",children:(0,a.jsx)(n.p,{children:"Without these files, you will be unable to load the sample data needed for the exercises."})}),"\n",(0,a.jsx)(n.h2,{id:"setting-up-an-apache-ignite-3-cluster",children:"Setting Up an Apache Ignite 3 Cluster"}),"\n",(0,a.jsx)(n.p,{children:"Before we can start using SQL, we need to set up an Apache Ignite cluster. We will use Docker Compose to create a three-node cluster."}),"\n",(0,a.jsx)(n.h3,{id:"starting-the-cluster",children:"Starting the Cluster"}),"\n",(0,a.jsxs)(n.p,{children:["Open a terminal in the directory containing the docker compose file ",(0,a.jsx)(n.code,{children:"docker-compose.yml"})," file and start the cluster with Docker:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker compose up -d\n"})}),"\n",(0,a.jsx)(n.p,{children:"This command starts the cluster in detached mode. You should see startup messages from all three nodes. When they are ready, you will see messages indicating that the servers have started successfully."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker compose up -d\n\n[+] Running 4\n \u2714 Network ignite3_default    Created\n \u2714 Container ignite3-node2-1  Started\n \u2714 Container ignite3-node3-1  Started\n \u2714 Container ignite3-node1-1  Started\n"})}),"\n",(0,a.jsx)(n.p,{children:"You can check that all containers are running with the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker compose ps\n"})}),"\n",(0,a.jsx)(n.p,{children:'You should see all three nodes with a "running" status.'}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsx)(n.p,{children:'Verify that all three nodes are "running" before continuing.'})}),"\n",(0,a.jsx)(n.h2,{id:"connecting-to-the-cluster-using-ignite-cli",children:"Connecting to the Cluster Using Ignite CLI"}),"\n",(0,a.jsx)(n.p,{children:"Now we will connect to our running cluster using Ignite command-line interface (CLI)."}),"\n",(0,a.jsx)(n.h3,{id:"starting-the-cli",children:"Starting the CLI"}),"\n",(0,a.jsx)(n.p,{children:"In your terminal, run:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker run --rm -it --network=host -e LANG=C.UTF-8 -e LC_ALL=C.UTF-8 -v ./sql/:/opt/ignite/downloads/ apacheignite/ignite:3.0.0 cli\n"})}),"\n",(0,a.jsx)(n.p,{children:"This starts an interactive CLI container connected to the same Docker network as our cluster and mounts a volume containing the sql files for the Chinook Database. When prompted, connect to the default node. If you refused the connection, you can do it manually with the following command:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"connect http://localhost:10300\n"})}),"\n",(0,a.jsxs)(n.p,{children:["You should see a message that you're connected to ",(0,a.jsx)(n.code,{children:"http://localhost:10300"})," and a note that the cluster is not initialized."]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsx)(n.p,{children:"The CLI container runs separately from the cluster nodes, but connects to them over the Docker network."})}),"\n",(0,a.jsx)(n.h3,{id:"initializing-the-cluster",children:"Initializing the Cluster"}),"\n",(0,a.jsx)(n.p,{children:"Before we can use the cluster, we need to initialize it:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"cluster init --name=ignite3 --metastorage-group=node1,node2,node3\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsx)(n.p,{children:"If the license is not available, make sure the license file was mounted correctly."})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"           #              ___                         __\n         ###             /   |   ____   ____ _ _____ / /_   ___\n     #  #####           / /| |  / __ \\ / __ `// ___// __ \\ / _ \\\n   ###  ######         / ___ | / /_/ // /_/ // /__ / / / // ___/\n  #####  #######      /_/  |_|/ .___/ \\__,_/ \\___//_/ /_/ \\___/\n  #######  ######            /_/\n    ########  ####        ____               _  __           _____\n   #  ########  ##       /  _/____ _ ____   (_)/ /_ ___     |__  /\n  ####  #######  #       / / / __ `// __ \\ / // __// _ \\     /_ <\n   #####  #####        _/ / / /_/ // / / // // /_ / ___/   ___/ /\n     ####  ##         /___/ \\__, //_/ /_//_/ \\__/ \\___/   /____/\n       ##                  /____/\n\n                      Apache Ignite CLI version 3.0.0\n\n\nYou appear to have not connected to any node yet. Do you want to connect to the default node http://localhost:10300? [Y/n] y\nConnected to http://localhost:10300\nThe cluster is not initialized. Run cluster init command to initialize it.\n[node1]> cluster init --name=ignite3 --metastorage-group=node1,node2,node3\nCluster was initialized successfully\n[node1]>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"creating-the-chinook-database-schema",children:"Creating the Chinook Database Schema"}),"\n",(0,a.jsx)(n.p,{children:"Now that our cluster is running and initialized, we can start using SQL to create and work with data in Ignite. The Chinook database is a digital music store dataset, with tables for artists, albums, tracks, customers, and sales."}),"\n",(0,a.jsx)(n.h3,{id:"entering-sql-mode",children:"Entering SQL Mode"}),"\n",(0,a.jsx)(n.p,{children:"To start working with SQL, enter SQL mode in the CLI:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"sql\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Your prompt should change to ",(0,a.jsx)(n.code,{children:"sql-cli>"})," indicating you're now in SQL mode."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"[node1]> sql\nsql-cli>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"creating-distribution-zones",children:"Creating Distribution Zones"}),"\n",(0,a.jsx)(n.p,{children:"Before we create tables, let's set up distribution zones to control how our data is distributed and replicated across the cluster:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE ZONE IF NOT EXISTS Chinook WITH replicas=2, storage_profiles='default';\nCREATE ZONE IF NOT EXISTS ChinookReplicated WITH replicas=3, partitions=25, storage_profiles='default';\n"})}),"\n",(0,a.jsx)(n.p,{children:"These commands create two zones:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"Chinook"})," - Standard zone with 2 replicas for most tables;"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ChinookReplicated"})," - Zone with 3 replicas for frequently accessed reference data."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"database-entity-relationship",children:"Database Entity Relationship"}),"\n",(0,a.jsx)(n.p,{children:"Here's the entity relationship diagram for our Chinook database:"}),"\n",(0,a.jsx)(n.mermaid,{value:"erDiagram\n    ARTIST ||--o{ ALBUM : creates\n    ALBUM ||--o{ TRACK : contains\n    GENRE ||--o{ TRACK : categorizes\n    MEDIATYPE ||--o{ TRACK : formats\n    CUSTOMER ||--o{ INVOICE : places\n    INVOICE ||--o{ INVOICELINE : contains\n    TRACK ||--o{ INVOICELINE : purchased-in\n    EMPLOYEE ||--o{ CUSTOMER : supports\n    PLAYLIST ||--o{ PLAYLISTTRACK : contains\n    TRACK ||--o{ PLAYLISTTRACK : appears-in"}),"\n",(0,a.jsx)(n.h3,{id:"creating-core-tables",children:"Creating Core Tables"}),"\n",(0,a.jsx)(n.p,{children:"Now let's create the main tables for the Chinook database. We will start with the Artist and Album tables."}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["Copy and paste the following SQL blocks at the ",(0,a.jsx)(n.code,{children:"sql-cli>"})," prompt then hit enter."]})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Artist (\n    ArtistId INT NOT NULL,\n    Name VARCHAR(120),\n    PRIMARY KEY (ArtistId)\n) ZONE Chinook;\n\nCREATE TABLE Album (\n    AlbumId INT NOT NULL,\n    Title VARCHAR(160) NOT NULL,\n    ArtistId INT NOT NULL,\n    ReleaseYear INT,\n    PRIMARY KEY (AlbumId, ArtistId)\n) COLOCATE BY (ArtistId) ZONE Chinook;\n"})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"COLOCATE BY"})," clause in the ",(0,a.jsx)(n.strong,{children:"Album"})," table ensures that albums by the same artist are stored on the same nodes. This optimizes joins between Artist and Album tables by eliminating the need for network transfers during queries."]}),"\n",(0,a.jsx)(n.p,{children:"Next, let's create the Genre and MediaType reference tables:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Genre (\n    GenreId INT NOT NULL,\n    Name VARCHAR(120),\n    PRIMARY KEY (GenreId)\n) ZONE ChinookReplicated;\n\nCREATE TABLE MediaType (\n    MediaTypeId INT NOT NULL,\n    Name VARCHAR(120),\n    PRIMARY KEY (MediaTypeId)\n) ZONE ChinookReplicated;\n"})}),"\n",(0,a.jsxs)(n.p,{children:["These reference tables are placed in the ",(0,a.jsx)(n.code,{children:"ChinookReplicated"})," zone with 3 replicas because they contain static data that is frequently joined with other tables. Having a copy on each node improves read performance."]}),"\n",(0,a.jsx)(n.p,{children:"Now, let's create the Track table, which references the Album, Genre, and MediaType tables:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Track (\n    TrackId INT NOT NULL,\n    Name VARCHAR(200) NOT NULL,\n    AlbumId INT,\n    MediaTypeId INT NOT NULL,\n    GenreId INT,\n    Composer VARCHAR(220),\n    Milliseconds INT NOT NULL,\n    Bytes INT,\n    UnitPrice NUMERIC(10,2) NOT NULL,\n    PRIMARY KEY (TrackId, AlbumId)\n) COLOCATE BY (AlbumId) ZONE Chinook;\n"})}),"\n",(0,a.jsx)(n.p,{children:"Tracks are colocated by AlbumId, not by TrackId, because most queries join tracks with their albums. This colocation optimizes these common join patterns."}),"\n",(0,a.jsx)(n.p,{children:"Let's also create tables to manage customers, employees, and sales:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Employee (\n    EmployeeId INT NOT NULL,\n    LastName VARCHAR(20) NOT NULL,\n    FirstName VARCHAR(20) NOT NULL,\n    Title VARCHAR(30),\n    ReportsTo INT,\n    BirthDate DATE,\n    HireDate DATE,\n    Address VARCHAR(70),\n    City VARCHAR(40),\n    State VARCHAR(40),\n    Country VARCHAR(40),\n    PostalCode VARCHAR(10),\n    Phone VARCHAR(24),\n    Fax VARCHAR(24),\n    Email VARCHAR(60),\n    PRIMARY KEY (EmployeeId)\n) ZONE Chinook;\n\nCREATE TABLE Customer (\n    CustomerId INT NOT NULL,\n    FirstName VARCHAR(40) NOT NULL,\n    LastName VARCHAR(20) NOT NULL,\n    Company VARCHAR(80),\n    Address VARCHAR(70),\n    City VARCHAR(40),\n    State VARCHAR(40),\n    Country VARCHAR(40),\n    PostalCode VARCHAR(10),\n    Phone VARCHAR(24),\n    Fax VARCHAR(24),\n    Email VARCHAR(60) NOT NULL,\n    SupportRepId INT,\n    PRIMARY KEY (CustomerId)\n) ZONE Chinook;\n\nCREATE TABLE Invoice (\n    InvoiceId INT NOT NULL,\n    CustomerId INT NOT NULL,\n    InvoiceDate DATE NOT NULL,\n    BillingAddress VARCHAR(70),\n    BillingCity VARCHAR(40),\n    BillingState VARCHAR(40),\n    BillingCountry VARCHAR(40),\n    BillingPostalCode VARCHAR(10),\n    Total NUMERIC(10,2) NOT NULL,\n    PRIMARY KEY (InvoiceId, CustomerId)\n) COLOCATE BY (CustomerId) ZONE Chinook;\n\nCREATE TABLE InvoiceLine (\n    InvoiceLineId INT NOT NULL,\n    InvoiceId INT NOT NULL,\n    TrackId INT NOT NULL,\n    UnitPrice NUMERIC(10,2) NOT NULL,\n    Quantity INT NOT NULL,\n    PRIMARY KEY (InvoiceLineId, TrackId)\n) COLOCATE BY (TrackId) ZONE Chinook;\n"})}),"\n",(0,a.jsx)(n.p,{children:"Invoices are colocated by CustomerId and InvoiceLines are colocated by InvoiceId. This creates an efficient chain of locality: Customer \u2192 Invoice \u2192 InvoiceLine, optimizing queries that analyze customer purchase history."}),"\n",(0,a.jsx)(n.p,{children:"Finally, let's create the playlist-related tables:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Playlist (\n    PlaylistId INT NOT NULL,\n    Name VARCHAR(120),\n    PRIMARY KEY (PlaylistId)\n) ZONE Chinook;\n\nCREATE TABLE PlaylistTrack (\n    PlaylistId INT NOT NULL,\n    TrackId INT NOT NULL,\n    PRIMARY KEY (PlaylistId, TrackId)\n) ZONE Chinook;\n"})}),"\n",(0,a.jsx)(n.p,{children:"Note that PlaylistTrack is not colocated with Track. This is a design decision that prioritizes playlist operations over joining with track details. In a real-world scenario, you might make a different colocation choice depending on your most common query patterns."}),"\n",(0,a.jsx)(n.h3,{id:"verifying-table-creation",children:"Verifying Table Creation"}),"\n",(0,a.jsx)(n.p,{children:"Let's confirm that all our tables were created successfully:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM system.tables WHERE schema = 'PUBLIC';\n"})}),"\n",(0,a.jsx)(n.p,{children:"This query checks the system tables to verify that our tables exist. You should see a list of all the tables we've created."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sql-cli> SELECT * FROM system.tables WHERE schema = 'PUBLIC';\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 SCHEMA \u2502 NAME          \u2502 ID \u2502 PK_INDEX_ID \u2502 ZONE              \u2502 STORAGE_PROFILE \u2502 COLOCATION_KEY_INDEX \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 PUBLIC \u2502 ALBUM         \u2502 20 \u2502 21          \u2502 CHINOOK           \u2502 default         \u2502 ARTISTID             \u2551\n\u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\n\u2551 PUBLIC \u2502 GENRE         \u2502 22 \u2502 23          \u2502 CHINOOKREPLICATED \u2502 default         \u2502 GENREID              \u2551\n\u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\n\u2551 PUBLIC \u2502 ARTIST        \u2502 18 \u2502 19          \u2502 CHINOOK           \u2502 default         \u2502 ARTISTID             \u2551\n\u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\n\u2551 PUBLIC \u2502 TRACK         \u2502 26 \u2502 27          \u2502 CHINOOK           \u2502 default         \u2502 ALBUMID              \u2551\n\u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\n\u2551 PUBLIC \u2502 PLAYLIST      \u2502 36 \u2502 37          \u2502 CHINOOK           \u2502 default         \u2502 PLAYLISTID           \u2551\n\u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\n\u2551 PUBLIC \u2502 PLAYLISTTRACK \u2502 38 \u2502 39          \u2502 CHINOOK           \u2502 default         \u2502 PLAYLISTID, TRACKID  \u2551\n\u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\n\u2551 PUBLIC \u2502 MEDIATYPE     \u2502 24 \u2502 25          \u2502 CHINOOKREPLICATED \u2502 default         \u2502 MEDIATYPEID          \u2551\n\u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\n\u2551 PUBLIC \u2502 INVOICELINE   \u2502 34 \u2502 35          \u2502 CHINOOK           \u2502 default         \u2502 TRACKID              \u2551\n\u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\n\u2551 PUBLIC \u2502 EMPLOYEE      \u2502 28 \u2502 29          \u2502 CHINOOK           \u2502 default         \u2502 EMPLOYEEID           \u2551\n\u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\n\u2551 PUBLIC \u2502 CUSTOMER      \u2502 30 \u2502 31          \u2502 CHINOOK           \u2502 default         \u2502 CUSTOMERID           \u2551\n\u255f\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2562\n\u2551 PUBLIC \u2502 INVOICE       \u2502 32 \u2502 33          \u2502 CHINOOK           \u2502 default         \u2502 CUSTOMERID           \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Checkpoint"}),": Verify that all tables appear in the ",(0,a.jsx)(n.code,{children:"system.tables"})," output with their proper zones and colocation settings before proceeding to the next section."]})}),"\n",(0,a.jsx)(n.h2,{id:"inserting-sample-data",children:"Inserting Sample Data"}),"\n",(0,a.jsx)(n.p,{children:"Now that we have our tables set up, let's populate them with sample data."}),"\n",(0,a.jsx)(n.h3,{id:"adding-artists-and-albums",children:"Adding Artists and Albums"}),"\n",(0,a.jsx)(n.p,{children:"Let's start by adding some artists."}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Exit the interactive sql mode by typing ",(0,a.jsx)(n.code,{children:"exit;"}),"."]}),"\n",(0,a.jsx)(n.li,{children:"Then, load the current store catalog from the sql data file."}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sql --file=/opt/ignite/downloads/current_catalog.sql\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sql-cli> exit;\n[node1]> sql --file=/opt/ignite/downloads/current_catalog.sql\nUpdated 275 rows.\nUpdated 347 rows.\n"})}),"\n",(0,a.jsx)(n.h3,{id:"adding-genres-and-media-types",children:"Adding Genres and Media Types"}),"\n",(0,a.jsx)(n.p,{children:"Let's populate our reference tables the same way:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sql --file=/opt/ignite/downloads/media_and_genre.sql\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"[node1]> sql --file=/opt/ignite/downloads/media_and_genre.sql\nUpdated 25 rows.\nUpdated 5 rows.\n"})}),"\n",(0,a.jsx)(n.h3,{id:"adding-tracks",children:"Adding Tracks"}),"\n",(0,a.jsx)(n.p,{children:"Now let's add some tracks to our albums:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sql --file=/opt/ignite/downloads/tracks.sql\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"[node1]> sql --file=/opt/ignite/downloads/tracks.sql\nUpdated 1000 rows.\nUpdated 1000 rows.\nUpdated 1000 rows.\nUpdated 503 rows.\n"})}),"\n",(0,a.jsx)(n.h3,{id:"adding-employees-and-customers",children:"Adding Employees and Customers"}),"\n",(0,a.jsx)(n.p,{children:"Let's add some employee and customer data:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sql --file=/opt/ignite/downloads/ee_and_cust.sql\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"[node1]> sql --file=/opt/ignite/downloads/ee_and_cust.sql\nUpdated 8 rows.\nUpdated 59 rows.\n"})}),"\n",(0,a.jsx)(n.h3,{id:"adding-invoices-and-invoice-lines",children:"Adding Invoices and Invoice Lines"}),"\n",(0,a.jsx)(n.p,{children:"Finally, let's add some sales data:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sql --file=/opt/ignite/downloads/invoices.sql\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"[node1]> sql --file=/opt/ignite/downloads/invoices.sql\nUpdated 412 rows.\nUpdated 1000 rows.\nUpdated 1000 rows.\nUpdated 240 rows.\nUpdated 18 rows.\nUpdated 1000 rows.\nUpdated 1000 rows.\nUpdated 1000 rows.\nUpdated 1000 rows.\nUpdated 1000 rows.\nUpdated 1000 rows.\nUpdated 1000 rows.\nUpdated 1000 rows.\nUpdated 715 rows.\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Checkpoint"}),': Verify that all the data has been loaded successfully by checking that the "Updated X rows" messages match the expected row counts for each file.']})}),"\n",(0,a.jsx)(n.h2,{id:"querying-data-in-ignite-sql",children:"Querying Data in Ignite SQL"}),"\n",(0,a.jsx)(n.p,{children:"Now that we have data in our tables, let's run some SQL queries to explore the Chinook database."}),"\n",(0,a.jsx)(n.h3,{id:"basic-queries",children:"Basic Queries"}),"\n",(0,a.jsxs)(n.p,{children:["Let's return to the ",(0,a.jsx)(n.code,{children:"sql-cli>"})," and start with some simple SELECT queries:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sql\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Get all artists\nSELECT * FROM Artist;\n\n-- Get all albums for a specific artist\nSELECT * FROM Album WHERE ArtistId = 3;\n\n-- Get all tracks for a specific album\nSELECT * FROM Track WHERE AlbumId = 133;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"joins",children:"Joins"}),"\n",(0,a.jsx)(n.p,{children:"Now let's try some more complex queries with joins:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Get all tracks with artist and album information\nSELECT\n    t.Name AS TrackName,\n    a.Title AS AlbumTitle,\n    ar.Name AS ArtistName\nFROM\n    Track t\n    JOIN Album a ON t.AlbumId = a.AlbumId\n    JOIN Artist ar ON a.ArtistId = ar.ArtistId\nLIMIT 10;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"data-manipulation-in-ignite-sql",children:"Data Manipulation in Ignite SQL"}),"\n",(0,a.jsx)(n.p,{children:"Let's explore how to modify data using SQL in Ignite."}),"\n",(0,a.jsx)(n.h3,{id:"understanding-distributed-updates",children:"Understanding Distributed Updates"}),"\n",(0,a.jsx)(n.p,{children:"When you update data in a distributed database, the changes need to be coordinated across multiple nodes:"}),"\n",(0,a.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Client\n    participant Node1\n    participant Node2\n    participant Node3\n\n    Client->>Node1: UPDATE request\n    Node1->>Node1: Update local primary copy\n    Node1->>Node2: Propagate changes to backup copy\n    Node1--\x3e>Client: Confirm update completed"}),"\n",(0,a.jsx)(n.h3,{id:"inserting-new-data",children:"Inserting New Data"}),"\n",(0,a.jsx)(n.p,{children:"Let's add a new artist and album:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Insert a new artist\nINSERT INTO Artist (ArtistId, Name)\nVALUES (276, 'New Discovery Band');\n\n-- Insert a new album for this artist\nINSERT INTO Album (AlbumId, Title, ArtistId, ReleaseYear)\nVALUES (348, 'First Light', 276, 2023);\n\n-- Verify the insertions\nSELECT * FROM Artist WHERE ArtistId = 276;\nSELECT * FROM Album WHERE AlbumId = 348;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"updating-existing-data",children:"Updating Existing Data"}),"\n",(0,a.jsx)(n.p,{children:"Now let's update some of our existing data:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Update the album release year\nUPDATE Album\nSET ReleaseYear = 2024\nWHERE AlbumId = 348;\n\n-- Update the artist name\nUPDATE Artist\nSET Name = 'New Discovery Ensemble'\nWHERE ArtistId = 276;\n\n-- Verify the updates\nSELECT * FROM Artist WHERE ArtistId = 276;\nSELECT * FROM Album WHERE AlbumId = 348;\n"})}),"\n",(0,a.jsx)(n.p,{children:"In a distributed database like Ignite, these updates are automatically propagated to all replicas. The primary copy is updated first, then the changes are sent to the backup copies on other nodes."}),"\n",(0,a.jsx)(n.h3,{id:"deleting-data",children:"Deleting Data"}),"\n",(0,a.jsx)(n.p,{children:"Finally, let's clean up by deleting the data we added:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Delete the album\nDELETE FROM Album WHERE AlbumId = 348;\n\n-- Delete the artist\nDELETE FROM Artist WHERE ArtistId = 276;\n\n-- Verify the deletions\nSELECT * FROM Artist WHERE ArtistId = 276;\nSELECT * FROM Album WHERE AlbumId = 348;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"advanced-sql-features",children:"Advanced SQL Features"}),"\n",(0,a.jsx)(n.p,{children:"Let's explore some of Ignite's more advanced SQL features."}),"\n",(0,a.jsx)(n.h3,{id:"querying-system-views",children:"Querying System Views"}),"\n",(0,a.jsx)(n.p,{children:"Ignite provides system views that let you inspect cluster metadata:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- View all tables in the cluster\nSELECT * FROM system.tables;\n\n-- View all zones\nSELECT * FROM system.zones;\n\n-- View all columns for a specific table\nSELECT * FROM system.table_columns WHERE TABLE_NAME = 'TRACK';\n"})}),"\n",(0,a.jsx)(n.p,{children:"System views provide important metadata about your cluster configuration. They are essential for monitoring and troubleshooting in production environments."}),"\n",(0,a.jsx)(n.h3,{id:"creating-indexes-for-better-performance",children:"Creating Indexes for Better Performance"}),"\n",(0,a.jsx)(n.p,{children:"Let's add some indexes to improve query performance:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Create an index on the Name column of the Track table\nCREATE INDEX idx_track_name ON Track (Name);\n\n-- Create a composite index on Artist and Album\nCREATE INDEX idx_album_artist ON Album (ArtistId, Title);\n\n-- Create a composite index on Track's AlbumId and Name columns to optimize joins with Album table\n-- and to improve performance when filtering or sorting by track name within an album\nCREATE INDEX idx_track_albumid_name ON Track(AlbumId, Name);\n\n-- Create an index on Album Title to speed up searches and sorts by album title\nCREATE INDEX idx_album_title ON Album(Title);\n\n-- Create a composite index on InvoiceLine connecting TrackId and InvoiceId\n-- This supports efficient queries that join InvoiceLine with Track while filtering by InvoiceId\nCREATE INDEX idx_invoiceline_trackid_invoiceid ON InvoiceLine(TrackId, InvoiceId);\n\n-- Create a hash index for lookups by email\nCREATE INDEX idx_customer_email ON Customer USING HASH (Email);\n\n-- Check index information\nSELECT * FROM system.indexes;\n"})}),"\n",(0,a.jsx)(n.p,{children:"Indexes improve query performance, but come with maintenance costs. Each write operation must also update all indexes. Choose indexes that support your most common query patterns rather than indexing everything."}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-dashboard-using-sql",children:"Creating a Dashboard Using SQL"}),"\n",(0,a.jsx)(n.p,{children:"Let's create SQL queries that could be used for a music store dashboard. These queries could be saved and run periodically to generate reports."}),"\n",(0,a.jsx)(n.h3,{id:"monthly-sales-summary",children:"Monthly Sales Summary"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Monthly sales summary for the last 12 months\nSELECT\n    CAST(EXTRACT(YEAR FROM i.InvoiceDate) AS VARCHAR) || '-' ||\n    CASE\n        WHEN EXTRACT(MONTH FROM i.InvoiceDate) < 10\n        THEN '0' || CAST(EXTRACT(MONTH FROM i.InvoiceDate) AS VARCHAR)\n        ELSE CAST(EXTRACT(MONTH FROM i.InvoiceDate) AS VARCHAR)\n    END AS YearMonth,\n    COUNT(DISTINCT i.InvoiceId) AS InvoiceCount,\n    COUNT(DISTINCT i.CustomerId) AS CustomerCount,\n    SUM(i.Total) AS MonthlyRevenue,\n    AVG(i.Total) AS AverageOrderValue\nFROM\n    Invoice i\nGROUP BY\n    EXTRACT(YEAR FROM i.InvoiceDate), EXTRACT(MONTH FROM i.InvoiceDate)\nORDER BY\n    YearMonth DESC;\n"})}),"\n",(0,a.jsx)(n.p,{children:"This query formats the year and month into a sortable string (YYYY-MM) while calculating several key business metrics."}),"\n",(0,a.jsx)(n.h3,{id:"top-selling-genres",children:"Top Selling Genres"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Top selling genres by revenue\nSELECT\n    g.Name AS Genre,\n    SUM(il.UnitPrice * il.Quantity) AS Revenue\nFROM\n    InvoiceLine il\n    JOIN Track t ON il.TrackId = t.TrackId\n    JOIN Genre g ON t.GenreId = g.GenreId\nGROUP BY\n    g.Name\nORDER BY\n    Revenue DESC;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"sales-performance-by-employee",children:"Sales Performance by Employee"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Sales performance by employee\nSELECT\n    e.EmployeeId,\n    e.FirstName || ' ' || e.LastName AS EmployeeName,\n    COUNT(DISTINCT i.InvoiceId) AS TotalInvoices,\n    COUNT(DISTINCT i.CustomerId) AS UniqueCustomers,\n    SUM(i.Total) AS TotalSales\nFROM\n    Employee e\n    JOIN Customer c ON e.EmployeeId = c.SupportRepId\n    JOIN Invoice i ON c.CustomerId = i.CustomerId\nGROUP BY\n    e.EmployeeId, e.FirstName, e.LastName\nORDER BY\n    TotalSales DESC;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"top-20-longest-tracks-with-genres",children:"Top 20 Longest Tracks with Genres"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Top 20 longest tracks with genre information\nSELECT\n    t.trackid,\n    t.name AS track_name,\n    g.name AS genre_name,\n    ROUND(t.milliseconds / (1000 * 60), 2) AS duration_minutes\nFROM\n    track t\n    JOIN genre g ON t.genreId = g.genreId\nWHERE\n    t.genreId < 17\nORDER BY\n    duration_minutes DESC\nLIMIT\n    20;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"customer-purchase-patterns-by-month",children:"Customer Purchase Patterns by Month"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- Customer purchase patterns by month\nSELECT\n    c.CustomerId,\n    c.FirstName || ' ' || c.LastName AS CustomerName,\n    CAST(EXTRACT(YEAR FROM i.InvoiceDate) AS VARCHAR) || '-' ||\n    CASE\n        WHEN EXTRACT(MONTH FROM i.InvoiceDate) < 10\n        THEN '0' || CAST(EXTRACT(MONTH FROM i.InvoiceDate) AS VARCHAR)\n        ELSE CAST(EXTRACT(MONTH FROM i.InvoiceDate) AS VARCHAR)\n    END AS YearMonth,\n    COUNT(DISTINCT i.InvoiceId) AS NumberOfPurchases,\n    SUM(i.Total) AS TotalSpent,\n    SUM(i.Total) / COUNT(DISTINCT i.InvoiceId) AS AveragePurchaseValue\nFROM\n    Customer c\n    JOIN Invoice i ON c.CustomerId = i.CustomerId\nGROUP BY\n    c.CustomerId, c.FirstName, c.LastName,\n    EXTRACT(YEAR FROM i.InvoiceDate), EXTRACT(MONTH FROM i.InvoiceDate)\nORDER BY\n    c.CustomerId, YearMonth;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"performance-tuning-with-colocated-tables",children:"Performance Tuning with Colocated Tables"}),"\n",(0,a.jsx)(n.p,{children:"One of the key advantages of Ignite is its ability to optimize joins through data colocation. Let's explore this with our existing colocated tables."}),"\n",(0,a.jsx)(n.h3,{id:"colocated-queries",children:"Colocated Queries"}),"\n",(0,a.jsx)(n.p,{children:"Let's start by looking at a query where there is a mismatch in the colocation strategy."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"--This is an example of a poorly created table.\nCREATE TABLE InvoiceLine (\n    InvoiceLineId INT NOT NULL,\n    InvoiceId INT NOT NULL,\n    TrackId INT NOT NULL,\n    UnitPrice NUMERIC(10,2) NOT NULL,\n    Quantity INT NOT NULL,\n    PRIMARY KEY (InvoiceLineId, InvoiceId)\n) COLOCATE BY (InvoiceId) ZONE Chinook;\n"})}),"\n",(0,a.jsxs)(n.p,{children:["If we create the ",(0,a.jsx)(n.code,{children:"InvoiceLine"})," table to be colocated by InvoiceId, we end up with a mismatch for our query."]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Album is colocated by ArtistId"}),"\n",(0,a.jsx)(n.li,{children:"Track is colocated by AlbumId"}),"\n",(0,a.jsx)(n.li,{children:"InvoiceLine is colocated by InvoiceId"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"This means that when you run a query joining InvoiceLine, Track, and Album, the data might be spread across different nodes because they're colocated on different keys. Our query is looking for invoice ID 1, then joining with Track and Album, but these tables are colocated on different keys."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"EXPLAIN PLAN FOR\nSELECT\n    il.InvoiceId,\n    COUNT(il.InvoiceLineId) AS LineItemCount,\n    SUM(il.UnitPrice * il.Quantity) AS InvoiceTotal,\n    t.Name AS TrackName,\n    a.Title AS AlbumTitle\nFROM\n    InvoiceLine il\n    JOIN Track t ON il.TrackId = t.TrackId\n    JOIN Album a ON t.AlbumId = a.AlbumId\nWHERE\n    il.InvoiceId = 1\nGROUP BY\n    il.InvoiceId, t.Name, a.Title;\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 PLAN                                                                                                                                                                                                                                                                                      \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Project(INVOICEID=[$0], LINEITEMCOUNT=[$3], INVOICETOTAL=[$4], TRACKNAME=[$1], ALBUMTITLE=[$2]): rowcount = 4484471.100479999, cumulative cost = IgniteCost [rowCount=2.3054813220479995E7, cpu=2.3643376967575923E7, memory=9.866772781055996E7, io=2.0, network=50190.0], id = 23843    \u2551\n\u2551   ColocatedHashAggregate(group=[{0, 1, 2}], LINEITEMCOUNT=[COUNT()], INVOICETOTAL=[SUM($3)]): rowcount = 4484471.100479999, cumulative cost = IgniteCost [rowCount=1.8570341119999997E7, cpu=1.9158904867095925E7, memory=9.866772681055996E7, io=1.0, network=50189.0], id = 23842       \u2551\n\u2551     Project(INVOICEID=[$3], TRACKNAME=[$1], ALBUMTITLE=[$8], $f4=[*($5, $6)]): rowcount = 9189489.959999999, cumulative cost = IgniteCost [rowCount=9380851.159999998, cpu=9969414.907095924, memory=9362.6, io=1.0, network=50189.0], id = 23841                                         \u2551\n\u2551       MergeJoin(condition=[=($2, $7)], joinType=[inner], leftCollation=[[2]], rightCollation=[[0]]): rowcount = 9189489.959999999, cumulative cost = IgniteCost [rowCount=191360.19999999998, cpu=779923.9470959246, memory=9361.6, io=0.0, network=50188.0], id = 23840                  \u2551\n\u2551         HashJoin(condition=[=($4, $0)], joinType=[inner]): rowcount = 176551.19999999998, cumulative cost = IgniteCost [rowCount=13421.0, cpu=65201.0, memory=6585.6, io=0.0, network=47412.0], id = 23836                                                                                \u2551\n\u2551           Exchange(distribution=[single]): rowcount = 3503.0, cumulative cost = IgniteCost [rowCount=7006.0, cpu=17515.0, memory=0.0, io=0.0, network=42036.0], id = 23833                                                                                                                \u2551\n\u2551             IndexScan(table=[[PUBLIC, TRACK]], tableId=[26], index=[IDX_TRACK_ALBUMID_NAME], type=[SORTED], requiredColumns=[{0, 1, 2}], collation=[[2, 1]]): rowcount = 3503.0, cumulative cost = IgniteCost [rowCount=3503.0, cpu=14012.0, memory=0.0, io=0.0, network=0.0], id = 23832 \u2551\n\u2551           Exchange(distribution=[single]): rowcount = 336.0, cumulative cost = IgniteCost [rowCount=2576.0, cpu=9296.0, memory=0.0, io=0.0, network=5376.0], id = 23835                                                                                                                   \u2551\n\u2551             TableScan(table=[[PUBLIC, INVOICELINE]], tableId=[34], filters=[=($t0, 1)], requiredColumns=[{1, 2, 3, 4}]): rowcount = 336.0, cumulative cost = IgniteCost [rowCount=2240.0, cpu=8960.0, memory=0.0, io=0.0, network=0.0], id = 23834                                        \u2551\n\u2551         Exchange(distribution=[single]): rowcount = 347.0, cumulative cost = IgniteCost [rowCount=1041.0, cpu=7130.147095924681, memory=2776.0, io=0.0, network=2776.0], id = 23839                                                                                                       \u2551\n\u2551           Sort(sort0=[$0], dir0=[ASC]): rowcount = 347.0, cumulative cost = IgniteCost [rowCount=694.0, cpu=6783.147095924681, memory=2776.0, io=0.0, network=0.0], id = 23838                                                                                                            \u2551\n\u2551             TableScan(table=[[PUBLIC, ALBUM]], tableId=[20], requiredColumns=[{0, 1}]): rowcount = 347.0, cumulative cost = IgniteCost [rowCount=347.0, cpu=347.0, memory=0.0, io=0.0, network=0.0], id = 23837                                                                           \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n"})}),"\n",(0,a.jsx)(n.h4,{id:"key-observations-in-the-execution-plan",children:"Key Observations in the Execution Plan"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"ColocatedHashAggregate Operation"}),": The plan uses a ",(0,a.jsx)(n.code,{children:"ColocatedHashAggregate"})," operation, which indicates Ignite recognizes that portions of the aggregation can happen on colocated data before results are combined. This reduces network transfer during the ",(0,a.jsx)(n.code,{children:"GROUP BY"})," operation."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Exchange Operations"}),": Several ",(0,a.jsx)(n.code,{children:"Exchange(distribution=[single])"})," operations appear in the plan, indicating data movement between nodes is still necessary. These operations are applied to the Album table, Track table, and InvoiceLine filtered results."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Join Implementation"}),": The plan shows a combination of ",(0,a.jsx)(n.code,{children:"HashJoin"})," and ",(0,a.jsx)(n.code,{children:"MergeJoin"})," operations rather than nested loop joins. The optimizer has determined these join types are more efficient for the data volumes involved:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"HashJoin for joining Track with Album"}),"\n",(0,a.jsx)(n.li,{children:"MergeJoin for joining the above result with InvoiceLine"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Efficient Data Access"}),": The query uses an ",(0,a.jsx)(n.code,{children:"IndexScan"})," with the ",(0,a.jsx)(n.code,{children:"IDX_INVOICELINE_INVOICE_TRACK"})," index rather than a full table scan on InvoiceLine. This provides:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Efficient filtering with ",(0,a.jsx)(n.code,{children:"searchBounds: [ExactBounds [bound=1], null]"})," for InvoiceId = 1"]}),"\n",(0,a.jsxs)(n.li,{children:["Pre-sorted results with ",(0,a.jsx)(n.code,{children:"collation: [INVOICEID ASC, TRACKID ASC]"})]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Row Count Estimation"}),": There appears to be a significant increase in estimated row counts after joins:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Initial InvoiceLine filtered rows: 746"}),"\n",(0,a.jsx)(n.li,{children:"After HashJoin with Album: 182,331"}),"\n",(0,a.jsx)(n.li,{children:"After MergeJoin with Track: 20,400,668"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"improved-cololocation-strategy",children:"Improved Cololocation Strategy"}),"\n",(0,a.jsxs)(n.p,{children:["However, if we create the ",(0,a.jsx)(n.code,{children:"InvoiceLine"})," table to be colocated by ",(0,a.jsx)(n.code,{children:"TrackId"}),", we dramaticly optimize our query."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"--This table was already created on an earlier step.\nCREATE TABLE InvoiceLine (\n    InvoiceLineId INT NOT NULL,\n    InvoiceId INT NOT NULL,\n    TrackId INT NOT NULL,\n    UnitPrice NUMERIC(10,2) NOT NULL,\n    Quantity INT NOT NULL,\n    PRIMARY KEY (InvoiceLineId, TrackId)\n) COLOCATE BY (TrackId) ZONE Chinook;\n"})}),"\n",(0,a.jsxs)(n.p,{children:["And run ",(0,a.jsx)(n.code,{children:"EXPLAIN PLAN FOR"})," again..."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"EXPLAIN PLAN FOR\nSELECT\n    il.InvoiceId,\n    COUNT(il.InvoiceLineId) AS LineItemCount,\n    SUM(il.UnitPrice * il.Quantity) AS InvoiceTotal,\n    t.Name AS TrackName,\n    a.Title AS AlbumTitle\nFROM\n    Track t\n    JOIN Album a ON t.AlbumId = a.AlbumId\n    JOIN InvoiceLine il ON t.TrackId = il.TrackId\nWHERE\n    il.InvoiceId = 1\nGROUP BY\n    il.InvoiceId, t.Name, a.Title;\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 PLAN                                                                                                                                                                                                                                                                                       \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Project(INVOICEID=[$0], LINEITEMCOUNT=[$3], INVOICETOTAL=[$4], TRACKNAME=[$1], ALBUMTITLE=[$2]): rowcount = 2.0019960269999995E9, cumulative cost = IgniteCost [rowCount=1.020839200715E10, cpu=1.0214411135647097E10, memory=4.404685537199999E10, io=2.0, network=2444814.0], id = 25112 \u2551\n\u2551   ColocatedHashAggregate(group=[{0, 1, 2}], LINEITEMCOUNT=[COUNT()], INVOICETOTAL=[SUM($3)]): rowcount = 2.0019960269999995E9, cumulative cost = IgniteCost [rowCount=8.20639597915E9, cpu=8.212415107647097E9, memory=4.404685537099999E10, io=1.0, network=2444813.0], id = 25111        \u2551\n\u2551     Project(INVOICEID=[$5], TRACKNAME=[$1], ALBUMTITLE=[$4], $f4=[*($7, $8)]): rowcount = 4.102450875E9, cumulative cost = IgniteCost [rowCount=4.10394510415E9, cpu=4.109964232647096E9, memory=2942777.0, io=1.0, network=2444813.0], id = 25110                                         \u2551\n\u2551       HashJoin(condition=[=($0, $6)], joinType=[inner]): rowcount = 4.102450875E9, cumulative cost = IgniteCost [rowCount=1494228.15, cpu=7513356.647095924, memory=2942776.0, io=0.0, network=2444812.0], id = 25109                                                                      \u2551\n\u2551         MergeJoin(condition=[=($2, $3)], joinType=[inner], leftCollation=[[2, 1]], rightCollation=[[0]]): rowcount = 182331.15, cumulative cost = IgniteCost [rowCount=11897.0, cpu=40045.14709592468, memory=2776.0, io=0.0, network=44812.0], id = 25106                                 \u2551\n\u2551           Exchange(distribution=[single]): rowcount = 3503.0, cumulative cost = IgniteCost [rowCount=7006.0, cpu=17515.0, memory=0.0, io=0.0, network=42036.0], id = 25102                                                                                                                 \u2551\n\u2551             IndexScan(table=[[PUBLIC, TRACK]], tableId=[26], index=[IDX_TRACK_ALBUMID_NAME], type=[SORTED], requiredColumns=[{0, 1, 2}], collation=[[2, 1]]): rowcount = 3503.0, cumulative cost = IgniteCost [rowCount=3503.0, cpu=14012.0, memory=0.0, io=0.0, network=0.0], id = 25101  \u2551\n\u2551           Exchange(distribution=[single]): rowcount = 347.0, cumulative cost = IgniteCost [rowCount=1041.0, cpu=7130.147095924681, memory=2776.0, io=0.0, network=2776.0], id = 25105                                                                                                      \u2551\n\u2551             Sort(sort0=[$0], dir0=[ASC]): rowcount = 347.0, cumulative cost = IgniteCost [rowCount=694.0, cpu=6783.147095924681, memory=2776.0, io=0.0, network=0.0], id = 25104                                                                                                           \u2551\n\u2551               TableScan(table=[[PUBLIC, ALBUM]], tableId=[20], requiredColumns=[{0, 1}]): rowcount = 347.0, cumulative cost = IgniteCost [rowCount=347.0, cpu=347.0, memory=0.0, io=0.0, network=0.0], id = 25103                                                                          \u2551\n\u2551         Exchange(distribution=[single]): rowcount = 150000.0, cumulative cost = IgniteCost [rowCount=1150000.0, cpu=4150000.0, memory=0.0, io=0.0, network=2400000.0], id = 25108                                                                                                          \u2551\n\u2551           TableScan(table=[[PUBLIC, INVOICELINE]], tableId=[46], filters=[=($t0, 1)], requiredColumns=[{1, 2, 3, 4}]): rowcount = 150000.0, cumulative cost = IgniteCost [rowCount=1000000.0, cpu=4000000.0, memory=0.0, io=0.0, network=0.0], id = 25107                                  \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n"})}),"\n",(0,a.jsx)(n.h4,{id:"key-observations-in-the-execution-plan-1",children:"Key Observations in the Execution Plan"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"ColocatedHashAggregate Operation"}),": The plan uses a ",(0,a.jsx)(n.code,{children:"ColocatedHashAggregate"})," operation, which indicates Ignite recognizes that portions of the aggregation can happen on colocated data before results are combined. This reduces network transfer during the ",(0,a.jsx)(n.code,{children:"GROUP BY"})," operation."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Improved Row Count Estimates"}),": Notice the dramatic improvement in row count estimates, which now show just 1 row at each step. This indicates the optimizer has much better statistics and understanding of the actual data distribution compared to the original plan that estimated millions of rows."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Join Implementation"}),": The plan shows a combination of ",(0,a.jsx)(n.code,{children:"HashJoin"})," and ",(0,a.jsx)(n.code,{children:"MergeJoin"})," operations:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"HashJoin for joining Track with InvoiceLine"}),"\n",(0,a.jsx)(n.li,{children:"MergeJoin for joining the above result with Album"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Efficient Index Usage"}),": The query now uses the composite index ",(0,a.jsx)(n.code,{children:"IDX_TRACK_ALBUMID_NAME"})," on the Track table, providing:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Efficient sorted access by AlbumId and Name"}),"\n",(0,a.jsx)(n.li,{children:"Direct access to the fields needed for the join and select operations"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Exchange Operations"}),": While Exchange operations still appear in the plan, the estimated row counts are now minimal (just 1 row per exchange). This suggests much less data movement between nodes compared to the original plan where millions of rows were estimated to be transferred."]}),"\n",(0,a.jsx)(n.h4,{id:"colocation-impact",children:"Colocation Impact"}),"\n",(0,a.jsx)(n.p,{children:"The substantial improvement in this execution plan demonstrates the power of proper data colocation in Ignite. By:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Structuring the query to join the tables in the optimal order (Track \u2192 Album \u2192 InvoiceLine)"}),"\n",(0,a.jsx)(n.li,{children:"Creating appropriate supporting indexes"}),"\n",(0,a.jsx)(n.li,{children:"Ensuring proper colocation between related tables"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"We've achieved a dramatic reduction in estimated row counts and data movement. The execution plan now shows streamlined operations with minimal row estimates at each step, indicating an efficient execution path that takes advantage of data locality."}),"\n",(0,a.jsx)(n.p,{children:"This optimization approach highlights three key principles for optimal performance in distributed SQL databases:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Proper colocation of related data"}),"\n",(0,a.jsx)(n.li,{children:"Supporting indexes aligned with join patterns"}),"\n",(0,a.jsx)(n.li,{children:"Query structure that follows the colocation model"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"cleaning-up",children:"Cleaning Up"}),"\n",(0,a.jsx)(n.p,{children:"When you are finished with the Ignite SQL CLI, you can exit by typing:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"exit;\n"})}),"\n",(0,a.jsx)(n.p,{children:"This will return you to the Ignite CLI. To exit the Ignite CLI, type:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"exit\n"})}),"\n",(0,a.jsx)(n.p,{children:"To stop the Ignite cluster, run the following command in your terminal:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"docker compose down\n"})}),"\n",(0,a.jsx)(n.p,{children:"This will stop and remove the Docker containers for your Ignite cluster."}),"\n",(0,a.jsx)(n.h2,{id:"best-practices-for-ignite-sql",children:"Best Practices for Ignite SQL"}),"\n",(0,a.jsx)(n.p,{children:"To get the most out of Ignite SQL, follow these best practices:"}),"\n",(0,a.jsx)(n.h3,{id:"schema-design",children:"Schema Design"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Use appropriate colocation for tables that are frequently joined;"}),"\n",(0,a.jsx)(n.li,{children:"Choose primary keys that distribute data evenly across the cluster;"}),"\n",(0,a.jsx)(n.li,{children:"Design with query patterns in mind, especially for large-scale deployments."}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"query-optimization",children:"Query Optimization"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Create indexes for columns used in ",(0,a.jsx)(n.code,{children:"WHERE"}),", ",(0,a.jsx)(n.code,{children:"JOIN"}),", and ",(0,a.jsx)(n.code,{children:"ORDER BY"})," clauses;"]}),"\n",(0,a.jsxs)(n.li,{children:["Use the ",(0,a.jsx)(n.code,{children:"EXPLAIN"})," statement to analyze and optimize your queries;"]}),"\n",(0,a.jsx)(n.li,{children:"Avoid cartesian products and inefficient join conditions."}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"transaction-management",children:"Transaction Management"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Keep transactions as short as possible;"}),"\n",(0,a.jsx)(n.li,{children:"Do not hold transactions open during user think time;"}),"\n",(0,a.jsx)(n.li,{children:"Group related operations into a single transaction for atomicity."}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"resource-management",children:"Resource Management"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Monitor query performance in production;"}),"\n",(0,a.jsx)(n.li,{children:"Consider partitioning strategies for very large tables;"}),"\n",(0,a.jsx)(n.li,{children:"Use appropriate data types to minimize storage requirements."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"whats-next",children:"What's Next"}),"\n",(0,a.jsx)(n.p,{children:"Ignite's SQL capabilities make it a powerful platform for building distributed applications that require high throughput, low latency, and strong consistency. By following the patterns and practices in this guide, you can leverage Ignite SQL to build scalable, resilient systems."}),"\n",(0,a.jsx)(n.p,{children:"Remember that Ignite is not just a SQL database. It's a distributed computing platform with capabilities beyond what we've covered here. As you become more comfortable with Ignite SQL, you may want to explore other features such as compute grid, machine learning, and stream processing."}),"\n",(0,a.jsx)(n.p,{children:"Happy querying!"})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);