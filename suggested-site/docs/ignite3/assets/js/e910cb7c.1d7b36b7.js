"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[8351],{28453:(e,n,o)=>{o.d(n,{R:()=>c,x:()=>s});var t=o(96540);const a={},i=t.createContext(a);function c(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),t.createElement(i.Provider,{value:n},e.children)}},62660:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>r,contentTitle:()=>s,default:()=>p,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"configure-and-operate/operations/colocation","title":"Data Colocation","description":"In many cases you may want to store related data on the same node. This way multi-entry queries do not need to pull data from other nodes and are thus executed faster.","source":"@site/docs/configure-and-operate/operations/colocation.md","sourceDirName":"configure-and-operate/operations","slug":"/configure-and-operate/operations/colocation","permalink":"/suggested-site/docs/ignite3/3.1.0/configure-and-operate/operations/colocation","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/ignite-3/tree/main/docs/docs/configure-and-operate/operations/colocation.md","tags":[],"version":"current","frontMatter":{"id":"colocation","title":"Data Colocation","sidebar_label":"Colocation"},"sidebar":"tutorialSidebar","previous":{"title":"Handle Exceptions","permalink":"/suggested-site/docs/ignite3/3.1.0/configure-and-operate/operations/handle-exceptions"},"next":{"title":"Monitoring","permalink":"/suggested-site/docs/ignite3/3.1.0/configure-and-operate/monitoring/"}}');var a=o(74848),i=o(28453);const c={id:"colocation",title:"Data Colocation",sidebar_label:"Colocation"},s=void 0,r={},d=[{value:"Configuring Colocation Key",id:"configuring-colocation-key",level:2}];function l(e){const n={admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"In many cases you may want to store related data on the same node. This way multi-entry queries do not need to pull data from other nodes and are thus executed faster."}),"\n",(0,a.jsx)(n.p,{children:"When the table is created, you can choose the key that will be used to colocate data."}),"\n",(0,a.jsxs)(n.p,{children:["For example, if you have ",(0,a.jsx)(n.code,{children:"Person"})," and ",(0,a.jsx)(n.code,{children:"Company"})," objects, and each person has the companyId field that indicates the company the person works for. By specifying the ",(0,a.jsx)(n.code,{children:"Person.companyId"})," and ",(0,a.jsx)(n.code,{children:"Company.ID"})," as colocation keys, you ensure that all the persons working for the same company are stored on the same node, where the company object is stored as well. Queries that request persons working for a specific company are processed on a single node."]}),"\n",(0,a.jsx)(n.h2,{id:"configuring-colocation-key",children:"Configuring Colocation Key"}),"\n",(0,a.jsxs)(n.p,{children:["Data colocation is configured during table creation by using the ",(0,a.jsx)(n.code,{children:"COLOCATE BY"})," clause. The columns used to colocate data must be in the primary key and must be specified in the same order as the ",(0,a.jsx)(n.code,{children:"PRIMARY KEY"})," of the main table."]}),"\n",(0,a.jsxs)(n.p,{children:["For example, the table below will colocate data for people based on the ",(0,a.jsx)(n.code,{children:"city_id"})," column:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE IF NOT EXISTS Person (\n  id int,\n  city_id int primary key,\n  name varchar,\n  age int,\n  company varchar\n) COLOCATE BY (city_id)\n"})}),"\n",(0,a.jsx)(n.p,{children:"When using composite primary keys, you can specify multiple columns to colocate data by:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Company (\n  company_id int,\n  department_id int,\n  city_id int,\n  company_name timestamp,\n  PRIMARY KEY (company_id, city_id)\n)\n\nCREATE TABLE IF NOT EXISTS Person (\n  id int,\n  city_id int,\n  name varchar,\n  age int,\n  company_id int,\n  PRIMARY KEY (id, company_id, city_id)\n)\nCOLOCATE BY (company_id, city_id)\n"})}),"\n",(0,a.jsx)(n.p,{children:"In this case, Ignite will try to colocate these tables together for storage."}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"COLOCATE BY"})," clause of colocated table (",(0,a.jsx)(n.code,{children:"Person"})," table in the example above) must contain the same set of columns and in the same order as the ",(0,a.jsx)(n.code,{children:"PRIMARY KEY"})," clause of the main table (Company table in the example above) to colocate the data."]})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}}}]);