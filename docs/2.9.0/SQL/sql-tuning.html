<!DOCTYPE html>

      
      
<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-61232409-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-61232409-1');
    </script>

    

    <meta charset="UTF-8">
    <meta name="ignite-version" content="2.9.0" />
    <title>SQL Performance Tuning | Ignite Documentation</title>
    
    <link rel="canonical" href="/docs/2.9.0/SQL/sql-tuning" />
    
	
	<link rel="stylesheet" href="/assets/css/styles.css?1598892242">
    <link rel="stylesheet" href="/assets/css/asciidoc-pygments.css">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name='viewport' content='width=device-width, height=device-height, initial-scale=1.0, minimum-scale=1.0'>

	<script type="text/javascript" src="/assets/js/anchor.min.js?1598892242"></script>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />


</head>
<body>
    <header>
    <div class="container">
        <button type='button' class='menu' title='Docs menu'>
        <img src="/assets/images/menu-icon.svg"/>
        </button>
        <div class='home'>
            <a href="/" class='home' title='Apache Ignite home'>
                <img src="/assets/images/apache_ignite_logo.svg" alt="Apache Ignite logo" width="103" >
            </a>
        </div>
        
        <nav>
            
        </nav>
        
        <select id="version-selector">
            <option value="2.9.0">2.9.0</option>
        </select>
        
        <a href="https://github.com/apache/ignite" title='GitHub' class='github' target="_blank">
            <img src="/assets/images/github-gray.svg" alt="GitHub logo">
        </a>
        
        <form class='search'>
            <button class="search-close" type='button'><img src='/assets/images/cancel.svg'></button>
            <input type="search" placeholder="Search…" id="search-input">
        </form>
        <button type='button' class='search-toggle'><img src='/assets/images/search.svg'></button>
        <button type='button' class='top-nav-toggle'>⋮</button>

        
        
    </div>
</header>


    	 <link rel="stylesheet" href="/assets/css/docs.css">
<section class='page-docs'>
    



<nav class='left-nav' data-swiftype-index='false'>

      
        <li>
            

            <a href="/docs/2.9.0/preface" class='' >Preface</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Quick Start Guides<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/java"

                                class=''
                            >Java</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/dotnet"

                                class=''
                            >.NET/C#</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/cpp"

                                class=''
                            >C++</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/python"

                                class=''
                            >Python</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/nodejs"

                                class=''
                            >Node.JS</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/sql"

                                class=''
                            >SQL</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/php"

                                class=''
                            >PHP</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/restapi"

                                class=''
                            >REST API</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="/installation" class='group-toggle collapsed '>Installation<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/installation/installing-using-zip"

                                class=''
                            >Installing Using ZIP Archive</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/installation/installing-using-docker"

                                class=''
                            >Installing Using Docker</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/installation/deb-rpm"

                                class=''
                            >Installing DEB or RPM package</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Kubernetes<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0/installation/kubernetes/amazon-eks-deployment" class=''>Amazon EKS</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0/installation/kubernetes/azure-deployment" class=''>Azure Kubernetes Service</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0/installation/kubernetes/gke-deployment" class=''>Google Kubernetes Engine</a></li>
                            
                            </nav>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Setting Up<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/setup"

                                class=''
                            >Setting Up Ignite for Java</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/setup-dotnet"

                                class=''
                            >Setting Up Ignite for .NET/C#</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/understanding-configuration" class='' >Understanding Configuration</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/logging" class='' >Configuring Logging</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/starting-nodes" class='' >Starting and Stopping Nodes</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Clustering<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/clustering"

                                class=''
                            >Overview</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/tcp-ip-discovery"

                                class=''
                            >TCP/IP Discovery</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/zookeeper-discovery"

                                class=''
                            >ZooKeeper Discovery</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/discovery-in-the-cloud"

                                class=''
                            >Discovery in the Cloud</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/network-configuration"

                                class=''
                            >Network Configuration</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/connect-client-nodes"

                                class=''
                            >Connecting Client Nodes</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/running-client-nodes-behind-nat"

                                class=''
                            >Running Client Nodes Behind NAT</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Data Modeling<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-modeling/data-modeling"

                                class=''
                            >Introduction</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-modeling/data-partitioning"

                                class=''
                            >Data Partitioning</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-modeling/affinity-collocation"

                                class=''
                            >Affinity Colocation</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Configuring Memory<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/memory-architecture"

                                class=''
                            >Memory Architecture</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/memory-configuration/data-regions"

                                class=''
                            >Configuring Data Regions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/memory-configuration/eviction-policies"

                                class=''
                            >Eviction Policies</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Configuring Caches<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/configuration-overview"

                                class=''
                            >Cache Configuration</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/configuring-backups"

                                class=''
                            >Configuring Partition Backups</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/atomicity-modes"

                                class=''
                            >Atomicity Modes</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/expiry-policies"

                                class=''
                            >Expiry Policy</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/on-heap-caching"

                                class=''
                            >On-Heap Caching</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/cache-groups"

                                class=''
                            >Cache Groups</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Persistence<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/native-persistence"

                                class=''
                            >Ignite Persistence</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/external-storage"

                                class=''
                            >External Storage</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/swap"

                                class=''
                            >Swapping</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/custom-cache-store"

                                class=''
                            >Implementing Custom Cache Store</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/disk-compression"

                                class=''
                            >Disk Compression</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/persistence-tuning"

                                class=''
                            >Tuning Persistence</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/baseline-topology" class='' >Baseline Topology</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/cluster-states" class='' >Cluster States</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/data-rebalancing" class='' >Data Rebalancing</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/partition-loss-policy" class='' >Partition Loss Policy</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/peer-class-loading" class='' >Peer Class Loading</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/data-streaming" class='' >Data Streaming</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Using Key-Value Cache API<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/key-value-api/basic-cache-operations"

                                class=''
                            >Basic Cache Operations</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/key-value-api/binary-objects"

                                class=''
                            >Working with Binary Objects</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/key-value-api/using-scan-queries"

                                class=''
                            >Using Scan Queries</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/key-value-api/continuous-queries" class='' >Using Continuous Queries</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/key-value-api/transactions" class='' >Performing Transactions</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Working with SQL<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/sql-introduction"

                                class=''
                            >Introduction</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/schemas"

                                class=''
                            >Understanding Schemas</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/indexes"

                                class=''
                            >Defining Indexes</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/sql-api"

                                class=''
                            >Using SQL API</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/distributed-joins"

                                class=''
                            >Distributed Joins</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/sql-transactions"

                                class=''
                            >SQL Transactions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/custom-sql-func"

                                class=''
                            >Custom SQL Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/JDBC/jdbc-driver"

                                class=''
                            >JDBC Driver</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/JDBC/jdbc-client-driver"

                                class=''
                            >JDBC Client Driver</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/transactions/mvcc"

                                class=''
                            >Multiversion Concurrency Control</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Distributed Computing<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/distributed-computing"

                                class=''
                            >Distributed Computing API</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/cluster-groups"

                                class=''
                            >Cluster Groups</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/executor-service"

                                class=''
                            >Executor Service</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/map-reduce"

                                class=''
                            >MapReduce API</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/load-balancing"

                                class=''
                            >Load Balancing</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/fault-tolerance"

                                class=''
                            >Fault Tolerance</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/job-scheduling"

                                class=''
                            >Job Scheduling</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/collocated-computations" class='' >Colocating Computations with Data</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Working with Events<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/events/listening-to-events"

                                class=''
                            >Enabling and Listenting to Events</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/events/events"

                                class=''
                            >Events</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/near-cache" class='' >Near Caches</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/platform-cache" class='' >.NET Platform Cache</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Monitoring<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/intro"

                                class=''
                            >Introduction</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/cluster-id"

                                class=''
                            >Cluster ID and Tag</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Metrics<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0/monitoring-metrics/configuring-metrics" class=''>Configuring Metrics</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0/monitoring-metrics/metrics" class=''>JMX Metrics</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>New Metrics System<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0/monitoring-metrics/new-metrics-system" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0/monitoring-metrics/new-metrics" class=''>Metrics</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/system-views"

                                class=''
                            >System Views</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/tracing"

                                class=''
                            >Tracing</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="/security" class='group-toggle collapsed '>Security<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/security/authentication"

                                class=''
                            >Authentication</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/security/ssl-tls"

                                class=''
                            >SSL/TLS</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Transparent Data Encryption<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0/security/tde" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0/security/master-key-rotation" class=''>Master key rotation</a></li>
                            
                            </nav>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Thin Clients<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/getting-started-with-thin-clients"

                                class=''
                            >Thin Clients Overview</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/java-thin-client"

                                class=''
                            >Java Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/dotnet-thin-client"

                                class=''
                            >.NET Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/cpp-thin-client"

                                class=''
                            >C++ Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/python-thin-client"

                                class=''
                            >Python Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/php-thin-client"

                                class=''
                            >PHP Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/nodejs-thin-client"

                                class=''
                            >Node.js Thin Client</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>ODBC Driver<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/odbc-driver"

                                class=''
                            >ODBC Driver</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/connection-string-dsn"

                                class=''
                            >Connection String and DSN</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/querying-modifying-data"

                                class=''
                            >Querying and Modifying Data</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/specification"

                                class=''
                            >Specification</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/data-types"

                                class=''
                            >Data Types</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/error-codes"

                                class=''
                            >Error Codes</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/restapi" class='' >REST API</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/control-script" class='' >Control Script</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/plugins" class='' >Plugins</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/sqlline" class='' >SQLLine</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="/sql-reference/sql-reference-overview" class='group-toggle collapsed '>SQL Reference<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/ddl"

                                class=''
                            >Data Definition Language (DDL)</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/dml"

                                class=''
                            >Data Manipulation Language (DML)</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/transactions"

                                class=''
                            >Transactions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/operational-commands"

                                class=''
                            >Operational Commands</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/aggregate-functions"

                                class=''
                            >Aggregate functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/numeric-functions"

                                class=''
                            >Numeric Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/string-functions"

                                class=''
                            >String Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/date-time-functions"

                                class=''
                            >Data and Time Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/system-functions"

                                class=''
                            >System Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/data-types"

                                class=''
                            >Data Types</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
</nav>
<div class="left-nav__overlay"></div>


    <article data-swiftype-index='true'>
      <a class='edit-link' href="https://github.com/apache/ignite/tree/IGNITE-7595/docs/_docs/SQL/sql-tuning.adoc" target="_blank">Edit</a>
        
            <h1>SQL Performance Tuning</h1>
        
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This article outlines basic and advanced optimization techniques for Ignite SQL queries. Some of the sections are also useful for debugging and troubleshooting.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-the-explain-statement">Using the EXPLAIN Statement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ignite supports the <code>EXPLAIN</code> statement, which could be used to read the execution plan of a query.
Use this command to analyse your queries for possible optimization.
Note that the plan will contain multiple rows: the last one will contain a query for the reducing side (usually your application), others are for map nodes (usually server nodes).
Read the <a href="/docs/2.9.0/SQL/sql-introduction#distributed-queries">Distributed Queries</a> section to learn how queries are executed in Ignite.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">EXPLAIN</span> <span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">Person</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="o">=</span> <span class="mi">26</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The execution plan is generated by H2 as described <a href="http://www.h2database.com/html/performance.html#explain_plan" target="_blank" rel="noopener">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="or-operator-and-selectivity">OR Operator and Selectivity</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a query contains an <code>OR</code> operator, then indexes may not be used as expected depending on the complexity of the query.
For example, for the query <code>select name from Person where gender='M' and (age = 20 or age = 30)</code>, an index on the <code>gender</code> field will be used instead of an index on the <code>age</code> field, although the latter is a more selective index.
As a workaround for this issue, you can rewrite the query with <code>UNION ALL</code> (notice that <code>UNION</code> without <code>ALL</code> will return <code>DISTINCT</code> rows, which will change the query semantics and will further penalize your query performance):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">Person</span> <span class="k">WHERE</span> <span class="n">gender</span><span class="o">=</span><span class="s1">'M'</span> <span class="k">and</span> <span class="n">age</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">UNION</span> <span class="k">ALL</span>
<span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">Person</span> <span class="k">WHERE</span> <span class="n">gender</span><span class="o">=</span><span class="s1">'M'</span> <span class="k">and</span> <span class="n">age</span> <span class="o">=</span> <span class="mi">30</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="avoid-having-too-many-columns">Avoid Having Too Many Columns</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Avoid having too many columns in the result set of a <code>SELECT</code> query. Due to limitations of the H2 query parser, queries with 100+ columns may perform worse than expected.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lazy-loading">Lazy Loading</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, Ignite attempts to load the whole result set to memory and send it back to the query initiator (which is usually your application).
This approach provides optimal performance for queries of small or medium result sets.
However, if the result set is too big to fit in the available memory, it can lead to prolonged GC pauses and even <code>OutOfMemoryError</code> exceptions.</p>
</div>
<div class="paragraph">
<p>To minimize memory consumption, at the cost of a moderate performance hit, you can load and process the result sets lazily by passing the <code>lazy</code> parameter to the JDBC and ODBC connection strings or use a similar method available for Java, .NET, and C++ APIs:</p>
</div>
<code-tabs><code-tab data-tab='Java'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">SqlFieldsQuery</span> <span class="n">query</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlFieldsQuery</span><span class="o">(</span><span class="s">"SELECT * FROM Person WHERE id &gt; 10"</span><span class="o">);</span>

<span class="c1">// Result set will be loaded lazily.</span>
<span class="n">query</span><span class="o">.</span><span class="na">setLazy</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='JDBC'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="n">jdbc</span><span class="p">:</span><span class="n">ignite</span><span class="p">:</span><span class="n">thin</span><span class="p">:</span><span class="o">//</span><span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="o">?</span><span class="n">lazy</span><span class="o">=</span><span class="k">true</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C#/.NET'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="kt">var</span> <span class="n">query</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SqlFieldsQuery</span><span class="p">(</span><span class="s">"SELECT * FROM Person WHERE id &gt; 10"</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Result set will be loaded lazily.</span>
    <span class="n">Lazy</span> <span class="p">=</span> <span class="k">true</span>
<span class="p">};</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C++'></code-tab></code-tabs>
</div>
</div>
<div class="sect1">
<h2 id="querying-colocated-data">Querying Colocated Data</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When Ignite executes a distributed query, it sends sub-queries to individual cluster nodes to fetch the data and groups the results on the reducer node (usually your application).
If you know in advance that the data you are querying is <a href="/docs/2.9.0/data-modeling/affinity-collocation">colocated</a> by the <code>GROUP BY</code> condition, you can use <code>SqlFieldsQuery.collocated = true</code> to tell the SQL engine to do the grouping on the remote nodes.
This will reduce network traffic between the nodes and query execution time.
When this flag is set to <code>true</code>, the query is executed on individual nodes first and the results are sent to the reducer node for final calculation.</p>
</div>
<div class="paragraph">
<p>Consider the following example, in which we assume that the data is colocated by <code>department_id</code> (in other words, the <code>department_id</code> field is configured as the affinity key).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">SELECT</span> <span class="k">SUM</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">department_id</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Because of the nature of the SUM operation, Ignite sums up the salaries across the elements stored on individual nodes, and then sends these sums to the reducer node where the final result are calculated.
This operation is already distributed, and enabling the <code>collocated</code> flag only slightly improves performance.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a slightly different example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">SELECT</span> <span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Employee</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">department_id</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, Ignite has to fetch all (<code>salary</code>, <code>department_id</code>) pairs to the reducer node and calculate the results there.
However, if employees are colocated by the <code>department_id</code> field, i.e. employee data for the same department is stored on the same node, setting <code>SqlFieldsQuery.collocated = true</code> reduces query execution time because Ignite calculates the averages for each department on the individual nodes and sends the results to the reducer node for final calculation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enforcing-join-order">Enforcing Join Order</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When this flag is set, the query optimizer will not reorder tables in joins.
In other words, the order in which joins are applied during query execution will be the same as specified in the query.
Without this flag, the query optimizer can reorder joins to improve performance.
However, sometimes it might make an incorrect decision.
This flag helps to control and explicitly specify the order of joins instead of relying on the optimizer.</p>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Person</span> <span class="n">p</span>
<span class="k">JOIN</span> <span class="n">Company</span> <span class="k">c</span> <span class="k">ON</span> <span class="n">p</span><span class="p">.</span><span class="n">company</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">name</span> <span class="k">where</span> <span class="n">p</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'John Doe'</span>
<span class="k">AND</span> <span class="n">p</span><span class="p">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">20</span>
<span class="k">AND</span> <span class="n">p</span><span class="p">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="mi">5000</span>
<span class="k">AND</span> <span class="n">p</span><span class="p">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="mi">100000</span>
<span class="k">AND</span> <span class="k">c</span><span class="p">.</span><span class="n">name</span> <span class="k">NOT</span> <span class="k">LIKE</span> <span class="s1">'O%'</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This query contains a join between two tables: <code>Person</code> and <code>Company</code>.
To get the best performance, we should understand which join will return the smallest result set.
The table with the smaller result set size should be given first in the join pair.
To get the size of each result set, let&#8217;s test each part.</p>
</div>
<div class="listingblock">
<div class="title">Q1:</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">Person</span> <span class="n">p</span>
<span class="k">where</span>
<span class="n">p</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'John Doe'</span>
<span class="k">AND</span> <span class="n">p</span><span class="p">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">20</span>
<span class="k">AND</span> <span class="n">p</span><span class="p">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="mi">5000</span>
<span class="k">AND</span> <span class="n">p</span><span class="p">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="mi">100000</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Q2:</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">Company</span> <span class="k">c</span>
<span class="k">where</span>
<span class="k">c</span><span class="p">.</span><span class="n">name</span> <span class="k">NOT</span> <span class="k">LIKE</span> <span class="s1">'O%'</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>After running Q1 and Q2, we can get two different outcomes:</p>
</div>
<div class="paragraph">
<p>Case 1:</p>
</div>
<table class="tableblock frame-all grid-all stripes-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100000</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Q2 returns more entries than Q1.
In this case, we don&#8217;t need to modify the original query, because smaller subset has already been located on the left side of the join.</p>
</div>
<div class="paragraph">
<p>Case 2:</p>
</div>
<table class="tableblock frame-all grid-all stripes-none fit-content">
<colgroup>
<col>
<col>
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10000</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Q1 returns more entries than Q2. So we need to change the initial query as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">Company</span> <span class="k">c</span>
<span class="k">JOIN</span> <span class="n">Person</span> <span class="n">p</span>
<span class="k">ON</span> <span class="n">p</span><span class="p">.</span><span class="n">company</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">name</span>
<span class="k">where</span>
<span class="n">p</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'John Doe'</span>
<span class="k">AND</span> <span class="n">p</span><span class="p">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">20</span>
<span class="k">AND</span> <span class="n">p</span><span class="p">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="mi">5000</span>
<span class="k">AND</span> <span class="n">p</span><span class="p">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="mi">100000</span>
<span class="k">AND</span> <span class="k">c</span><span class="p">.</span><span class="n">name</span> <span class="k">NOT</span> <span class="k">LIKE</span> <span class="s1">'O%'</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The force join order hint can be specified as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="/docs/2.9.0/SQL/JDBC/jdbc-driver#parameters">JDBC driver connection parameter</a></p>
</li>
<li>
<p><a href="/docs/2.9.0/SQL/ODBC/connection-string-dsn#supported-arguments">ODBC driver connection attribute</a></p>
</li>
<li>
<p>If you use <a href="/docs/2.9.0/SQL/sql-api">SqlFieldsQuery</a> to execute SQL queries, you can set the enforce join order hint by calling the <code>SqlFieldsQuery.setEnforceJoinOrder(true)</code> method.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="increasing-index-inline-size">Increasing Index Inline Size</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every entry in the index has a constant size which is calculated during index creation. This size is called <em>index inline size</em>.
Ideally this size should be enough to store full indexed entry in serialized form.
When values are not fully included in the index, Ignite may need to perform additional data page reads during index lookup, which can impair performance if persistence is enabled.</p>
</div>
<div class="paragraph">
<p>Here is how values are stored in the index:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="tok-kt">int</span>
0     1       5
| tag | value |
<span class="tok-k">Total: 5 bytes</span>

<span class="tok-kt">long</span>
0     1       9
| tag | value |
<span class="tok-k">Total: 9 bytes</span>

<span class="tok-kt">String</span>
0     1      3             N
| tag | size | UTF-8 value |
<span class="tok-k">Total: 3 + string length</span>

<span class="tok-kt">POJO (BinaryObject)</span>
0     1         5
| tag | BO hash |
<span class="tok-k">Total: 5</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For primitive data types (bool, byte, short, int, etc.), Ignite automatically calculates the index inline size so that the values are included in full.
For example, for <code>int</code> fields, the inline size is 5 (1 byte for the tag and 4 bytes for the value itself). For <code>long</code> fields, the inline size is 9 (1 byte for the tag + 8 bytes for the value).</p>
</div>
<div class="paragraph">
<p>For binary objects, the index includes the hash of each object, which is enough to avoid collisions. The inline size is 5.</p>
</div>
<div class="paragraph">
<p>For variable length data, indexes include only first several bytes of the value.
Therefore, when indexing fields with variable-length data, we recommend that you estimate the length of your field values and set the inline size to a value that includes most (about 95%) or all values.
For example, if you have a <code>String</code> field with 95% of the values containing 10 characters or fewer, you can set the inline size for the index on that field to 13.</p>
</div>
<div class="paragraph">
<p>The inline sizes explained above apply to single field indexes.
However, when you define an index on a field in the value object or on a non-primary key column, Ignite creates a <em>composite index</em> by appending the primary key to the indexed value.
Therefore, when calculating the inline size for composite indexes, add up the inline size of the primary key.</p>
</div>
<div class="paragraph">
<p>Below is an example of index inline size calculation for a cache where both key and value are complex objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Key</span> <span class="o">{</span>
    <span class="nd">@QuerySqlField</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@QuerySqlField</span>
    <span class="nd">@AffinityKeyMapped</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">affinityKey</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Value</span> <span class="o">{</span>
    <span class="nd">@QuerySqlField</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">long</span> <span class="n">longField</span><span class="o">;</span>

    <span class="nd">@QuerySqlField</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">intField</span><span class="o">;</span>

    <span class="nd">@QuerySqlField</span><span class="o">(</span><span class="n">index</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">stringField</span><span class="o">;</span> <span class="c1">// we suppose that 95% of the values are 10 symbols</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following table summarizes the inline index sizes for the indexes defined in the example above.</p>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Index</th>
<th class="tableblock halign-left valign-top">Kind</th>
<th class="tableblock halign-left valign-top">Recommended Inline Size</th>
<th class="tableblock halign-left valign-top">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(_key)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary key index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inlined hash of a binary object (5)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(affinityKey, _key)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Affinity key index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inlined long (9) + binary object&#8217;s hash (5)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(longField, _key)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secondary index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inlined long (9) + binary object&#8217;s hash (5)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(intField, _key)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secondary index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inlined int (5) + binary object up to hash (5)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(stringField, _key)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secondary index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inlined string (13) + binary object&#8217;s hash (5) (assuming that the string is ~10 symbols)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that you will only have to set the inline size for the index on <code>stringField</code>. For other indexes, Ignite calculates the inline size automatically.</p>
</div>
<div class="paragraph">
<p>Refer to the <a href="/docs/2.9.0/SQL/indexes#configuring-index-inline-size">Configuring Index Inline Size</a> section for the information on how to change the inline size.</p>
</div>
<div class="paragraph">
<p>You can check the inline size of an existing index in the <a href="/docs/2.9.0/monitoring-metrics/system-views#indexes">INDEXES</a> system view.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph">
<p>Note that since Ignite encodes strings to <code>UTF-8</code>, some characters use more than 1 byte.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="query-parallelism">Query Parallelism</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, a SQL query is executed in a single thread on each participating node. This approach is optimal for queries returning small result sets involving index search. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Person</span> <span class="k">WHERE</span> <span class="n">p</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="o">?</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Certain queries might benefit from being executed in multiple threads.
This relates to queries with table scans and aggregations, which is often the case for HTAP and OLAP workloads.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">SELECT</span> <span class="k">SUM</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Person</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The number of threads created on a single node for query execution is configured per cache and by default equals 1.
You can change the value by setting the <code>CacheConfiguration.queryParallelism</code> parameter.
If you create SQL tables using the CREATE TABLE command, you can use a <a href="/docs/2.9.0/configuring-caches/configuration-overview#cache-templates">cache template</a> to set this parameter.</p>
</div>
<div class="paragraph">
<p>If a query contains <code>JOINs</code>, then all the participating caches must have the same degree of parallelism.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="index-hints">Index Hints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Index hints are useful in scenarios when you know that one index is more suitable for certain queries than another.
You can use them to instruct the query optimizer to choose a more efficient execution plan.
To do this, you can use <code>USE INDEX(indexA,&#8230;&#8203;,indexN)</code> statement as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Person</span> <span class="n">USE</span> <span class="k">INDEX</span><span class="p">(</span><span class="n">index_age</span><span class="p">)</span>
<span class="k">WHERE</span> <span class="n">salary</span> <span class="o">&gt;</span> <span class="mi">150000</span> <span class="k">AND</span> <span class="n">age</span> <span class="o">&lt;</span> <span class="mi">35</span><span class="p">;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="partition-pruning">Partition Pruning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Partition pruning is a technique that optimizes queries that use affinity keys in the <code>WHERE</code> condition.
When executing such a query, Ignite  scans only those partitions where the requested data is stored.
This reduces query time because the query is sent only to the nodes that store the requested partitions.</p>
</div>
<div class="paragraph">
<p>In the following example, the employee objects are colocated by the <code>id</code> field (if an affinity key is not set
explicitly then the primary key is used as the affinity key):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">employee</span> <span class="p">(</span><span class="n">id</span> <span class="nb">BIGINT</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span> <span class="n">department_id</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">name</span> <span class="nb">VARCHAR</span><span class="p">)</span>

<span class="cm">/* This query is sent to the node where the requested key is stored */</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">employee</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>

<span class="cm">/* This query is sent to all nodes */</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">employee</span> <span class="k">WHERE</span> <span class="n">department_id</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the next example, the affinity key is set explicitly and, therefore, will be used to colocate data and direct
queries to the nodes that keep primary copies of the data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">employee</span> <span class="p">(</span><span class="n">id</span> <span class="nb">BIGINT</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span> <span class="n">department_id</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">name</span> <span class="nb">VARCHAR</span><span class="p">)</span> <span class="k">WITH</span> <span class="nv">"AFFINITY_KEY=department_id"</span>

<span class="cm">/* This query is sent to all nodes */</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">employee</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>

<span class="cm">/* This query is sent to the node where the requested key is stored */</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">employee</span> <span class="k">WHERE</span> <span class="n">department_id</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to <a href="/docs/2.9.0/data-modeling/affinity-collocation">affinity colocation</a> page for more details
on how data gets colocated and how it helps boost performance in distributed storages like Ignite.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="skip-reducer-on-update">Skip Reducer on Update</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When Ignite executes a DML operation, it first fetches all the affected intermediate rows for analysis to the reducer node (usually your application), and only then prepares batches of updated values that will be sent to remote nodes.</p>
</div>
<div class="paragraph">
<p>This approach might affect performance and saturate the network if a DML operation has to move many entries.</p>
</div>
<div class="paragraph">
<p>Use this flag as a hint for the SQL engine to do all intermediate rows analysis and updates “in-place” on the server nodes. The hint is supported for JDBC and ODBC connections.</p>
</div>
<code-tabs><code-tab data-tab='JDBC Connection String'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="text">//jdbc connection string
jdbc:ignite:thin://192.168.0.15/skipReducerOnUpdate=true</code></pre>
</div>
</div></code-tab></code-tabs>
</div>
</div>
<div class="sect1">
<h2 id="sql-on-heap-row-cache">SQL On-heap Row Cache</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ignite stores data and indexes in its own memory space outside of Java heap. This means that with every data
access, a part of the data will be copied from the off-heap space to Java heap, potentially deserialized, and kept in
the heap as long as your application or server node references it.</p>
</div>
<div class="paragraph">
<p>The SQL on-heap row cache is intended to store hot rows (key-value objects) in Java heap, minimizing resources
spent for data copying and deserialization. Each cached row refers to an entry in the off-heap region and can be
invalidated when one of the following happens:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The master entry stored in the off-heap region is updated or removed.</p>
</li>
<li>
<p>The data page that stores the master entry is evicted from RAM.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The on-heap row cache can be enabled for a specific cache/table (if you use <code>CREATE TABLE</code> to create SQL tables and caches, then the parameter can be passed via a <a href="/docs/2.9.0/configuring-caches/configuration-overview#cache-templates">cache template</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.apache.ignite.configuration.IgniteConfiguration"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"cacheConfiguration"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.apache.ignite.configuration.CacheConfiguration"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"name"</span> <span class="na">value=</span><span class="s">"myCache"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"sqlOnheapCacheEnabled"</span> <span class="na">value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the row cache is enabled, you might be able to trade RAM for performance. You might get up to a 2x performance increase for some SQL queries and use cases by allocating more RAM for rows caching purposes.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<h3 id="sql-on-heap-row-cache-size" class="discrete">SQL On-Heap Row Cache Size</h3>
<div class="paragraph">
<p>Presently, the cache is unlimited and can occupy as much RAM as allocated to your memory data regions. Make sure to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the JVM max heap size equal to the total size of all the data regions that store caches for which this on-heap row cache is enabled.</p>
</li>
<li>
<p><a href="/docs/2.9.0/perf-troubleshooting-guide/memory-tuning#java-heap-and-gc-tuning">Tune</a> JVM garbage collection accordingly.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-timestamp-instead-of-date">Using TIMESTAMP instead of DATE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the <code>TIMESTAMP</code> type instead of <code>DATE</code> whenever possible. Presently, the <code>DATE</code> type is serialized/deserialized very inefficiently resulting in performance degradation.</p>
</div>
</div>
</div>
    </article>
    <nav class="right-nav" data-swiftype-index='false'>
    <ul class="sectlevel1">
<li><a href="#using-the-explain-statement">Using the EXPLAIN Statement</a></li>
<li><a href="#or-operator-and-selectivity">OR Operator and Selectivity</a></li>
<li><a href="#avoid-having-too-many-columns">Avoid Having Too Many Columns</a></li>
<li><a href="#lazy-loading">Lazy Loading</a></li>
<li><a href="#querying-colocated-data">Querying Colocated Data</a></li>
<li><a href="#enforcing-join-order">Enforcing Join Order</a></li>
<li><a href="#increasing-index-inline-size">Increasing Index Inline Size</a></li>
<li><a href="#query-parallelism">Query Parallelism</a></li>
<li><a href="#index-hints">Index Hints</a></li>
<li><a href="#partition-pruning">Partition Pruning</a></li>
<li><a href="#skip-reducer-on-update">Skip Reducer on Update</a></li>
<li><a href="#sql-on-heap-row-cache">SQL On-heap Row Cache</a></li>
<li><a href="#using-timestamp-instead-of-date">Using TIMESTAMP instead of DATE</a></li>
</ul>
          
      
<footer>
</footer>

</nav>
    
</section>
<script type='module' src='/assets/js/code-copy-to-clipboard.js' async crossorigin></script>

    <script>
    // inits deep anchors -- needs to be done here because of https://www.bryanbraun.com/anchorjs/#dont-run-it-too-late 
    anchors.add('.page-docs h1, .page-docs h2, .page-docs h3:not(.discrete), .page-docs h4, .page-docs h5');
    anchors.options = {
        placement: 'right',
        visible: 'always'
    };
    </script>
    <!-- load google fonts async -->
    <script type="text/javascript">
    WebFontConfig = {
      google: { families: [ 'Open+Sans:300,400,600,700&display=swap' ] }
    };
    (function() {
      var wf = document.createElement('script');
      wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
      wf.type = 'text/javascript';
      wf.async = 'true';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(wf, s);
    })(); </script>
    <script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script>
      docsearch({
        // Your apiKey and indexName will be given to you once
        // we create your config
        apiKey: '3eee686c0ebe39eff3baeb18c56fa5f8', 
        indexName: 'apache_ignite',
        // Replace inputSelector with a CSS selector
        // matching your search input
        inputSelector: '#search-input',
        // algoliaOptions: { 'facetFilters': ["version:$VERSION"] },

        // Set debug to true to inspect the dropdown
        debug: false,
      });
    </script>
<script type='module' src='/assets/js/index.js?1598892242' async crossorigin></script>
<script type='module' src='/assets/js/versioning.js?1598892242' async crossorigin></script>
</body>

</html>
