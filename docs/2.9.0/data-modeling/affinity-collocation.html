<!DOCTYPE html>

      
      
<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-61232409-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-61232409-1');
    </script>

    

    <meta charset="UTF-8">
    <meta name="ignite-version" content="2.9.0" />
    <title>Affinity Colocation | Ignite Documentation</title>
    
    <link rel="canonical" href="/docs/2.9.0/data-modeling/affinity-collocation" />
    
	
	<link rel="stylesheet" href="/assets/css/styles.css?1598892242">
    <link rel="stylesheet" href="/assets/css/asciidoc-pygments.css">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name='viewport' content='width=device-width, height=device-height, initial-scale=1.0, minimum-scale=1.0'>

	<script type="text/javascript" src="/assets/js/anchor.min.js?1598892242"></script>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />


</head>
<body>
    <header>
    <div class="container">
        <button type='button' class='menu' title='Docs menu'>
        <img src="/assets/images/menu-icon.svg"/>
        </button>
        <div class='home'>
            <a href="/" class='home' title='Apache Ignite home'>
                <img src="/assets/images/apache_ignite_logo.svg" alt="Apache Ignite logo" width="103" >
            </a>
        </div>
        
        <nav>
            
        </nav>
        
        <select id="version-selector">
            <option value="2.9.0">2.9.0</option>
        </select>
        
        <a href="https://github.com/apache/ignite" title='GitHub' class='github' target="_blank">
            <img src="/assets/images/github-gray.svg" alt="GitHub logo">
        </a>
        
        <form class='search'>
            <button class="search-close" type='button'><img src='/assets/images/cancel.svg'></button>
            <input type="search" placeholder="Search…" id="search-input">
        </form>
        <button type='button' class='search-toggle'><img src='/assets/images/search.svg'></button>
        <button type='button' class='top-nav-toggle'>⋮</button>

        
        
    </div>
</header>


    	 <link rel="stylesheet" href="/assets/css/docs.css">
<section class='page-docs'>
    



<nav class='left-nav' data-swiftype-index='false'>

      
        <li>
            

            <a href="/docs/2.9.0/preface" class='' >Preface</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Quick Start Guides<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/java"

                                class=''
                            >Java</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/dotnet"

                                class=''
                            >.NET/C#</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/cpp"

                                class=''
                            >C++</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/python"

                                class=''
                            >Python</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/nodejs"

                                class=''
                            >Node.JS</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/sql"

                                class=''
                            >SQL</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/php"

                                class=''
                            >PHP</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/restapi"

                                class=''
                            >REST API</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="/installation" class='group-toggle collapsed '>Installation<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/installation/installing-using-zip"

                                class=''
                            >Installing Using ZIP Archive</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/installation/installing-using-docker"

                                class=''
                            >Installing Using Docker</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/installation/deb-rpm"

                                class=''
                            >Installing DEB or RPM package</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Kubernetes<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0/installation/kubernetes/amazon-eks-deployment" class=''>Amazon EKS</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0/installation/kubernetes/azure-deployment" class=''>Azure Kubernetes Service</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0/installation/kubernetes/gke-deployment" class=''>Google Kubernetes Engine</a></li>
                            
                            </nav>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Setting Up<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/setup"

                                class=''
                            >Setting Up Ignite for Java</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/setup-dotnet"

                                class=''
                            >Setting Up Ignite for .NET/C#</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/understanding-configuration" class='' >Understanding Configuration</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/logging" class='' >Configuring Logging</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/starting-nodes" class='' >Starting and Stopping Nodes</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Clustering<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/clustering"

                                class=''
                            >Overview</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/tcp-ip-discovery"

                                class=''
                            >TCP/IP Discovery</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/zookeeper-discovery"

                                class=''
                            >ZooKeeper Discovery</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/discovery-in-the-cloud"

                                class=''
                            >Discovery in the Cloud</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/network-configuration"

                                class=''
                            >Network Configuration</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/connect-client-nodes"

                                class=''
                            >Connecting Client Nodes</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/running-client-nodes-behind-nat"

                                class=''
                            >Running Client Nodes Behind NAT</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle expanded '>Data Modeling<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group expanded'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-modeling/data-modeling"

                                class=''
                            >Introduction</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-modeling/data-partitioning"

                                class=''
                            >Data Partitioning</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-modeling/affinity-collocation"

                                class='active'
                            >Affinity Colocation</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Configuring Memory<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/memory-architecture"

                                class=''
                            >Memory Architecture</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/memory-configuration/data-regions"

                                class=''
                            >Configuring Data Regions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/memory-configuration/eviction-policies"

                                class=''
                            >Eviction Policies</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Configuring Caches<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/configuration-overview"

                                class=''
                            >Cache Configuration</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/configuring-backups"

                                class=''
                            >Configuring Partition Backups</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/atomicity-modes"

                                class=''
                            >Atomicity Modes</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/expiry-policies"

                                class=''
                            >Expiry Policy</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/on-heap-caching"

                                class=''
                            >On-Heap Caching</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/cache-groups"

                                class=''
                            >Cache Groups</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Persistence<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/native-persistence"

                                class=''
                            >Ignite Persistence</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/external-storage"

                                class=''
                            >External Storage</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/swap"

                                class=''
                            >Swapping</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/custom-cache-store"

                                class=''
                            >Implementing Custom Cache Store</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/disk-compression"

                                class=''
                            >Disk Compression</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/persistence-tuning"

                                class=''
                            >Tuning Persistence</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/baseline-topology" class='' >Baseline Topology</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/cluster-states" class='' >Cluster States</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/data-rebalancing" class='' >Data Rebalancing</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/partition-loss-policy" class='' >Partition Loss Policy</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/peer-class-loading" class='' >Peer Class Loading</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/data-streaming" class='' >Data Streaming</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Using Key-Value Cache API<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/key-value-api/basic-cache-operations"

                                class=''
                            >Basic Cache Operations</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/key-value-api/binary-objects"

                                class=''
                            >Working with Binary Objects</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/key-value-api/using-scan-queries"

                                class=''
                            >Using Scan Queries</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/key-value-api/continuous-queries" class='' >Using Continuous Queries</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/key-value-api/transactions" class='' >Performing Transactions</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Working with SQL<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/sql-introduction"

                                class=''
                            >Introduction</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/schemas"

                                class=''
                            >Understanding Schemas</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/indexes"

                                class=''
                            >Defining Indexes</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/sql-api"

                                class=''
                            >Using SQL API</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/distributed-joins"

                                class=''
                            >Distributed Joins</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/sql-transactions"

                                class=''
                            >SQL Transactions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/custom-sql-func"

                                class=''
                            >Custom SQL Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/JDBC/jdbc-driver"

                                class=''
                            >JDBC Driver</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/JDBC/jdbc-client-driver"

                                class=''
                            >JDBC Client Driver</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/transactions/mvcc"

                                class=''
                            >Multiversion Concurrency Control</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Distributed Computing<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/distributed-computing"

                                class=''
                            >Distributed Computing API</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/cluster-groups"

                                class=''
                            >Cluster Groups</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/executor-service"

                                class=''
                            >Executor Service</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/map-reduce"

                                class=''
                            >MapReduce API</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/load-balancing"

                                class=''
                            >Load Balancing</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/fault-tolerance"

                                class=''
                            >Fault Tolerance</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/job-scheduling"

                                class=''
                            >Job Scheduling</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/collocated-computations" class='' >Colocating Computations with Data</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Working with Events<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/events/listening-to-events"

                                class=''
                            >Enabling and Listenting to Events</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/events/events"

                                class=''
                            >Events</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/near-cache" class='' >Near Caches</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/platform-cache" class='' >.NET Platform Cache</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Monitoring<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/intro"

                                class=''
                            >Introduction</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/cluster-id"

                                class=''
                            >Cluster ID and Tag</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Metrics<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0/monitoring-metrics/configuring-metrics" class=''>Configuring Metrics</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0/monitoring-metrics/metrics" class=''>JMX Metrics</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>New Metrics System<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0/monitoring-metrics/new-metrics-system" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0/monitoring-metrics/new-metrics" class=''>Metrics</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/system-views"

                                class=''
                            >System Views</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/tracing"

                                class=''
                            >Tracing</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="/security" class='group-toggle collapsed '>Security<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/security/authentication"

                                class=''
                            >Authentication</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/security/ssl-tls"

                                class=''
                            >SSL/TLS</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Transparent Data Encryption<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0/security/tde" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0/security/master-key-rotation" class=''>Master key rotation</a></li>
                            
                            </nav>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Thin Clients<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/getting-started-with-thin-clients"

                                class=''
                            >Thin Clients Overview</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/java-thin-client"

                                class=''
                            >Java Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/dotnet-thin-client"

                                class=''
                            >.NET Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/cpp-thin-client"

                                class=''
                            >C++ Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/python-thin-client"

                                class=''
                            >Python Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/php-thin-client"

                                class=''
                            >PHP Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/nodejs-thin-client"

                                class=''
                            >Node.js Thin Client</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>ODBC Driver<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/odbc-driver"

                                class=''
                            >ODBC Driver</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/connection-string-dsn"

                                class=''
                            >Connection String and DSN</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/querying-modifying-data"

                                class=''
                            >Querying and Modifying Data</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/specification"

                                class=''
                            >Specification</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/data-types"

                                class=''
                            >Data Types</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/error-codes"

                                class=''
                            >Error Codes</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/restapi" class='' >REST API</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/control-script" class='' >Control Script</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/plugins" class='' >Plugins</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/sqlline" class='' >SQLLine</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="/sql-reference/sql-reference-overview" class='group-toggle collapsed '>SQL Reference<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/ddl"

                                class=''
                            >Data Definition Language (DDL)</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/dml"

                                class=''
                            >Data Manipulation Language (DML)</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/transactions"

                                class=''
                            >Transactions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/operational-commands"

                                class=''
                            >Operational Commands</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/aggregate-functions"

                                class=''
                            >Aggregate functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/numeric-functions"

                                class=''
                            >Numeric Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/string-functions"

                                class=''
                            >String Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/date-time-functions"

                                class=''
                            >Data and Time Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/system-functions"

                                class=''
                            >System Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/data-types"

                                class=''
                            >Data Types</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
</nav>
<div class="left-nav__overlay"></div>


    <article data-swiftype-index='true'>
      <a class='edit-link' href="https://github.com/apache/ignite/tree/IGNITE-7595/docs/_docs/data-modeling/affinity-collocation.adoc" target="_blank">Edit</a>
        
            <h1>Affinity Colocation</h1>
        
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In many cases it is beneficial to colocate different entries if they are often accessed together.
In this way, multi-entry queries are executed on one node (where the objects are stored).
This concept is known as <em>affinity colocation</em>.</p>
</div>
<div class="paragraph">
<p>Entries are assigned to partitions by the affinity function.
The objects that have the same affinity keys go to the same partitions.
This allows you to design your data model in such a way that related entries are stored together.
"Related" here refers to the objects that are in a parent-child relationship or objects that are often queried together.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s say you have <code>Person</code> and <code>Company</code> objects, and each person has the <code>companyId</code> field that indicates the company the person works for.
By specifying the <code>Person.companyId</code> and <code>Company.ID</code> as affinity keys, you ensure that all the persons working for the same company are stored on the same node, where the company object is stored as well.
Queries that request persons working for a specific company are processed on a single node.</p>
</div>
<div class="paragraph">
<p>You can also colocate a computation task with the data. See <a href="/docs/2.9.0/collocated-computations">Colocating Computations With Data</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-affinity-key">Configuring Affinity Key</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you do not specify the affinity key explicitly, the cache key is used as the default affinity key.
If you create your caches as SQL tables using SQL statements, the PRIMARY KEY is the default affinity key.</p>
</div>
<div class="paragraph">
<p>If you want to colocate data from two caches by a different field, you have to use a complex object as the key. That object usually contains a field that uniquely identifies the object in that cache and a field that you want to use for colocation.</p>
</div>
<div class="paragraph">
<p>There are several ways to configure a custom affinity field within the custom key, which are described below.</p>
</div>
<div class="paragraph">
<p>The following example illustrates how you can colocate the person objects with the company objects using a custom key class and the <code>@AffinityKeyMapped</code> annotation.</p>
</div>
<code-tabs><code-tab data-tab='Java'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AffinityCollocationExample</span> <span class="o">{</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">String</span> <span class="n">companyId</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">Person</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="nc">String</span> <span class="n">companyId</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">companyId</span> <span class="o">=</span> <span class="n">companyId</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">PersonKey</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

        <span class="nd">@AffinityKeyMapped</span>
        <span class="kd">private</span> <span class="nc">String</span> <span class="n">companyId</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">PersonKey</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="nc">String</span> <span class="n">companyId</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">companyId</span> <span class="o">=</span> <span class="n">companyId</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Company</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">String</span> <span class="n">id</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">Company</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configureAffinityKeyWithAnnotation</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">PersonKey</span><span class="o">,</span> <span class="nc">Person</span><span class="o">&gt;</span> <span class="n">personCfg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">PersonKey</span><span class="o">,</span> <span class="nc">Person</span><span class="o">&gt;(</span><span class="s">"persons"</span><span class="o">);</span>
        <span class="n">personCfg</span><span class="o">.</span><span class="na">setBackups</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

        <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Company</span><span class="o">&gt;</span> <span class="n">companyCfg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheConfiguration</span><span class="o">&lt;&gt;(</span><span class="s">"companies"</span><span class="o">);</span>
        <span class="n">companyCfg</span><span class="o">.</span><span class="na">setBackups</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

        <span class="k">try</span> <span class="o">(</span><span class="nc">Ignite</span> <span class="n">ignite</span> <span class="o">=</span> <span class="nc">Ignition</span><span class="o">.</span><span class="na">start</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">IgniteCache</span><span class="o">&lt;</span><span class="nc">PersonKey</span><span class="o">,</span> <span class="nc">Person</span><span class="o">&gt;</span> <span class="n">personCache</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">getOrCreateCache</span><span class="o">(</span><span class="n">personCfg</span><span class="o">);</span>
            <span class="nc">IgniteCache</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Company</span><span class="o">&gt;</span> <span class="n">companyCache</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">getOrCreateCache</span><span class="o">(</span><span class="n">companyCfg</span><span class="o">);</span>

            <span class="nc">Company</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Company</span><span class="o">(</span><span class="s">"company1"</span><span class="o">,</span> <span class="s">"My company"</span><span class="o">);</span>
            <span class="nc">Person</span> <span class="n">p1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">c1</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="s">"John"</span><span class="o">);</span>

            <span class="c1">// Both the p1 and c1 objects will be cached on the same node</span>
            <span class="n">personCache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="k">new</span> <span class="nc">PersonKey</span><span class="o">(</span><span class="n">p1</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">c1</span><span class="o">.</span><span class="na">getId</span><span class="o">()),</span> <span class="n">p1</span><span class="o">);</span>
            <span class="n">companyCache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"company1"</span><span class="o">,</span> <span class="n">c1</span><span class="o">);</span>

            <span class="c1">// Get the person object</span>
            <span class="n">p1</span> <span class="o">=</span> <span class="n">personCache</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="k">new</span> <span class="nc">PersonKey</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"company1"</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C#/.NET'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="k">class</span> <span class="nc">Person</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">CityId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">CompanyId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">PersonKey</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="p">[</span><span class="n">AffinityKeyMapped</span><span class="p">]</span> <span class="k">public</span> <span class="kt">string</span> <span class="n">CompanyId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Company</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">AffinityCollocation</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Example</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">personCfg</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CacheConfiguration</span>
        <span class="p">{</span>
            <span class="n">Name</span> <span class="p">=</span> <span class="s">"persons"</span><span class="p">,</span>
            <span class="n">Backups</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
            <span class="n">CacheMode</span> <span class="p">=</span> <span class="n">CacheMode</span><span class="p">.</span><span class="n">Partitioned</span>
        <span class="p">};</span>

        <span class="kt">var</span> <span class="n">companyCfg</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CacheConfiguration</span>
        <span class="p">{</span>
            <span class="n">Name</span> <span class="p">=</span> <span class="s">"companies"</span><span class="p">,</span>
            <span class="n">Backups</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
            <span class="n">CacheMode</span> <span class="p">=</span> <span class="n">CacheMode</span><span class="p">.</span><span class="n">Partitioned</span>
        <span class="p">};</span>

        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ignite</span> <span class="p">=</span> <span class="n">Ignition</span><span class="p">.</span><span class="nf">Start</span><span class="p">())</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">personCache</span> <span class="p">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetOrCreateCache</span><span class="p">&lt;</span><span class="n">PersonKey</span><span class="p">,</span> <span class="n">Person</span><span class="p">&gt;(</span><span class="n">personCfg</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">companyCache</span> <span class="p">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetOrCreateCache</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">Company</span><span class="p">&gt;(</span><span class="n">companyCfg</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">person</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span> <span class="p">{</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Vasya"</span><span class="p">};</span>

            <span class="kt">var</span> <span class="n">company</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Company</span> <span class="p">{</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"Company1"</span><span class="p">};</span>

            <span class="n">personCache</span><span class="p">.</span><span class="nf">Put</span><span class="p">(</span><span class="k">new</span> <span class="n">PersonKey</span> <span class="p">{</span><span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">CompanyId</span> <span class="p">=</span> <span class="s">"company1_key"</span><span class="p">},</span> <span class="n">person</span><span class="p">);</span>
            <span class="n">companyCache</span><span class="p">.</span><span class="nf">Put</span><span class="p">(</span><span class="s">"company1_key"</span><span class="p">,</span> <span class="n">company</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C++' data-unavailable='true'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>This API is not presently available for C++.</code></pre>
</div>
</div></code-tab><code-tab data-tab='SQL'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="sql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">Person</span> <span class="p">(</span>
  <span class="n">id</span> <span class="nb">int</span><span class="p">,</span>
  <span class="n">city_id</span> <span class="nb">int</span><span class="p">,</span>
  <span class="n">name</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="n">company_id</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">city_id</span><span class="p">)</span>
<span class="p">)</span> <span class="k">WITH</span> <span class="nv">"template=partitioned,backups=1,affinity_key=company_id"</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">Company</span> <span class="p">(</span>
  <span class="n">id</span> <span class="nb">int</span><span class="p">,</span>
  <span class="n">name</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">)</span> <span class="k">WITH</span> <span class="nv">"template=partitioned,backups=1"</span><span class="p">;</span></code></pre>
</div>
</div></code-tab></code-tabs>
<div class="paragraph">
<p>You can also configure the affinity key field in the cache configuration by using the <code>CacheKeyConfiguration</code> class.</p>
</div>
<code-tabs><code-tab data-tab='Java'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">configureAffinityKeyWithCacheKeyConfiguration</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">PersonKey</span><span class="o">,</span> <span class="nc">Person</span><span class="o">&gt;</span> <span class="n">personCfg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">PersonKey</span><span class="o">,</span> <span class="nc">Person</span><span class="o">&gt;(</span><span class="s">"persons"</span><span class="o">);</span>
    <span class="n">personCfg</span><span class="o">.</span><span class="na">setBackups</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

    <span class="c1">// Configure the affinity key</span>
    <span class="n">personCfg</span><span class="o">.</span><span class="na">setKeyConfiguration</span><span class="o">(</span><span class="k">new</span> <span class="nc">CacheKeyConfiguration</span><span class="o">(</span><span class="s">"Person"</span><span class="o">,</span> <span class="s">"companyId"</span><span class="o">));</span>

    <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Company</span><span class="o">&gt;</span> <span class="n">companyCfg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Company</span><span class="o">&gt;(</span><span class="s">"companies"</span><span class="o">);</span>
    <span class="n">companyCfg</span><span class="o">.</span><span class="na">setBackups</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

    <span class="nc">Ignite</span> <span class="n">ignite</span> <span class="o">=</span> <span class="nc">Ignition</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

    <span class="nc">IgniteCache</span><span class="o">&lt;</span><span class="nc">PersonKey</span><span class="o">,</span> <span class="nc">Person</span><span class="o">&gt;</span> <span class="n">personCache</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">getOrCreateCache</span><span class="o">(</span><span class="n">personCfg</span><span class="o">);</span>
    <span class="nc">IgniteCache</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Company</span><span class="o">&gt;</span> <span class="n">companyCache</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">getOrCreateCache</span><span class="o">(</span><span class="n">companyCfg</span><span class="o">);</span>

    <span class="nc">Company</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Company</span><span class="o">(</span><span class="s">"company1"</span><span class="o">,</span> <span class="s">"My company"</span><span class="o">);</span>
    <span class="nc">Person</span> <span class="n">p1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">c1</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="s">"John"</span><span class="o">);</span>

    <span class="c1">// Both the p1 and c1 objects will be cached on the same node</span>
    <span class="n">personCache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="k">new</span> <span class="nc">PersonKey</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">c1</span><span class="o">.</span><span class="na">getId</span><span class="o">()),</span> <span class="n">p1</span><span class="o">);</span>
    <span class="n">companyCache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">c1</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">c1</span><span class="o">);</span>

    <span class="c1">// Get the person object</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">personCache</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="k">new</span> <span class="nc">PersonKey</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"company1"</span><span class="o">));</span>
<span class="o">}</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C#/.NET'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="kt">var</span> <span class="n">personCfg</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CacheConfiguration</span><span class="p">(</span><span class="s">"persons"</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">KeyConfiguration</span> <span class="p">=</span> <span class="k">new</span><span class="p">[]</span>
    <span class="p">{</span>
        <span class="k">new</span> <span class="n">CacheKeyConfiguration</span>
        <span class="p">{</span>
            <span class="n">TypeName</span> <span class="p">=</span> <span class="k">nameof</span><span class="p">(</span><span class="n">Person</span><span class="p">),</span>
            <span class="n">AffinityKeyFieldName</span> <span class="p">=</span> <span class="k">nameof</span><span class="p">(</span><span class="n">Person</span><span class="p">.</span><span class="n">CompanyId</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="kt">var</span> <span class="n">companyCfg</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CacheConfiguration</span><span class="p">(</span><span class="s">"companies"</span><span class="p">);</span>

<span class="n">IIgnite</span> <span class="n">ignite</span> <span class="p">=</span> <span class="n">Ignition</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>

<span class="n">ICache</span><span class="p">&lt;</span><span class="n">PersonKey</span><span class="p">,</span> <span class="n">Person</span><span class="p">&gt;</span> <span class="n">personCache</span> <span class="p">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetOrCreateCache</span><span class="p">&lt;</span><span class="n">PersonKey</span><span class="p">,</span> <span class="n">Person</span><span class="p">&gt;(</span><span class="n">personCfg</span><span class="p">);</span>
<span class="n">ICache</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">Company</span><span class="p">&gt;</span> <span class="n">companyCache</span> <span class="p">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetOrCreateCache</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">Company</span><span class="p">&gt;(</span><span class="n">companyCfg</span><span class="p">);</span>

<span class="kt">var</span> <span class="n">companyId</span> <span class="p">=</span> <span class="s">"company_1"</span><span class="p">;</span>
<span class="n">Company</span> <span class="n">c1</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Company</span> <span class="p">{</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"My company"</span><span class="p">};</span>
<span class="n">Person</span> <span class="n">p1</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span> <span class="p">{</span><span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"John"</span><span class="p">,</span> <span class="n">CompanyId</span> <span class="p">=</span> <span class="n">companyId</span><span class="p">};</span>

<span class="c1">// Both the p1 and c1 objects will be cached on the same node</span>
<span class="n">personCache</span><span class="p">.</span><span class="nf">Put</span><span class="p">(</span><span class="k">new</span> <span class="n">PersonKey</span> <span class="p">{</span><span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">CompanyId</span> <span class="p">=</span> <span class="n">companyId</span><span class="p">},</span> <span class="n">p1</span><span class="p">);</span>
<span class="n">companyCache</span><span class="p">.</span><span class="nf">Put</span><span class="p">(</span><span class="n">companyId</span><span class="p">,</span> <span class="n">c1</span><span class="p">);</span>

<span class="c1">// Get the person object</span>
<span class="n">p1</span> <span class="p">=</span> <span class="n">personCache</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="k">new</span> <span class="n">PersonKey</span> <span class="p">{</span><span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">CompanyId</span> <span class="p">=</span> <span class="n">companyId</span><span class="p">});</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C++' data-unavailable='true'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>This API is not presently available for C++.</code></pre>
</div>
</div></code-tab></code-tabs>
<div class="paragraph">
<p>Instead of defining a custom key class, you can use the <code>AffinityKey</code> class, which is designed specifically for the purpose of using custom affinity mapping.</p>
</div>
<code-tabs><code-tab data-tab='Java'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">configureAffinitKeyWithAffinityKeyClass</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">AffinityKey</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;,</span> <span class="nc">Person</span><span class="o">&gt;</span> <span class="n">personCfg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">AffinityKey</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;,</span> <span class="nc">Person</span><span class="o">&gt;(</span>
            <span class="s">"persons"</span><span class="o">);</span>
    <span class="n">personCfg</span><span class="o">.</span><span class="na">setBackups</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

    <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Company</span><span class="o">&gt;</span> <span class="n">companyCfg</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CacheConfiguration</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Company</span><span class="o">&gt;(</span><span class="s">"companies"</span><span class="o">);</span>
    <span class="n">companyCfg</span><span class="o">.</span><span class="na">setBackups</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

    <span class="nc">Ignite</span> <span class="n">ignite</span> <span class="o">=</span> <span class="nc">Ignition</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

    <span class="nc">IgniteCache</span><span class="o">&lt;</span><span class="nc">AffinityKey</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;,</span> <span class="nc">Person</span><span class="o">&gt;</span> <span class="n">personCache</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">getOrCreateCache</span><span class="o">(</span><span class="n">personCfg</span><span class="o">);</span>
    <span class="nc">IgniteCache</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Company</span><span class="o">&gt;</span> <span class="n">companyCache</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">getOrCreateCache</span><span class="o">(</span><span class="n">companyCfg</span><span class="o">);</span>

    <span class="nc">Company</span> <span class="n">c1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Company</span><span class="o">(</span><span class="s">"company1"</span><span class="o">,</span> <span class="s">"My company"</span><span class="o">);</span>
    <span class="nc">Person</span> <span class="n">p1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Person</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">c1</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="s">"John"</span><span class="o">);</span>

    <span class="c1">// Both the p1 and c1 objects will be cached on the same node</span>
    <span class="n">personCache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="k">new</span> <span class="nc">AffinityKey</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;(</span><span class="n">p1</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">c1</span><span class="o">.</span><span class="na">getId</span><span class="o">()),</span> <span class="n">p1</span><span class="o">);</span>
    <span class="n">companyCache</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">c1</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">c1</span><span class="o">);</span>

    <span class="c1">// Get the person object</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">personCache</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="k">new</span> <span class="nc">AffinityKey</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"company1"</span><span class="o">));</span>
<span class="o">}</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C#/.NET'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="kt">var</span> <span class="n">personCfg</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CacheConfiguration</span><span class="p">(</span><span class="s">"persons"</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">companyCfg</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CacheConfiguration</span><span class="p">(</span><span class="s">"companies"</span><span class="p">);</span>

<span class="n">IIgnite</span> <span class="n">ignite</span> <span class="p">=</span> <span class="n">Ignition</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>

<span class="n">ICache</span><span class="p">&lt;</span><span class="n">AffinityKey</span><span class="p">,</span> <span class="n">Person</span><span class="p">&gt;</span> <span class="n">personCache</span> <span class="p">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetOrCreateCache</span><span class="p">&lt;</span><span class="n">AffinityKey</span><span class="p">,</span> <span class="n">Person</span><span class="p">&gt;(</span><span class="n">personCfg</span><span class="p">);</span>
<span class="n">ICache</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">Company</span><span class="p">&gt;</span> <span class="n">companyCache</span> <span class="p">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetOrCreateCache</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="n">Company</span><span class="p">&gt;(</span><span class="n">companyCfg</span><span class="p">);</span>

<span class="kt">var</span> <span class="n">companyId</span> <span class="p">=</span> <span class="s">"company_1"</span><span class="p">;</span>
<span class="n">Company</span> <span class="n">c1</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Company</span> <span class="p">{</span><span class="n">Name</span> <span class="p">=</span> <span class="s">"My company"</span><span class="p">};</span>
<span class="n">Person</span> <span class="n">p1</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Person</span> <span class="p">{</span><span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"John"</span><span class="p">,</span> <span class="n">CompanyId</span> <span class="p">=</span> <span class="n">companyId</span><span class="p">};</span>

<span class="c1">// Both the p1 and c1 objects will be cached on the same node</span>
<span class="n">personCache</span><span class="p">.</span><span class="nf">Put</span><span class="p">(</span><span class="k">new</span> <span class="nf">AffinityKey</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">companyId</span><span class="p">),</span> <span class="n">p1</span><span class="p">);</span>
<span class="n">companyCache</span><span class="p">.</span><span class="nf">Put</span><span class="p">(</span><span class="n">companyId</span><span class="p">,</span> <span class="n">c1</span><span class="p">);</span>

<span class="c1">// Get the person object</span>
<span class="n">p1</span> <span class="p">=</span> <span class="n">personCache</span><span class="p">.</span><span class="nf">Get</span><span class="p">(</span><span class="k">new</span> <span class="nf">AffinityKey</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">companyId</span><span class="p">));</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C++' data-unavailable='true'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>This API is not presently available for C++.</code></pre>
</div>
</div></code-tab></code-tabs>
</div>
</div>
    </article>
    <nav class="right-nav" data-swiftype-index='false'>
    <ul class="sectlevel1">
<li><a href="#configuring-affinity-key">Configuring Affinity Key</a></li>
</ul>
          
      
<footer>
</footer>

</nav>
    
</section>
<script type='module' src='/assets/js/code-copy-to-clipboard.js' async crossorigin></script>

    <script>
    // inits deep anchors -- needs to be done here because of https://www.bryanbraun.com/anchorjs/#dont-run-it-too-late 
    anchors.add('.page-docs h1, .page-docs h2, .page-docs h3:not(.discrete), .page-docs h4, .page-docs h5');
    anchors.options = {
        placement: 'right',
        visible: 'always'
    };
    </script>
    <!-- load google fonts async -->
    <script type="text/javascript">
    WebFontConfig = {
      google: { families: [ 'Open+Sans:300,400,600,700&display=swap' ] }
    };
    (function() {
      var wf = document.createElement('script');
      wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
      wf.type = 'text/javascript';
      wf.async = 'true';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(wf, s);
    })(); </script>
    <script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script>
      docsearch({
        // Your apiKey and indexName will be given to you once
        // we create your config
        apiKey: '3eee686c0ebe39eff3baeb18c56fa5f8', 
        indexName: 'apache_ignite',
        // Replace inputSelector with a CSS selector
        // matching your search input
        inputSelector: '#search-input',
        // algoliaOptions: { 'facetFilters': ["version:$VERSION"] },

        // Set debug to true to inspect the dropdown
        debug: false,
      });
    </script>
<script type='module' src='/assets/js/index.js?1598892242' async crossorigin></script>
<script type='module' src='/assets/js/versioning.js?1598892242' async crossorigin></script>
</body>

</html>
