<!DOCTYPE html>

      
      
<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-61232409-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-61232409-1');
    </script>

    

    <meta charset="UTF-8">
    <meta name="ignite-version" content="2.9.0" />
    <title>Colocating Computations with Data | Ignite Documentation</title>
    
    <link rel="canonical" href="/docs/2.9.0/collocated-computations" />
    
	
	<link rel="stylesheet" href="/assets/css/styles.css?1600286556">
    <link rel="stylesheet" href="/assets/css/asciidoc-pygments.css">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name='viewport' content='width=device-width, height=device-height, initial-scale=1.0, minimum-scale=1.0'>

	<script type="text/javascript" src="/assets/js/anchor.min.js?1600286556"></script>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />


</head>
<body>
    <header>
    <!--#include virtual="/includes/promotion_banner.html" -->
    <div class="container">
        <button type='button' class='menu' title='Docs menu'>
        <img src="/assets/images/menu-icon.svg"/>
        </button>
        <div class='home'>
            <a href="/" class='home' title='Apache Ignite home'>
                <img src="/assets/images/apache_ignite_logo.svg" alt="Apache Ignite logo" width="103" >
            </a>
        </div>
        
        <nav>
            
        </nav>
        
        <select id="version-selector">
            <option value="2.9.0">2.9.0</option>
        </select>
        
        <a href="https://github.com/apache/ignite" title='GitHub' class='github' target="_blank">
            <img src="/assets/images/github-gray.svg" alt="GitHub logo">
        </a>
        
        <form class='search'>
            <button class="search-close" type='button'><img src='/assets/images/cancel.svg'></button>
            <input type="search" placeholder="Search…" id="search-input">
        </form>
        <button type='button' class='search-toggle'><img src='/assets/images/search.svg'></button>
        <button type='button' class='top-nav-toggle'>⋮</button>

        
        
    </div>
</header>


    	 <link rel="stylesheet" href="/assets/css/docs.css">
<section class='page-docs'>
    



<nav class='left-nav' data-swiftype-index='false'>

      
        <li>
            

            <a href="/docs/2.9.0/preface" class='' >Preface</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Quick Start Guides<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/java"

                                class=''
                            >Java</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/dotnet"

                                class=''
                            >.NET/C#</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/cpp"

                                class=''
                            >C++</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/python"

                                class=''
                            >Python</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/nodejs"

                                class=''
                            >Node.JS</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/sql"

                                class=''
                            >SQL</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/php"

                                class=''
                            >PHP</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/quick-start/restapi"

                                class=''
                            >REST API</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="/installation" class='group-toggle collapsed '>Installation<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/installation/installing-using-zip"

                                class=''
                            >Installing Using ZIP Archive</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/installation/installing-using-docker"

                                class=''
                            >Installing Using Docker</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/installation/deb-rpm"

                                class=''
                            >Installing DEB or RPM package</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Kubernetes<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//installation/kubernetes/amazon-eks-deployment" class=''>Amazon EKS</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//installation/kubernetes/azure-deployment" class=''>Azure Kubernetes Service</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//installation/kubernetes/gke-deployment" class=''>Google Kubernetes Engine</a></li>
                            
                            </nav>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Setting Up<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/setup"

                                class=''
                            >Setting Up Ignite for Java</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/setup-dotnet"

                                class=''
                            >Setting Up Ignite for .NET/C#</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/understanding-configuration" class='' >Understanding Configuration</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/logging" class='' >Configuring Logging</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/starting-nodes" class='' >Starting and Stopping Nodes</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Clustering<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/clustering"

                                class=''
                            >Overview</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/tcp-ip-discovery"

                                class=''
                            >TCP/IP Discovery</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/zookeeper-discovery"

                                class=''
                            >ZooKeeper Discovery</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/discovery-in-the-cloud"

                                class=''
                            >Discovery in the Cloud</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/network-configuration"

                                class=''
                            >Network Configuration</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/connect-client-nodes"

                                class=''
                            >Connecting Client Nodes</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/clustering/running-client-nodes-behind-nat"

                                class=''
                            >Running Client Nodes Behind NAT</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Data Modeling<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-modeling/data-modeling"

                                class=''
                            >Introduction</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-modeling/data-partitioning"

                                class=''
                            >Data Partitioning</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-modeling/affinity-collocation"

                                class=''
                            >Affinity Colocation</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Configuring Memory<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/memory-architecture"

                                class=''
                            >Memory Architecture</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/memory-configuration/data-regions"

                                class=''
                            >Configuring Data Regions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/memory-configuration/eviction-policies"

                                class=''
                            >Eviction Policies</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Configuring Caches<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/configuration-overview"

                                class=''
                            >Cache Configuration</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/configuring-backups"

                                class=''
                            >Configuring Partition Backups</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/atomicity-modes"

                                class=''
                            >Atomicity Modes</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/expiry-policies"

                                class=''
                            >Expiry Policy</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/on-heap-caching"

                                class=''
                            >On-Heap Caching</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/configuring-caches/cache-groups"

                                class=''
                            >Cache Groups</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Persistence<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/native-persistence"

                                class=''
                            >Ignite Persistence</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/external-storage"

                                class=''
                            >External Storage</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/swap"

                                class=''
                            >Swapping</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/custom-cache-store"

                                class=''
                            >Implementing Custom Cache Store</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/disk-compression"

                                class=''
                            >Disk Compression</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/persistence/persistence-tuning"

                                class=''
                            >Tuning Persistence</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/baseline-topology" class='' >Baseline Topology</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/cluster-states" class='' >Cluster States</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/data-rebalancing" class='' >Data Rebalancing</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/partition-loss-policy" class='' >Partition Loss Policy</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/deploying-user-code" class='' >Deploying User Code</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/peer-class-loading" class='' >Peer Class Loading</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/data-streaming" class='' >Data Streaming</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Using Key-Value Cache API<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/key-value-api/basic-cache-operations"

                                class=''
                            >Basic Cache Operations</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/key-value-api/binary-objects"

                                class=''
                            >Working with Binary Objects</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/key-value-api/using-scan-queries"

                                class=''
                            >Using Scan Queries</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/read-repair"

                                class=''
                            >Read Repair</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/key-value-api/continuous-queries" class='' >Using Continuous Queries</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/key-value-api/transactions" class='' >Performing Transactions</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Working with SQL<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/sql-introduction"

                                class=''
                            >Introduction</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/schemas"

                                class=''
                            >Understanding Schemas</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/indexes"

                                class=''
                            >Defining Indexes</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/sql-api"

                                class=''
                            >Using SQL API</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/distributed-joins"

                                class=''
                            >Distributed Joins</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/sql-transactions"

                                class=''
                            >SQL Transactions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/custom-sql-func"

                                class=''
                            >Custom SQL Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/JDBC/jdbc-driver"

                                class=''
                            >JDBC Driver</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/JDBC/jdbc-client-driver"

                                class=''
                            >JDBC Client Driver</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/transactions/mvcc"

                                class=''
                            >Multiversion Concurrency Control</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Distributed Computing<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/distributed-computing"

                                class=''
                            >Distributed Computing API</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/cluster-groups"

                                class=''
                            >Cluster Groups</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/executor-service"

                                class=''
                            >Executor Service</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/map-reduce"

                                class=''
                            >MapReduce API</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/load-balancing"

                                class=''
                            >Load Balancing</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/fault-tolerance"

                                class=''
                            >Fault Tolerance</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/distributed-computing/job-scheduling"

                                class=''
                            >Job Scheduling</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/collocated-computations" class='active' >Colocating Computations with Data</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Working with Events<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/events/listening-to-events"

                                class=''
                            >Enabling and Listenting to Events</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/events/events"

                                class=''
                            >Events</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/near-cache" class='' >Near Caches</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/platform-cache" class='' >.NET Platform Cache</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/services/services" class='' >Services</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Distributed Data Structures<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-structures/queue-and-set"

                                class=''
                            >Queue and Set</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-structures/atomic-types"

                                class=''
                            >Atomic Types</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-structures/countdownlatch"

                                class=''
                            >CountDownLatch</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-structures/atomic-sequence"

                                class=''
                            >Atomic Sequence</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/data-structures/semaphore"

                                class=''
                            >Semaphore</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Machine Learning<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/machine-learning/machine-learning"

                                class=''
                            >Machine Learning</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/machine-learning/partition-based-dataset"

                                class=''
                            >Partition Based Dataset</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/machine-learning/updating-trained-models"

                                class=''
                            >Updating Trained Models</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Binary Classification<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/binary-classification/introduction" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/binary-classification/linear-svm" class=''>Linear SVM (Support Vector Machine)</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/binary-classification/decision-trees" class=''>Decision Trees</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/binary-classification/multilayer-perceptron" class=''>Multilayer Perceptron</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/binary-classification/logistic-regression" class=''>Logistic Regression</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/binary-classification/knn-classification" class=''>k-NN Classification</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/binary-classification/ann" class=''>ANN (Approximate Nearest Neighbor)</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/binary-classification/naive-bayes" class=''>Naive Bayes</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Regression<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/regression/introduction" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/regression/linear-regression" class=''>Linear Regression</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/regression/decision-trees-regression" class=''>Decision Trees Regression</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/regression/knn-regression" class=''>k-NN Regression</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Clustering<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/clustering/introduction" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/clustering/k-means-clustering" class=''>K-Means Clustering</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/clustering/gaussian-mixture" class=''>Gaussian mixture (GMM)</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/machine-learning/preprocessing"

                                class=''
                            >Preprocessing</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Model Selection<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/model-selection/introduction" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/model-selection/evaluator" class=''>Evaluator</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/model-selection/split-the-dataset-on-test-and-train-datasets" class=''>Split the dataset on test and train datasets</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/model-selection/hyper-parameter-tuning" class=''>Hyper-parameter tuning</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/model-selection/pipeline-api" class=''>Pipeline API</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/machine-learning/multiclass-classification"

                                class=''
                            >Multiclass Classification</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Ensemble Methods<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/ensemble-methods/introduction" class=''></a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/ensemble-methods/stacking" class=''>Stacking</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/ensemble-methods/baggin" class=''>Bagging</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/ensemble-methods/random-forest" class=''>Random Forest</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/ensemble-methods/gradient-boosting" class=''>Gradient Boosting</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/machine-learning/recommendation-systems"

                                class=''
                            >Recommendation Systems</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Importing Model<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/importing-model/introduction" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/importing-model/model-import-from-gxboost" class=''>Import Model from XGBoost</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//machine-learning/importing-model/model-import-from-apache-spark" class=''>Import Model from Apache Spark</a></li>
                            
                            </nav>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Monitoring<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/intro"

                                class=''
                            >Introduction</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/cluster-id"

                                class=''
                            >Cluster ID and Tag</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Metrics<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//monitoring-metrics/configuring-metrics" class=''>Configuring Metrics</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//monitoring-metrics/metrics" class=''>JMX Metrics</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>New Metrics System<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//monitoring-metrics/new-metrics-system" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//monitoring-metrics/new-metrics" class=''>Metrics</a></li>
                            
                            </nav>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/system-views"

                                class=''
                            >System Views</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/monitoring-metrics/tracing"

                                class=''
                            >Tracing</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="/security" class='group-toggle collapsed '>Security<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/security/authentication"

                                class=''
                            >Authentication</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/security/ssl-tls"

                                class=''
                            >SSL/TLS</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Transparent Data Encryption<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//security/tde" class=''>Introduction</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//security/master-key-rotation" class=''>Master key rotation</a></li>
                            
                            </nav>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Thin Clients<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/getting-started-with-thin-clients"

                                class=''
                            >Thin Clients Overview</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/java-thin-client"

                                class=''
                            >Java Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/dotnet-thin-client"

                                class=''
                            >.NET Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/cpp-thin-client"

                                class=''
                            >C++ Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/python-thin-client"

                                class=''
                            >Python Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/php-thin-client"

                                class=''
                            >PHP Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/thin-clients/nodejs-thin-client"

                                class=''
                            >Node.js Thin Client</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            
                            
                            <button
                                type='button'
                                class='collapsed '>Binary Client Protocol<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
                            <nav class="sub_pages collapsed">

                            
                                  

								  <li><a href="/docs/2.9.0//binary-client-protocol/binary-client-protocol" class=''>Binary Client Protocol</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//binary-client-protocol/data-format" class=''>Data Format</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//binary-client-protocol/key-value-queries" class=''>Key-Value Queries</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//binary-client-protocol/sql-and-scan-queries" class=''>SQL and Scan Queries</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//binary-client-protocol/binary-type-metadata" class=''>Binary Types Metadata</a></li>
                            
                                  

								  <li><a href="/docs/2.9.0//binary-client-protocol/cache-configuration" class=''>Cache Configuration</a></li>
                            
                            </nav>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>ODBC Driver<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/odbc-driver"

                                class=''
                            >ODBC Driver</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/connection-string-dsn"

                                class=''
                            >Connection String and DSN</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/querying-modifying-data"

                                class=''
                            >Querying and Modifying Data</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/specification"

                                class=''
                            >Specification</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/data-types"

                                class=''
                            >Data Types</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/SQL/ODBC/error-codes"

                                class=''
                            >Error Codes</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/restapi" class='' >REST API</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/control-script" class='' >Control Script</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/plugins" class='' >Plugins</a>
            
        </li>
    
        <li>
            

            <a href="/docs/2.9.0/sqlline" class='' >SQLLine</a>
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="" class='group-toggle collapsed '>Ignite for Spark<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/ignite-for-spark/overview"

                                class=''
                            >Overview</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/ignite-for-spark/ignitecontext-and-rdd"

                                class=''
                            >IgniteContext and IgniteRDD</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/ignite-for-spark/ignite-dataframe"

                                class=''
                            >Ignite DataFrame</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/ignite-for-spark/installation"

                                class=''
                            >Installation</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/ignite-for-spark/spark-shell"

                                class=''
                            >Test Ignite with Spark-shell</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/ignite-for-spark/troubleshooting"

                                class=''
                            >Troubleshooting</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
        <li>
            

            

            

			<button type='button' data-guide-url="/sql-reference/sql-reference-overview" class='group-toggle collapsed '>SQL Reference<img class="state-indicator" src="/assets/images/left-nav-arrow.svg"></button>
             <nav class='nav-group collapsed'>
            
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/sql-conformance"

                                class=''
                            >SQL Conformance</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/ddl"

                                class=''
                            >Data Definition Language (DDL)</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/dml"

                                class=''
                            >Data Manipulation Language (DML)</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/transactions"

                                class=''
                            >Transactions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/operational-commands"

                                class=''
                            >Operational Commands</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/aggregate-functions"

                                class=''
                            >Aggregate functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/numeric-functions"

                                class=''
                            >Numeric Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/string-functions"

                                class=''
                            >String Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/date-time-functions"

                                class=''
                            >Data and Time Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/system-functions"

                                class=''
                            >System Functions</a>
                        
                    </li>
                

                    
                    

                    <li> 
                        
                            <a href="/docs/2.9.0/sql-reference/data-types"

                                class=''
                            >Data Types</a>
                        
                    </li>
                
              
                     
             </nav>   
            
        </li>
    
</nav>
<div class="left-nav__overlay"></div>


    <article data-swiftype-index='true'>
      <a class='edit-link' href="https://github.com/apache/ignite/tree/IGNITE-7595/docs/_docs/collocated-computations.adoc" target="_blank">Edit</a>
        
            <h1>Colocating Computations with Data</h1>
        
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Colocated computation is type of distributed data processing wherein the computational task you want to perform over a specific data set is sent to the nodes where the required data is located and only the results of the computations are sent back. This approach minimizes data transfer between nodes and can significantly reduce the task execution time.</p>
</div>
<div class="paragraph">
<p>Ignite provides several ways to perform colocated computations, all of which use the affinity function to determine the location of the data.</p>
</div>
<div class="paragraph">
<p>The compute interface provides the <code>affinityCall(&#8230;&#8203;)</code> and <code>affinityRun(&#8230;&#8203;)</code> methods that colocate a task with data either by key or by partition.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>affinityCall(&#8230;&#8203;)</code> and <code>affinityRun(&#8230;&#8203;)</code> methods guarantee that the data for the given key or partition is present on the target node for the duration of the task.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>The class definitions of the task to be executed on remote nodes must be available on the nodes.
You can ensure this in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the classes to the classpath of the nodes;</p>
</li>
<li>
<p>Enable <a href="/docs/2.9.0/peer-class-loading">peer class loading</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="colocating-by-key">Colocating by Key</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To send a computational task to the node where a given key is located, use the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>IgniteCompute.affinityCall(String cacheName, Object key, IgniteCallable&lt;R&gt; job)</code></p>
</li>
<li>
<p><code>IgniteCompute.affinityRun(String cacheName, Object key, IgniteRunnable job)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ignite calls the configured affinity function to determine the location of the given key.</p>
</div>
<code-tabs><code-tab data-tab='Java'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">IgniteCache</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">cache</span><span class="o">(</span><span class="s">"myCache"</span><span class="o">);</span>

<span class="nc">IgniteCompute</span> <span class="n">compute</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">compute</span><span class="o">();</span>

<span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

<span class="c1">// This closure will execute on the remote node where</span>
<span class="c1">// data for the given 'key' is located.</span>
<span class="n">compute</span><span class="o">.</span><span class="na">affinityRun</span><span class="o">(</span><span class="s">"myCache"</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// Peek is a local memory lookup.</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Co-located [key= "</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s">", value= "</span> <span class="o">+</span> <span class="n">cache</span><span class="o">.</span><span class="na">localPeek</span><span class="o">(</span><span class="n">key</span><span class="o">)</span> <span class="o">+</span> <span class="sc">']'</span><span class="o">);</span>
<span class="o">});</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C#/.NET'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="k">class</span> <span class="nc">MyComputeAction</span> <span class="p">:</span> <span class="n">IComputeAction</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">InstanceResource</span><span class="p">]</span> <span class="k">private</span> <span class="k">readonly</span> <span class="n">IIgnite</span> <span class="n">_ignite</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">int</span> <span class="n">Key</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">Invoke</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">cache</span> <span class="p">=</span> <span class="n">_ignite</span><span class="p">.</span><span class="n">GetCache</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;(</span><span class="s">"myCache"</span><span class="p">);</span>
        <span class="c1">// Peek is a local memory lookup</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Co-located [key= "</span> <span class="p">+</span> <span class="n">Key</span> <span class="p">+</span> <span class="s">", value= "</span> <span class="p">+</span> <span class="n">cache</span><span class="p">.</span><span class="nf">LocalPeek</span><span class="p">(</span><span class="n">Key</span><span class="p">)</span> <span class="p">+</span> <span class="sc">']'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">AffinityRunDemo</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">cfg</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">IgniteConfiguration</span><span class="p">();</span>
    <span class="kt">var</span> <span class="n">ignite</span> <span class="p">=</span> <span class="n">Ignition</span><span class="p">.</span><span class="nf">Start</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span>

    <span class="kt">var</span> <span class="n">cache</span> <span class="p">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetOrCreateCache</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;(</span><span class="s">"myCache"</span><span class="p">);</span>
    <span class="n">cache</span><span class="p">.</span><span class="nf">Put</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="s">"foo"</span><span class="p">);</span>
    <span class="n">cache</span><span class="p">.</span><span class="nf">Put</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="s">"bar"</span><span class="p">);</span>
    <span class="n">cache</span><span class="p">.</span><span class="nf">Put</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="s">"baz"</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">keyCnt</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span>

    <span class="kt">var</span> <span class="n">compute</span> <span class="p">=</span> <span class="n">ignite</span><span class="p">.</span><span class="nf">GetCompute</span><span class="p">();</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">key</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">key</span> <span class="p">&lt;</span> <span class="n">keyCnt</span><span class="p">;</span> <span class="n">key</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="c1">// This closure will execute on the remote node where</span>
        <span class="c1">// data for the given 'key' is located.</span>
        <span class="n">compute</span><span class="p">.</span><span class="nf">AffinityRun</span><span class="p">(</span><span class="s">"myCache"</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="k">new</span> <span class="n">MyComputeAction</span> <span class="p">{</span><span class="n">Key</span> <span class="p">=</span> <span class="n">key</span><span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C++'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cm">/*
 * Function class.
 */</span>
<span class="k">struct</span> <span class="nc">FuncAffinityRun</span> <span class="o">:</span> <span class="n">compute</span><span class="o">::</span><span class="n">ComputeFunc</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="cm">/*
    * Default constructor.
    */</span>
    <span class="n">FuncAffinityRun</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// No-op.</span>
    <span class="p">}</span>

    <span class="cm">/*
    * Parameterized constructor.
    */</span>
    <span class="n">FuncAffinityRun</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">cacheName</span><span class="p">,</span> <span class="kt">int32_t</span> <span class="n">key</span><span class="p">)</span> <span class="o">:</span>
        <span class="n">cacheName</span><span class="p">(</span><span class="n">cacheName</span><span class="p">),</span> <span class="n">key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// No-op.</span>
    <span class="p">}</span>

    <span class="cm">/**
     * Callback.
     */</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">Call</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Ignite</span><span class="o">&amp;</span> <span class="n">node</span> <span class="o">=</span> <span class="n">GetIgnite</span><span class="p">();</span>

        <span class="n">Cache</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">GetCache</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="p">(</span><span class="n">cacheName</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span>

        <span class="c1">// Peek is a local memory lookup.</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Co-located [key= "</span> <span class="o">&lt;&lt;</span> <span class="n">key</span> <span class="o">&lt;&lt;</span> <span class="s">", value= "</span> <span class="o">&lt;&lt;</span> <span class="n">cache</span><span class="p">.</span><span class="n">LocalPeek</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">CachePeekMode</span><span class="o">::</span><span class="n">ALL</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"]"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">cacheName</span><span class="p">;</span>
    <span class="kt">int32_t</span> <span class="n">key</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**
 * Binary type structure. Defines a set of functions required for type to be serialized and deserialized.
 */</span>
<span class="k">namespace</span> <span class="n">ignite</span>
<span class="p">{</span>
    <span class="k">namespace</span> <span class="n">binary</span>
    <span class="p">{</span>
        <span class="k">template</span><span class="o">&lt;</span><span class="p">&gt;</span>
        <span class="k">struct</span> <span class="nc">BinaryType</span><span class="o">&lt;</span><span class="n">FuncAffinityRun</span><span class="o">&gt;</span>
        <span class="p">{</span>
            <span class="k">static</span> <span class="kt">int32_t</span> <span class="n">GetTypeId</span><span class="p">()</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">GetBinaryStringHashCode</span><span class="p">(</span><span class="s">"FuncAffinityRun"</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">void</span> <span class="n">GetTypeName</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">dst</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">dst</span> <span class="o">=</span> <span class="s">"FuncAffinityRun"</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">int32_t</span> <span class="n">GetFieldId</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">GetBinaryStringHashCode</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">int32_t</span> <span class="n">GetHashCode</span><span class="p">(</span><span class="k">const</span> <span class="n">FuncAffinityRun</span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">bool</span> <span class="n">IsNull</span><span class="p">(</span><span class="k">const</span> <span class="n">FuncAffinityRun</span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">void</span> <span class="n">GetNull</span><span class="p">(</span><span class="n">FuncAffinityRun</span><span class="o">&amp;</span> <span class="n">dst</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">dst</span> <span class="o">=</span> <span class="n">FuncAffinityRun</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">void</span> <span class="n">Write</span><span class="p">(</span><span class="n">BinaryWriter</span><span class="o">&amp;</span> <span class="n">writer</span><span class="p">,</span> <span class="k">const</span> <span class="n">FuncAffinityRun</span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">writer</span><span class="p">.</span><span class="n">WriteString</span><span class="p">(</span><span class="s">"cacheName"</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">cacheName</span><span class="p">);</span>
                <span class="n">writer</span><span class="p">.</span><span class="n">WriteInt32</span><span class="p">(</span><span class="s">"key"</span><span class="p">,</span> <span class="n">obj</span><span class="p">.</span><span class="n">key</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">void</span> <span class="n">Read</span><span class="p">(</span><span class="n">BinaryReader</span><span class="o">&amp;</span> <span class="n">reader</span><span class="p">,</span> <span class="n">FuncAffinityRun</span><span class="o">&amp;</span> <span class="n">dst</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">dst</span><span class="p">.</span><span class="n">cacheName</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="n">ReadString</span><span class="p">(</span><span class="s">"cacheName"</span><span class="p">);</span>
                <span class="n">dst</span><span class="p">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">reader</span><span class="p">.</span><span class="n">ReadInt32</span><span class="p">(</span><span class="s">"key"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">IgniteConfiguration</span> <span class="n">cfg</span><span class="p">;</span>
    <span class="n">cfg</span><span class="p">.</span><span class="n">springCfgPath</span> <span class="o">=</span> <span class="s">"/path/to/configuration.xml"</span><span class="p">;</span>

    <span class="n">Ignite</span> <span class="n">ignite</span> <span class="o">=</span> <span class="n">Ignition</span><span class="o">::</span><span class="n">Start</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span>

    <span class="c1">// Get cache instance.</span>
    <span class="n">Cache</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetOrCreateCache</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"myCache"</span><span class="p">);</span>

    <span class="c1">// Get binding instance.</span>
    <span class="n">IgniteBinding</span> <span class="n">binding</span> <span class="o">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetBinding</span><span class="p">();</span>

    <span class="c1">// Registering our class as a compute function.</span>
    <span class="n">binding</span><span class="p">.</span><span class="n">RegisterComputeFunc</span><span class="o">&lt;</span><span class="n">FuncAffinityRun</span><span class="o">&gt;</span><span class="p">();</span>

    <span class="c1">// Get compute instance.</span>
    <span class="n">compute</span><span class="o">::</span><span class="n">Compute</span> <span class="n">compute</span> <span class="o">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetCompute</span><span class="p">();</span>

    <span class="kt">int</span> <span class="n">key</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1">// This closure will execute on the remote node where</span>
    <span class="c1">// data for the given 'key' is located.</span>
    <span class="n">compute</span><span class="p">.</span><span class="n">AffinityRun</span><span class="p">(</span><span class="n">cache</span><span class="p">.</span><span class="n">GetName</span><span class="p">(),</span> <span class="n">key</span><span class="p">,</span> <span class="n">FuncAffinityRun</span><span class="p">(</span><span class="n">cache</span><span class="p">.</span><span class="n">GetName</span><span class="p">(),</span> <span class="n">key</span><span class="p">));</span>
<span class="p">}</span></code></pre>
</div>
</div></code-tab></code-tabs>
</div>
</div>
<div class="sect1">
<h2 id="colocating-by-partition">Colocating by Partition</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>affinityCall(Collection&lt;String&gt; cacheNames, int partId, IgniteRunnable job)</code> and <code>affinityRun(Collection&lt;String&gt; cacheNames, int partId, IgniteRunnable job)</code> send a given task to the node where the partition with a given ID is located. This is useful when you need to retrieve objects for multiple keys and you know that the keys belong to the same partition. In this case, you can create one task instead of multiple task for each key.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s say you want to calculate the arithmetic mean of a specific field for a specific subset of keys.
If you want to distribute the computation, you can group the keys by partitions and send each group of keys to the node where the partition is located to get the values.
The number of groups and, therefore, the number of tasks is no more than the total number of partitions (default is 1024).
Below is a code snippet that illustrates this example.</p>
</div>
<code-tabs><code-tab data-tab='Java'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="c1">// this task sums up the values of the salary field for the given set of keys</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SumTask</span> <span class="kd">implements</span> <span class="nc">IgniteCallable</span><span class="o">&lt;</span><span class="nc">BigDecimal</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">keys</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">SumTask</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">keys</span> <span class="o">=</span> <span class="n">keys</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@IgniteInstanceResource</span>
    <span class="kd">private</span> <span class="nc">Ignite</span> <span class="n">ignite</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">BigDecimal</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>

        <span class="nc">IgniteCache</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">BinaryObject</span><span class="o">&gt;</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">cache</span><span class="o">(</span><span class="s">"person"</span><span class="o">).</span><span class="na">withKeepBinary</span><span class="o">();</span>

        <span class="nc">BigDecimal</span> <span class="n">sum</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BigDecimal</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">long</span> <span class="n">k</span> <span class="o">:</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">BinaryObject</span> <span class="n">person</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="na">localPeek</span><span class="o">(</span><span class="n">k</span><span class="o">,</span> <span class="nc">CachePeekMode</span><span class="o">.</span><span class="na">PRIMARY</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">person</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
                <span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">BigDecimal</span><span class="o">((</span><span class="kt">float</span><span class="o">)</span> <span class="n">person</span><span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"salary"</span><span class="o">)));</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">sum</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">calculateAverage</span><span class="o">(</span><span class="nc">Ignite</span> <span class="n">ignite</span><span class="o">,</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>

    <span class="c1">// get the affinity function configured for the cache</span>
    <span class="nc">Affinity</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">affinityFunc</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">affinity</span><span class="o">(</span><span class="s">"person"</span><span class="o">);</span>

    <span class="c1">// this map stores collections of keys for each partition</span>
    <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;&gt;</span> <span class="n">partMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="n">keys</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">k</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">partId</span> <span class="o">=</span> <span class="n">affinityFunc</span><span class="o">.</span><span class="na">partition</span><span class="o">(</span><span class="n">k</span><span class="o">);</span>

        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">keysByPartition</span> <span class="o">=</span> <span class="n">partMap</span><span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span><span class="n">partId</span><span class="o">,</span> <span class="n">key</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;());</span>
        <span class="n">keysByPartition</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">k</span><span class="o">);</span>
    <span class="o">});</span>

    <span class="nc">BigDecimal</span> <span class="n">total</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BigDecimal</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>

    <span class="nc">IgniteCompute</span> <span class="n">compute</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">compute</span><span class="o">();</span>

    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">caches</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"person"</span><span class="o">);</span>

    <span class="c1">// iterate over all partitions</span>
    <span class="k">for</span> <span class="o">(</span><span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;&gt;</span> <span class="n">pair</span> <span class="o">:</span> <span class="n">partMap</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
        <span class="c1">// send a task that gets specific keys for the partition</span>
        <span class="nc">BigDecimal</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">compute</span><span class="o">.</span><span class="na">affinityCall</span><span class="o">(</span><span class="n">caches</span><span class="o">,</span> <span class="n">pair</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">intValue</span><span class="o">(),</span> <span class="k">new</span> <span class="nc">SumTask</span><span class="o">(</span><span class="n">pair</span><span class="o">.</span><span class="na">getValue</span><span class="o">()));</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">total</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">sum</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"the average salary is "</span> <span class="o">+</span> <span class="n">total</span><span class="o">.</span><span class="na">floatValue</span><span class="o">()</span> <span class="o">/</span> <span class="n">keys</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
<span class="o">}</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C#/.NET' data-unavailable='true'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>This API is not presently available for C#/.NET.</code></pre>
</div>
</div></code-tab><code-tab data-tab='C++' data-unavailable='true'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>This API is not presently available for C++.</code></pre>
</div>
</div></code-tab></code-tabs>
<div class="paragraph">
<p>If you want to process all the data in the cache, you can iterate over all cache partitions and send tasks that process the data stored on each individual partition.</p>
</div>
<code-tabs><code-tab data-tab='Java'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="c1">// this task sums up the value of the 'salary' field for all objects stored in</span>
<span class="c1">// the given partition</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SumByPartitionTask</span> <span class="kd">implements</span> <span class="nc">IgniteCallable</span><span class="o">&lt;</span><span class="nc">BigDecimal</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">partId</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">SumByPartitionTask</span><span class="o">(</span><span class="kt">int</span> <span class="n">partId</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">partId</span> <span class="o">=</span> <span class="n">partId</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@IgniteInstanceResource</span>
    <span class="kd">private</span> <span class="nc">Ignite</span> <span class="n">ignite</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">BigDecimal</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// use binary objects to avoid deserialization</span>
        <span class="nc">IgniteCache</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">BinaryObject</span><span class="o">&gt;</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">cache</span><span class="o">(</span><span class="s">"person"</span><span class="o">).</span><span class="na">withKeepBinary</span><span class="o">();</span>

        <span class="nc">BigDecimal</span> <span class="n">total</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BigDecimal</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
        <span class="k">try</span> <span class="o">(</span><span class="nc">QueryCursor</span><span class="o">&lt;</span><span class="nc">Cache</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">BinaryObject</span><span class="o">&gt;&gt;</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">cache</span>
                <span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="k">new</span> <span class="nc">ScanQuery</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">BinaryObject</span><span class="o">&gt;(</span><span class="n">partId</span><span class="o">).</span><span class="na">setLocal</span><span class="o">(</span><span class="kc">true</span><span class="o">)))</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Cache</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">,</span> <span class="nc">BinaryObject</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">cursor</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">total</span> <span class="o">=</span> <span class="n">total</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">BigDecimal</span><span class="o">((</span><span class="kt">float</span><span class="o">)</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">field</span><span class="o">(</span><span class="s">"salary"</span><span class="o">)));</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">total</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C#/.NET' data-unavailable='true'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>This API is not presently available for C#/.NET.</code></pre>
</div>
</div></code-tab><code-tab data-tab='C++' data-unavailable='true'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>This API is not presently available for C++.</code></pre>
</div>
</div></code-tab></code-tabs>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<h3 id="performance-considerations" class="discrete">Performance Considerations</h3>
<div class="paragraph">
<p>Colocated computations yield performance benefits when the amount of the data you want to process is sufficiently large. In some cases, when the amount of data is small, a <a href="/docs/2.9.0/key-value-api/using-scan-queries">scan query</a> may perform better.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="entry-processor">Entry Processor</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An entry processor is used to process cache entries on the nodes where they are stored and return the result of the processing. With an entry processor, you do not have to transfer the entire object to perform an operation with it, you can perform the operation remotely and only transfer the results.</p>
</div>
<div class="paragraph">
<p>If an entry processor sets the value for an entry that does not exist, the entry is added to the cache.</p>
</div>
<div class="paragraph">
<p>Entry processors are executed atomically within a lock on the given cache key.</p>
</div>
<code-tabs><code-tab data-tab='Java'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="nc">IgniteCache</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">ignite</span><span class="o">.</span><span class="na">cache</span><span class="o">(</span><span class="s">"mycache"</span><span class="o">);</span>

<span class="c1">// Increment the value for a specific key by 1.</span>
<span class="c1">// The operation will be performed on the node where the key is stored.</span>
<span class="c1">// Note that if the cache does not contain an entry for the given key, it will</span>
<span class="c1">// be created.</span>
<span class="n">cache</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="s">"mykey"</span><span class="o">,</span> <span class="o">(</span><span class="n">entry</span><span class="o">,</span> <span class="n">args</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="nc">Integer</span> <span class="n">val</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>

    <span class="n">entry</span><span class="o">.</span><span class="na">setValue</span><span class="o">(</span><span class="n">val</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">val</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>

    <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">});</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C#/.NET'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="k">void</span> <span class="nf">CacheInvoke</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">ignite</span> <span class="p">=</span> <span class="n">Ignition</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>

    <span class="kt">var</span> <span class="n">cache</span> <span class="p">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetOrCreateCache</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;(</span><span class="s">"myCache"</span><span class="p">);</span>

    <span class="kt">var</span> <span class="n">proc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Processor</span><span class="p">();</span>

    <span class="c1">// Increment cache value 10 times</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">10</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="n">cache</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">proc</span><span class="p">,</span> <span class="m">5</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Processor</span> <span class="p">:</span> <span class="n">ICacheEntryProcessor</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="nf">Process</span><span class="p">(</span><span class="n">IMutableCacheEntry</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">&gt;</span> <span class="n">entry</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arg</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">entry</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="n">entry</span><span class="p">.</span><span class="n">Exists</span> <span class="p">?</span> <span class="n">arg</span> <span class="p">:</span> <span class="n">entry</span><span class="p">.</span><span class="n">Value</span> <span class="p">+</span> <span class="n">arg</span><span class="p">;</span>

        <span class="k">return</span> <span class="n">entry</span><span class="p">.</span><span class="n">Value</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div></code-tab><code-tab data-tab='C++'><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cm">/**
 * Processor for invoke method.
 */</span>
<span class="k">class</span> <span class="nc">IncrementProcessor</span> <span class="o">:</span> <span class="k">public</span> <span class="n">cache</span><span class="o">::</span><span class="n">CacheEntryProcessor</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int32_t</span><span class="p">,</span> <span class="kt">int32_t</span><span class="p">,</span> <span class="kt">int32_t</span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="nl">public:</span>
    <span class="cm">/**
     * Constructor.
     */</span>
    <span class="n">IncrementProcessor</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// No-op.</span>
    <span class="p">}</span>

    <span class="cm">/**
     * Copy constructor.
     *
     * @param other Other instance.
     */</span>
    <span class="n">IncrementProcessor</span><span class="p">(</span><span class="k">const</span> <span class="n">IncrementProcessor</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// No-op.</span>
    <span class="p">}</span>

    <span class="cm">/**
     * Assignment operator.
     *
     * @param other Other instance.
     * @return This instance.
     */</span>
    <span class="n">IncrementProcessor</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">IncrementProcessor</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/**
     * Call instance.
     */</span>
    <span class="k">virtual</span> <span class="kt">int32_t</span> <span class="n">Process</span><span class="p">(</span><span class="n">MutableCacheEntry</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int32_t</span><span class="o">&gt;&amp;</span> <span class="n">entry</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">arg</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Increment the value for a specific key by 1.</span>
        <span class="c1">// The operation will be performed on the node where the key is stored.</span>
        <span class="c1">// Note that if the cache does not contain an entry for the given key, it will</span>
        <span class="c1">// be created.</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">entry</span><span class="p">.</span><span class="n">IsExists</span><span class="p">())</span>
            <span class="n">entry</span><span class="p">.</span><span class="n">SetValue</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">else</span>
            <span class="n">entry</span><span class="p">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="n">GetValue</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">entry</span><span class="p">.</span><span class="n">GetValue</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="cm">/**
 * Binary type structure. Defines a set of functions required for type to be serialized and deserialized.
 */</span>
<span class="k">namespace</span> <span class="n">ignite</span>
<span class="p">{</span>
    <span class="k">namespace</span> <span class="n">binary</span>
    <span class="p">{</span>
        <span class="k">template</span><span class="o">&lt;</span><span class="p">&gt;</span>
        <span class="k">struct</span> <span class="nc">BinaryType</span><span class="o">&lt;</span><span class="n">IncrementProcessor</span><span class="o">&gt;</span>
        <span class="p">{</span>
            <span class="k">static</span> <span class="kt">int32_t</span> <span class="n">GetTypeId</span><span class="p">()</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">GetBinaryStringHashCode</span><span class="p">(</span><span class="s">"IncrementProcessor"</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">void</span> <span class="n">GetTypeName</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">dst</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">dst</span> <span class="o">=</span> <span class="s">"IncrementProcessor"</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">int32_t</span> <span class="n">GetFieldId</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">name</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">GetBinaryStringHashCode</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">int32_t</span> <span class="n">GetHashCode</span><span class="p">(</span><span class="k">const</span> <span class="n">IncrementProcessor</span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">bool</span> <span class="n">IsNull</span><span class="p">(</span><span class="k">const</span> <span class="n">IncrementProcessor</span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">void</span> <span class="n">GetNull</span><span class="p">(</span><span class="n">IncrementProcessor</span><span class="o">&amp;</span> <span class="n">dst</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">dst</span> <span class="o">=</span> <span class="n">IncrementProcessor</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">void</span> <span class="n">Write</span><span class="p">(</span><span class="n">BinaryWriter</span><span class="o">&amp;</span> <span class="n">writer</span><span class="p">,</span> <span class="k">const</span> <span class="n">IncrementProcessor</span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// No-op.</span>
            <span class="p">}</span>

            <span class="k">static</span> <span class="kt">void</span> <span class="n">Read</span><span class="p">(</span><span class="n">BinaryReader</span><span class="o">&amp;</span> <span class="n">reader</span><span class="p">,</span> <span class="n">IncrementProcessor</span><span class="o">&amp;</span> <span class="n">dst</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// No-op.</span>
            <span class="p">}</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">IgniteConfiguration</span> <span class="n">cfg</span><span class="p">;</span>
    <span class="n">cfg</span><span class="p">.</span><span class="n">springCfgPath</span> <span class="o">=</span> <span class="s">"platforms/cpp/examples/put-get-example/config/example-cache.xml"</span><span class="p">;</span>

    <span class="n">Ignite</span> <span class="n">ignite</span> <span class="o">=</span> <span class="n">Ignition</span><span class="o">::</span><span class="n">Start</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span>

    <span class="c1">// Get cache instance.</span>
    <span class="n">Cache</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int32_t</span><span class="o">&gt;</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetOrCreateCache</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span> <span class="kt">int32_t</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"myCache"</span><span class="p">);</span>

    <span class="c1">// Get binding instance.</span>
    <span class="n">IgniteBinding</span> <span class="n">binding</span> <span class="o">=</span> <span class="n">ignite</span><span class="p">.</span><span class="n">GetBinding</span><span class="p">();</span>

    <span class="c1">// Registering our class as a cache entry processor.</span>
    <span class="n">binding</span><span class="p">.</span><span class="n">RegisterCacheEntryProcessor</span><span class="o">&lt;</span><span class="n">IncrementProcessor</span><span class="o">&gt;</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">key</span><span class="p">(</span><span class="s">"mykey"</span><span class="p">);</span>
    <span class="n">IncrementProcessor</span> <span class="n">inc</span><span class="p">;</span>

    <span class="n">cache</span><span class="p">.</span><span class="n">Invoke</span><span class="o">&lt;</span><span class="kt">int32_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">inc</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span></code></pre>
</div>
</div></code-tab></code-tabs>
</div>
</div>
        <div class="copyright">
 © 2020 The Apache Software Foundation.<br/>
Apache, Apache Ignite, the Apache feather and the Apache Ignite logo are either registered trademarks or trademarks of The Apache Software Foundation. 

</div>

    </article>
    <nav class="right-nav" data-swiftype-index='false'>
    <ul class="sectlevel1">
<li><a href="#colocating-by-key">Colocating by Key</a></li>
<li><a href="#colocating-by-partition">Colocating by Partition</a></li>
<li><a href="#entry-processor">Entry Processor</a></li>
</ul>
          
      
<footer>
</footer>

</nav>
    
</section>
<script type='module' src='/assets/js/code-copy-to-clipboard.js' async crossorigin></script>

    <script>
    // inits deep anchors -- needs to be done here because of https://www.bryanbraun.com/anchorjs/#dont-run-it-too-late 
    anchors.add('.page-docs h1, .page-docs h2, .page-docs h3:not(.discrete), .page-docs h4, .page-docs h5');
    anchors.options = {
        placement: 'right',
        visible: 'always'
    };
    </script>
    <!-- load google fonts async -->
    <script type="text/javascript">
    WebFontConfig = {
      google: { families: [ 'Open+Sans:300,400,600,700&display=swap' ] }
    };
    (function() {
      var wf = document.createElement('script');
      wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
      wf.type = 'text/javascript';
      wf.async = 'true';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(wf, s);
    })(); </script>
    <script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script>
      docsearch({
        // Your apiKey and indexName will be given to you once
        // we create your config
        apiKey: '3eee686c0ebe39eff3baeb18c56fa5f8', 
        indexName: 'apache_ignite',
        // Replace inputSelector with a CSS selector
        // matching your search input
        inputSelector: '#search-input',
        // algoliaOptions: { 'facetFilters': ["version:$VERSION"] },

        // Set debug to true to inspect the dropdown
        debug: false,
      });
    </script>
<script type='module' src='/assets/js/index.js?1600286556' async crossorigin></script>
<script type='module' src='/assets/js/versioning.js?1600286556' async crossorigin></script>
</body>

</html>
