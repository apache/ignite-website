"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[9568],{28146:(t,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>d,default:()=>w,frontMatter:()=>r,metadata:()=>h,toc:()=>l});const h=JSON.parse('{"id":"sql/reference/language-definition/dml","title":"Data Manipulation Language (DML)","description":"{/*","source":"@site/docs/sql/reference/language-definition/dml.mdx","sourceDirName":"sql/reference/language-definition","slug":"/sql/reference/language-definition/dml","permalink":"/docs/ignite3/3.1.0/sql/reference/language-definition/dml","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"dml","title":"Data Manipulation Language (DML)"},"sidebar":"tutorialSidebar","previous":{"title":"Data Definition Language (DDL)","permalink":"/docs/ignite3/3.1.0/sql/reference/language-definition/ddl"},"next":{"title":"Distribution Zones","permalink":"/docs/ignite3/3.1.0/sql/reference/language-definition/distribution-zones"}}');var s=i(74848),n=i(28453),a=i(63367);const r={id:"dml",title:"Data Manipulation Language (DML)"},d=void 0,o={},l=[{value:"DELETE",id:"delete",level:2},{value:"Parameters",id:"parameters",level:3},{value:"INSERT",id:"insert",level:2},{value:"MERGE",id:"merge",level:2},{value:"Parameters",id:"parameters-1",level:3},{value:"UPDATE",id:"update",level:2},{value:"Parameters",id:"parameters-2",level:3}];function c(t){const e={admonition:"admonition",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",ul:"ul",...(0,n.R)(),...t.components};return(0,s.jsxs)(s.Fragment,{children:["\n","\n",(0,s.jsx)(e.p,{children:"This section walks you through all data manipulation language (DML) commands supported by Apache Ignite 3."}),"\n",(0,s.jsx)(e.h2,{id:"delete",children:"DELETE"}),"\n",(0,s.jsx)(e.p,{children:"Deletes data from a table."}),"\n",(0,s.jsx)(a.A,{children:"\nDiagram(\nTerminal('DELETE FROM'),\nNonTerminal('qualified_table_name', {href:'./grammar-reference#qualified_table_name'}),\nOptional(\nSequence(\nOptional('AS'),\nNonTerminal('alias'),\n)\n),\nOptional(\nSequence(\nNonTerminal('WHERE'),\nTerminal('booleanExpression')\n)\n)\n)\n"}),"\n",(0,s.jsx)(e.h3,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"alias"})," - an SQL alias for an expression or value."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"booleanExpression"})," - an SQL expression that returns a boolean value. Only the records for which ",(0,s.jsx)(e.code,{children:"TRUE"})," was returned will be deleted. If not specified, all records are deleted."]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"insert",children:"INSERT"}),"\n",(0,s.jsx)(e.p,{children:"Inserts data into a table."}),"\n",(0,s.jsx)(a.A,{children:"\nDiagram(\nTerminal('INSERT INTO'),\nNonTerminal('qualified_table_name', {href:'./grammar-reference#qualified_table_name'}),\nOptional(\nNonTerminal('column_list', {href:'./grammar-reference#column_list'}),\n),\nNonTerminal('query', {href:'./grammar-reference#query'})\n)\n"}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"merge",children:"MERGE"}),"\n",(0,s.jsx)(e.p,{children:"Merges data into a table."}),"\n",(0,s.jsx)(a.A,{children:"\nDiagram(\nTerminal('MERGE INTO'),\nNonTerminal('qualified_table_name', {href:'./grammar-reference#qualified_table_name'}),\nOptional(\nSequence(\nOptional('AS'),\nNonTerminal('alias'),\n)\n),\nTerminal('USING'),\nNonTerminal('qualified_table_name', {href:'./grammar-reference#qualified_table_name'}),\nTerminal('ON'),\nNonTerminal('booleanExpression'),\nEnd({type:'complex'})\n)\n"}),"\n",(0,s.jsx)(a.A,{children:"\nDiagram(\nStart({type:'complex'}),\nOptional(\nSequence(\nNonTerminal('WHEN MATCHED THEN UPDATE SET'),\nOneOrMore(Sequence(Terminal('assign', {href:'./grammar-reference#assign'})\n),\nTerminal(',')\n))),\nOptional(\nSequence(\nNonTerminal('WHEN NOT MATCHED THEN INSERT VALUES'),\nNonTerminal('('),\nOneOrMore(Sequence(Terminal('value')\n),\nTerminal(',')\n),\nNonTerminal(')'),\n)))\n"}),"\n",(0,s.jsx)(e.admonition,{type:"note",children:(0,s.jsxs)(e.p,{children:["At least one of the ",(0,s.jsx)(e.code,{children:"WHEN MATCHED"})," and ",(0,s.jsx)(e.code,{children:"WHEN NOT MATCHED"})," clauses must be present."]})}),"\n",(0,s.jsx)(e.h3,{id:"parameters-1",children:"Parameters"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"alias"})," - an SQL alias for an expression or value."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"booleanExpression"})," - an SQL expression that returns a boolean value. If ",(0,s.jsx)(e.code,{children:"TRUE"})," is returned, the ",(0,s.jsx)(e.code,{children:"WHEN MATCHED"})," clause is executed, otherwise the ",(0,s.jsx)(e.code,{children:"WHEN NOT MATCHED"})," is executed."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"value"})," - arbitrary value that will be inserted into the table during the operation."]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"update",children:"UPDATE"}),"\n",(0,s.jsx)(e.p,{children:"Updates data in a table."}),"\n",(0,s.jsx)(a.A,{children:"\nDiagram(\nTerminal('UPDATE'),\nNonTerminal('qualified_table_name', {href:'./grammar-reference#qualified_table_name'}),\nTerminal('SET'),\nOneOrMore(Sequence(Terminal('assign', {href:'./grammar-reference#assign'})\n),\nTerminal(',')\n),\nOptional(\nSequence(\nTerminal('WHERE'),\nNonTerminal('booleanExpression')\n)\n)\n)\n"}),"\n",(0,s.jsx)(e.h3,{id:"parameters-2",children:"Parameters"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"booleanExpression"})," - an SQL expression that returns a boolean value. Only the records for which ",(0,s.jsx)(e.code,{children:"TRUE"})," was returned will be updated. If not specified, all records will be updated."]}),"\n"]})]})}function w(t={}){const{wrapper:e}={...(0,n.R)(),...t.components};return e?(0,s.jsx)(e,{...t,children:(0,s.jsx)(c,{...t})}):c(t)}},28453:(t,e,i)=>{i.d(e,{R:()=>a,x:()=>r});var h=i(96540);const s={},n=h.createContext(s);function a(t){const e=h.useContext(n);return h.useMemo(function(){return"function"==typeof t?t(e):{...e,...t}},[e,t])}function r(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(s):t.components||s:a(t.components),h.createElement(n.Provider,{value:e},t.children)}},63367:(t,e,i)=>{i.d(e,{A:()=>I});var h=i(96540);const s={},n=!1,a=8,r=10,d="railroad-diagram",o=!0,l="center",c=8.5,w=7;class m{constructor(t,e,i){this.children=i||[],this.tagName=t,this.attrs=L(e,{})}format(t,e,i){}addTo(t){if(t instanceof m)return t.children.push(this),this;var e=this.toSVG();return t.appendChild(e),e}toSVG(){var t=function(t,e,i){e=e||{},i=i||"";var h=document.createElementNS("http://www.w3.org/2000/svg",t);for(var s in e)"xlink:href"===s?h.setAttributeNS("http://www.w3.org/1999/xlink","href",e[s]):h.setAttribute(s,e[s]);return h.textContent=i,h}(this.tagName,this.attrs);return"string"==typeof this.children?t.textContent=this.children:this.children.forEach(function(e){t.appendChild(e.toSVG())}),t}toString(){var t="<"+this.tagName,e="g"==this.tagName||"svg"==this.tagName;for(var i in this.attrs)t+=" "+i+'="'+(this.attrs[i]+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;")+'"';return t+=">",e&&(t+="\n"),"string"==typeof this.children?t+=this.children.replace(/[*_\`\[\]<&]/g,function(t){return"&#"+t.charCodeAt(0)+";"}):this.children.forEach(function(e){t+=e}),t+="</"+this.tagName+">\n"}walk(t){t(this)}}class u extends m{constructor(t,e){super("path"),this.attrs.d="M"+t+" "+e}m(t,e){return this.attrs.d+="m"+t+" "+e,this}h(t){return this.attrs.d+="h"+t,this}right(t){return this.h(Math.max(0,t))}left(t){return this.h(-Math.max(0,t))}v(t){return this.attrs.d+="v"+t,this}down(t){return this.v(Math.max(0,t))}up(t){return this.v(-Math.max(0,t))}arc(t){var e,i=r,h=r;return"e"!=t[0]&&"w"!=t[1]||(i*=-1),"s"!=t[0]&&"n"!=t[1]||(h*=-1),e="ne"==t||"es"==t||"sw"==t||"wn"==t?1:0,this.attrs.d+="a"+r+" "+r+" 0 0 "+e+" "+i+" "+h,this}arc_8(t,e){const i=r,h=1/Math.sqrt(2)*i,s=i-h;let n="a "+i+" "+i+" 0 0 "+("cw"==e?"1":"0")+" ";const a=t+e;return n+=("ncw"==a?[h,s]:"necw"==a?[s,h]:"ecw"==a?[-s,h]:"secw"==a?[-h,s]:"scw"==a?[-h,-s]:"swcw"==a?[-s,-h]:"wcw"==a?[s,-h]:"nwcw"==a?[h,-s]:"nccw"==a?[-h,s]:"nwccw"==a?[-s,h]:"wccw"==a?[s,h]:"swccw"==a?[h,s]:"sccw"==a?[h,-s]:"seccw"==a?[s,-h]:"eccw"==a?[-s,-h]:"neccw"==a?[-h,-s]:null).join(" "),this.attrs.d+=n,this}l(t,e){return this.attrs.d+="l"+t+" "+e,this}format(){return this.attrs.d+="h.5",this}}class p extends m{constructor(t,e,i,h){super(t,i,h),this.items=e.map(W)}walk(t){t(this),this.items.forEach(e=>e.walk(t))}}class g extends p{constructor(...t){super("svg",t,{class:d}),this.items[0]instanceof _||this.items.unshift(new _),this.items[this.items.length-1]instanceof q||this.items.push(new q),this.up=this.down=this.height=this.width=0;for(const e of this.items)this.width+=e.width+(e.needsSpace?20:0),this.up=Math.max(this.up,e.up-this.height),this.height+=e.height,this.down=Math.max(this.down-e.height,e.down);this.formatted=!1}format(t,e,i,h){t=L(t,20),e=L(e,t,20),i=L(i,t,20);var s=h=L(h,e,20),n=t;n+=this.up;for(var a=new m("g",o?{transform:"translate(.5 .5)"}:{}),r=0;r<this.items.length;r++){var d=this.items[r];d.needsSpace&&(new u(s,n).h(10).addTo(a),s+=10),d.format(s,n,d.width).addTo(a),s+=d.width,n+=d.height,d.needsSpace&&(new u(s,n).h(10).addTo(a),s+=10)}return this.attrs.width=this.width+h+e,this.attrs.height=this.up+this.height+this.down+t+i,this.attrs.viewBox="0 0 "+this.attrs.width+" "+this.attrs.height,a.addTo(this),this.formatted=!0,this}addTo(t){if(!t){var e=document.getElementsByTagName("script");t=(e=e[e.length-1]).parentNode}return super.addTo.call(this,t)}toSVG(){return this.formatted||this.format(),super.toSVG.call(this)}toString(){return this.formatted||this.format(),super.toString.call(this)}toStandalone(t){this.formatted||this.format();const e=new m("style",{},t||"\n\tsvg {\n\t\tbackground-color: hsl(30,20%,95%);\n\t}\n\tpath {\n\t\tstroke-width: 3;\n\t\tstroke: black;\n\t\tfill: rgba(0,0,0,0);\n\t}\n\ttext {\n\t\tfont: bold 14px monospace;\n\t\ttext-anchor: middle;\n\t\twhite-space: pre;\n\t}\n\ttext.diagram-text {\n\t\tfont-size: 12px;\n\t}\n\ttext.diagram-arrow {\n\t\tfont-size: 16px;\n\t}\n\ttext.label {\n\t\ttext-anchor: start;\n\t}\n\ttext.comment {\n\t\tfont: italic 12px monospace;\n\t}\n\tg.non-terminal text {\n\t\t/*font-style: italic;*/\n\t}\n\trect {\n\t\tstroke-width: 3;\n\t\tstroke: black;\n\t\tfill: hsl(120,100%,90%);\n\t}\n\trect.group-box {\n\t\tstroke: gray;\n\t\tstroke-dasharray: 10 5;\n\t\tfill: none;\n\t}\n\tpath.diagram-text {\n\t\tstroke-width: 3;\n\t\tstroke: black;\n\t\tfill: white;\n\t\tcursor: help;\n\t}\n\tg.diagram-text:hover path.diagram-text {\n\t\tfill: #eee;\n\t}");this.children.push(e),this.attrs.xmlns="http://www.w3.org/2000/svg",this.attrs["xmlns:xlink"]="http://www.w3.org/1999/xlink";const i=super.toString.call(this);return this.children.pop(),delete this.attrs.xmlns,i}}s.Diagram=(...t)=>new g(...t);class f extends m{constructor(...t){var e=new g(...t);return e.items[0]=new _({type:"complex"}),e.items[e.items.length-1]=new q({type:"complex"}),e}}s.ComplexDiagram=(...t)=>new f(...t);class x extends p{constructor(...t){super("g",t);this.items.length;this.needsSpace=!0,this.up=this.down=this.height=this.width=0;for(var e=0;e<this.items.length;e++){var i=this.items[e];this.width+=i.width+(i.needsSpace?20:0),this.up=Math.max(this.up,i.up-this.height),this.height+=i.height,this.down=Math.max(this.down-i.height,i.down)}this.items[0].needsSpace&&(this.width-=10),this.items[this.items.length-1].needsSpace&&(this.width-=10),n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="sequence")}format(t,e,i){var h=H(i,this.width);new u(t,e).h(h[0]).addTo(this),new u(t+h[0]+this.width,e+this.height).h(h[1]).addTo(this),t+=h[0];for(var s=0;s<this.items.length;s++){var n=this.items[s];n.needsSpace&&s>0&&(new u(t,e).h(10).addTo(this),t+=10),n.format(t,e,n.width).addTo(this),t+=n.width,e+=n.height,n.needsSpace&&s<this.items.length-1&&(new u(t,e).h(10).addTo(this),t+=10)}return this}}s.Sequence=(...t)=>new x(...t);class T extends p{constructor(...t){if(super("g",t),0===t.length)throw new RangeError("Stack() must have at least one child.");this.width=Math.max.apply(null,this.items.map(function(t){return t.width+(t.needsSpace?20:0)})),this.items.length>1&&(this.width+=2*r),this.needsSpace=!0,this.up=this.items[0].up,this.down=this.items[this.items.length-1].down,this.height=0;for(var e=this.items.length-1,i=0;i<this.items.length;i++){var h=this.items[i];this.height+=h.height,i>0&&(this.height+=Math.max(2*r,h.up+a)),i<e&&(this.height+=Math.max(2*r,h.down+a))}n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="stack")}format(t,e,i){var h=H(i,this.width);new u(t,e).h(h[0]).addTo(this);var s=t+=h[0];this.items.length>1&&(new u(t,e).h(r).addTo(this),t+=r);for(var n=0;n<this.items.length;n++){var d=this.items[n],o=this.width-(this.items.length>1?2*r:0);d.format(t,e,o).addTo(this),t+=o,e+=d.height,n!==this.items.length-1&&(new u(t,e).arc("ne").down(Math.max(0,d.down+a-2*r)).arc("es").left(o).arc("nw").down(Math.max(0,this.items[n+1].up+a-2*r)).arc("ws").addTo(this),e+=Math.max(d.down+a,2*r)+Math.max(this.items[n+1].up+a,2*r),t=s+r)}return this.items.length>1&&(new u(t,e).h(r).addTo(this),t+=r),new u(t,e).h(h[1]).addTo(this),this}}s.Stack=(...t)=>new T(...t);class v extends p{constructor(...t){if(super("g",t),0===t.length)throw new RangeError("OptionalSequence() must have at least one child.");if(1===t.length)return new x(t);var e=r;this.needsSpace=!1,this.width=0,this.up=0,this.height=U(this.items,function(t){return t.height}),this.down=this.items[0].down;for(var i=0,h=0;h<this.items.length;h++){var s=this.items[h];this.up=Math.max(this.up,Math.max(2*e,s.up+a)-i),i+=s.height,h>0&&(this.down=Math.max(this.height+this.down,i+Math.max(2*e,s.down+a))-this.height);var d=(s.needsSpace?10:0)+s.width;this.width+=0===h?e+Math.max(d,e):2*e+Math.max(d,e)+e}n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="optseq")}format(t,e,i){var h=r,s=H(i,this.width);new u(t,e).right(s[0]).addTo(this),new u(t+s[0]+this.width,e+this.height).right(s[1]).addTo(this),t+=s[0];for(var n=e-this.up,d=this.items.length-1,o=0;o<this.items.length;o++){var l=this.items[o],c=l.needsSpace?10:0,w=l.width+c;0===o?(new u(t,e).arc("se").up(e-n-2*h).arc("wn").right(w-h).arc("ne").down(e+l.height-n-2*h).arc("ws").addTo(this),new u(t,e).right(c+h).addTo(this),l.format(t+c+h,e,l.width).addTo(this),t+=w+h,e+=l.height):o<d?(new u(t,n).right(2*h+Math.max(w,h)+h).arc("ne").down(e-n+l.height-2*h).arc("ws").addTo(this),new u(t,e).right(2*h).addTo(this),l.format(t+2*h,e,l.width).addTo(this),new u(t+l.width+2*h,e+l.height).right(c+h).addTo(this),new u(t,e).arc("ne").down(l.height+Math.max(l.down+a,2*h)-2*h).arc("ws").right(w-h).arc("se").up(l.down+a-2*h).arc("wn").addTo(this),t+=2*h+Math.max(w,h)+h,e+=l.height):(new u(t,e).right(2*h).addTo(this),l.format(t+2*h,e,l.width).addTo(this),new u(t+2*h+l.width,e+l.height).right(c+h).addTo(this),new u(t,e).arc("ne").down(l.height+Math.max(l.down+a,2*h)-2*h).arc("ws").right(w-h).arc("se").up(l.down+a-2*h).arc("wn").addTo(this))}return this}}s.OptionalSequence=(...t)=>new v(...t);class M extends p{constructor(...t){if(super("g",t),1===t.length)return new x(t);if(2!==t.length)throw new RangeError("AlternatingSequence() must have one or two children.");this.needsSpace=!1;const e=r,i=a,h=Math.max,s=this.items[0],d=this.items[1],o=1/Math.sqrt(2)*e*2,l=(1-1/Math.sqrt(2))*e*2,c=Math.max(e,a),w=c-l+o,m=h(e+e,c/2+e+e,c/2+i+s.down);this.up=m+s.height+s.up;const u=h(e+e,c/2+e+e,c/2+i+d.up);this.down=u+d.height+d.down,this.height=0;const p=2*(s.needsSpace?10:0)+s.width,g=2*(d.needsSpace?10:0)+d.width;this.width=2*e+h(p,w,g)+2*e,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="altseq")}format(t,e,i){const h=r,s=H(i,this.width);new u(t,e).right(s[0]).addTo(this),t+=s[0],new u(t+this.width,e).right(s[1]).addTo(this);const n=this.items[0],d=this.items[1],o=this.up-n.up,l=this.up-n.up-n.height;new u(t,e).arc("se").up(o-2*h).arc("wn").addTo(this),n.format(t+2*h,e-o,this.width-4*h).addTo(this),new u(t+this.width-2*h,e-l).arc("ne").down(l-2*h).arc("ws").addTo(this);const c=this.down-d.down-d.height,w=this.down-d.down;new u(t,e).arc("ne").down(c-2*h).arc("ws").addTo(this),d.format(t+2*h,e+c,this.width-4*h).addTo(this),new u(t+this.width-2*h,e+w).arc("se").up(w-2*h).arc("wn").addTo(this);const m=1/Math.sqrt(2)*h*2,p=(1-1/Math.sqrt(2))*h*2,g=Math.max(h,a),f=g-p+m,x=(this.width-4*h-f)/2;return new u(t+h,e-g/2-h).arc("ws").right(x).arc_8("n","cw").l(f-m,g-p).arc_8("sw","ccw").right(x).arc("ne").addTo(this),new u(t+h,e+g/2+h).arc("wn").right(x).arc_8("s","ccw").l(f-m,-(g-p)).arc_8("nw","cw").right(x).arc("se").addTo(this),this}}s.AlternatingSequence=(...t)=>new M(...t);class b extends p{constructor(t,...e){if(super("g",e),"number"!=typeof t||t!==Math.floor(t))throw new TypeError("The first argument of Choice() must be an integer.");if(t<0||t>=e.length)throw new RangeError("The first argument of Choice() must be an index for one of the items.");this.normal=t;var i,h=e.length-1;this.width=Math.max.apply(null,this.items.map(function(t){return t.width}))+4*r,this.height=this.items[t].height,this.up=this.items[0].up;for(var s=0;s<t;s++)i=s==t-1?2*r:r,this.up+=Math.max(i,this.items[s].height+this.items[s].down+a+this.items[s+1].up);for(this.down=this.items[h].down,s=t+1;s<=h;s++)i=s==t+1?2*r:r,this.down+=Math.max(i,this.items[s-1].height+this.items[s-1].down+a+this.items[s].up);this.down-=this.items[t].height,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="choice")}format(t,e,i){var h=H(i,this.width);new u(t,e).h(h[0]).addTo(this),new u(t+h[0]+this.width,e+this.height).h(h[1]).addTo(this),t+=h[0];for(var s,n=this.items.length-1,d=this.width-4*r,o=this.normal-1;o>=0;o--){let i=this.items[o];o==this.normal-1&&(s=Math.max(2*r,this.items[this.normal].up+a+i.down+i.height)),new u(t,e).arc("se").up(s-2*r).arc("wn").addTo(this),i.format(t+2*r,e-s,d).addTo(this),new u(t+2*r+d,e-s+i.height).arc("ne").down(s-i.height+this.height-2*r).arc("ws").addTo(this),s+=Math.max(r,i.up+a+(0===o?0:this.items[o-1].down+this.items[o-1].height))}for(new u(t,e).right(2*r).addTo(this),this.items[this.normal].format(t+2*r,e,d).addTo(this),new u(t+2*r+d,e+this.height).right(2*r).addTo(this),o=this.normal+1;o<=n;o++){let i=this.items[o];o==this.normal+1&&(s=Math.max(2*r,this.height+this.items[this.normal].down+a+i.up)),new u(t,e).arc("ne").down(s-2*r).arc("ws").addTo(this),i.format(t+2*r,e+s,d).addTo(this),new u(t+2*r+d,e+s+i.height).arc("se").up(s-2*r+i.height-this.height).arc("wn").addTo(this),s+=Math.max(r,i.height+i.down+a+(o==n?0:this.items[o+1].up))}return this}}s.Choice=(...t)=>new b(...t);class S extends p{constructor(...t){if(super("g",t),0===t.length)throw new RangeError("HorizontalChoice() must have at least one child.");if(1===t.length)return new x(t);const e=this.items.slice(0,-1),i=this.items.slice(1,-1),h=this.items[0],s=this.items[this.items.length-1];this.needsSpace=!1,this.width=r,this.width+=2*r*(this.items.length-1),this.width+=U(this.items,t=>t.width+(t.needsSpace?20:0)),this.width+=s.height>0?r:0,this.width+=r,this.height=0,this._upperTrack=Math.max(2*r,a,z(e,t=>t.up)+a),this.up=Math.max(this._upperTrack,s.up),this._lowerTrack=Math.max(a,z(i,t=>t.height+Math.max(t.down+a,2*r)),s.height+s.down+a),h.height<this._lowerTrack&&(this._lowerTrack=Math.max(this._lowerTrack,h.height+2*r)),this.down=Math.max(this._lowerTrack,h.height+h.down),n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="horizontalchoice")}format(t,e,i){var h=H(i,this.width);new u(t,e).h(h[0]).addTo(this),new u(t+h[0]+this.width,e+this.height).h(h[1]).addTo(this),t+=h[0];const s=this.items[0],n=this.items[this.items.length-1],a=this.items.slice(1);var d=U(this.items.slice(0,-1),t=>t.width+(t.needsSpace?20:0))+(this.items.length-2)*r*2-r;new u(t,e).arc("se").v(-(this._upperTrack-2*r)).arc("wn").h(d).addTo(this);var o=U(a,t=>t.width+(t.needsSpace?20:0))+(this.items.length-2)*r*2+(n.height>0?r:0)-r,l=t+r+s.width+(s.needsSpace?20:0)+2*r;new u(l,e+this._lowerTrack).h(o).arc("se").v(-(this._lowerTrack-2*r)).arc("wn").addTo(this);for(const[w,m]of function*(t){var e=0;for(const i of t)yield[e,i],e++}(this.items)){0===w?(new u(t,e).h(r).addTo(this),t+=r):(new u(t,e-this._upperTrack).arc("ne").v(this._upperTrack-2*r).arc("ws").addTo(this),t+=2*r);var c=m.width+(m.needsSpace?20:0);m.format(t,e,c).addTo(this),t+=c,w===this.items.length-1?0===m.height?new u(t,e).h(r).addTo(this):new u(t,e+m.height).arc("se").addTo(this):0===w&&m.height>this._lowerTrack?m.height-this._lowerTrack>=2*r?new u(t,e+m.height).arc("se").v(this._lowerTrack-m.height+2*r).arc("wn").addTo(this):new u(t,e+m.height).l(2*r,this._lowerTrack-m.height).addTo(this):new u(t,e+m.height).arc("ne").v(this._lowerTrack-m.height-2*r).arc("ws").addTo(this)}return this}}s.HorizontalChoice=(...t)=>new S(...t);class y extends p{constructor(t,e,...i){if(super("g",i),"number"!=typeof t||t!==Math.floor(t))throw new TypeError("The first argument of MultipleChoice() must be an integer.");if(t<0||t>=i.length)throw new RangeError("The first argument of MultipleChoice() must be an index for one of the items.");if(this.normal=t,"any"!=e&&"all"!=e)throw new SyntaxError("The second argument of MultipleChoice must be 'any' or 'all'.");this.type=e,this.needsSpace=!0,this.innerWidth=z(this.items,function(t){return t.width}),this.width=30+r+this.innerWidth+r+20,this.up=this.items[0].up,this.down=this.items[this.items.length-1].down,this.height=this.items[t].height;for(var h=0;h<this.items.length;h++){let e,i=this.items[h];e=h==t-1||h==t+1?10+r:r,h<t?this.up+=Math.max(e,i.height+i.down+a+this.items[h+1].up):h>t&&(this.down+=Math.max(e,i.up+a+this.items[h-1].down+this.items[h-1].height))}this.down-=this.items[t].height,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="multiplechoice")}format(t,e,i){var h=H(i,this.width);new u(t,e).right(h[0]).addTo(this),new u(t+h[0]+this.width,e+this.height).right(h[1]).addTo(this),t+=h[0];for(var s,n=this.items[this.normal],d=this.normal-1;d>=0;d--){var o=this.items[d];d==this.normal-1&&(s=Math.max(10+r,n.up+a+o.down+o.height)),new u(t+30,e).up(s-r).arc("wn").addTo(this),o.format(t+30+r,e-s,this.innerWidth).addTo(this),new u(t+30+r+this.innerWidth,e-s+o.height).arc("ne").down(s-o.height+this.height-r-10).addTo(this),0!==d&&(s+=Math.max(r,o.up+a+this.items[d-1].down+this.items[d-1].height))}for(new u(t+30,e).right(r).addTo(this),n.format(t+30+r,e,this.innerWidth).addTo(this),new u(t+30+r+this.innerWidth,e+this.height).right(r).addTo(this),d=this.normal+1;d<this.items.length;d++){let i=this.items[d];d==this.normal+1&&(s=Math.max(10+r,n.height+n.down+a+i.up)),new u(t+30,e).down(s-r).arc("ws").addTo(this),i.format(t+30+r,e+s,this.innerWidth).addTo(this),new u(t+30+r+this.innerWidth,e+s+i.height).arc("se").up(s-r+i.height-n.height).addTo(this),d!=this.items.length-1&&(s+=Math.max(r,i.height+i.down+a+this.items[d+1].up))}var l=new m("g",{class:"diagram-text"}).addTo(this);return new m("title",{},"any"==this.type?"take one or more branches, once each, in any order":"take all branches, once each, in any order").addTo(l),new m("path",{d:"M "+(t+30)+" "+(e-10)+" h -26 a 4 4 0 0 0 -4 4 v 12 a 4 4 0 0 0 4 4 h 26 z",class:"diagram-text"}).addTo(l),new m("text",{x:t+15,y:e+4,class:"diagram-text"},"any"==this.type?"1+":"all").addTo(l),new m("path",{d:"M "+(t+this.width-20)+" "+(e-10)+" h 16 a 4 4 0 0 1 4 4 v 12 a 4 4 0 0 1 -4 4 h -16 z",class:"diagram-text"}).addTo(l),new m("path",{d:"M "+(t+this.width-13)+" "+(e-2)+" a 4 4 0 1 0 6 -1 m 2.75 -1 h -4 v 4 m 0 -3 h 2",style:"stroke-width: 1.75"}).addTo(l),this}}s.MultipleChoice=(...t)=>new y(...t);class E extends m{constructor(t,e){if(void 0===e)return new b(1,new A,t);if("skip"===e)return new b(0,new A,t);throw"Unknown value for Optional()'s 'skip' argument."}}s.Optional=(...t)=>new E(...t);class k extends m{constructor(t,e){super("g"),e=e||new A,this.item=W(t),this.rep=W(e),this.width=Math.max(this.item.width,this.rep.width)+2*r,this.height=this.item.height,this.up=this.item.up,this.down=Math.max(2*r,this.item.down+a+this.rep.up+this.rep.height+this.rep.down),this.needsSpace=!0,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="oneormore")}format(t,e,i){var h=H(i,this.width);new u(t,e).h(h[0]).addTo(this),new u(t+h[0]+this.width,e+this.height).h(h[1]).addTo(this),t+=h[0],new u(t,e).right(r).addTo(this),this.item.format(t+r,e,this.width-2*r).addTo(this),new u(t+this.width-r,e+this.height).right(r).addTo(this);var s=Math.max(2*r,this.item.height+this.item.down+a+this.rep.up);return new u(t+r,e).arc("nw").down(s-2*r).arc("ws").addTo(this),this.rep.format(t+r,e+s,this.width-2*r).addTo(this),new u(t+this.width-r,e+s+this.rep.height).arc("se").up(s-2*r+this.rep.height-this.item.height).arc("en").addTo(this),this}walk(t){t(this),this.item.walk(t),this.rep.walk(t)}}s.OneOrMore=(...t)=>new k(...t);class j extends m{constructor(t,e,i){return new E(new k(t,e),i)}}s.ZeroOrMore=(...t)=>new j(...t);class N extends m{constructor(t,e){super("g"),this.item=W(t),this.label=e instanceof m?e:e?new O(e):void 0,this.width=Math.max(this.item.width+(this.item.needsSpace?20:0),this.label?this.label.width:0,2*r),this.height=this.item.height,this.boxUp=this.up=Math.max(this.item.up+a,r),this.label&&(this.up+=this.label.up+this.label.height+this.label.down),this.down=Math.max(this.item.down+a,r),this.needsSpace=!0,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="group")}format(t,e,i){var h=H(i,this.width);return new u(t,e).h(h[0]).addTo(this),new u(t+h[0]+this.width,e+this.height).h(h[1]).addTo(this),t+=h[0],new m("rect",{x:t,y:e-this.boxUp,width:this.width,height:this.boxUp+this.height+this.down,rx:r,ry:r,class:"group-box"}).addTo(this),this.item.format(t,e,this.width).addTo(this),this.label&&this.label.format(t,e-(this.boxUp+this.label.down+this.label.height),this.label.width).addTo(this),this}walk(t){t(this),this.item.walk(t),this.label.walk(t)}}s.Group=(...t)=>new N(...t);class _ extends m{constructor({type:t="simple",label:e}={}){super("g"),this.width=20,this.height=0,this.up=10,this.down=10,this.type=t,e&&(this.label=""+e,this.width=Math.max(20,this.label.length*c+10)),n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="start")}format(t,e){let i=new u(t,e-10);return"complex"===this.type?i.down(20).m(0,-10).right(this.width).addTo(this):i.down(20).m(10,-20).down(20).m(-10,-10).right(this.width).addTo(this),this.label&&new m("text",{x:t,y:e-15,style:"text-anchor:start"},this.label).addTo(this),this}}s.Start=(...t)=>new _(...t);class q extends m{constructor({type:t="simple"}={}){super("path"),this.width=20,this.height=0,this.up=10,this.down=10,this.type=t,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="end")}format(t,e){return"complex"===this.type?this.attrs.d="M "+t+" "+e+" h 20 m 0 -10 v 20":this.attrs.d="M "+t+" "+e+" h 20 m -10 -10 v 20 m 10 -20 v 20",this}}s.End=(...t)=>new q(...t);class C extends m{constructor(t,{href:e,title:i,cls:h}={}){super("g",{class:["terminal",h].join(" ")}),this.text=""+t,this.href=e,this.title=i,this.cls=h,this.width=this.text.length*c+20,this.height=0,this.up=11,this.down=11,this.needsSpace=!0,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="terminal")}format(t,e,i){var h=H(i,this.width);new u(t,e).h(h[0]).addTo(this),new u(t+h[0]+this.width,e).h(h[1]).addTo(this),t+=h[0],new m("rect",{x:t,y:e-11,width:this.width,height:this.up+this.down,rx:10,ry:10}).addTo(this);var s=new m("text",{x:t+this.width/2,y:e+4},this.text);return this.href?new m("a",{"xlink:href":this.href},[s]).addTo(this):s.addTo(this),this.title&&new m("title",{},[this.title]).addTo(this),this}}s.Terminal=(...t)=>new C(...t);class D extends m{constructor(t,{href:e,title:i,cls:h=""}={}){super("g",{class:["non-terminal",h].join(" ")}),this.text=""+t,this.href=e,this.title=i,this.cls=h,this.width=this.text.length*c+20,this.height=0,this.up=11,this.down=11,this.needsSpace=!0,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="nonterminal")}format(t,e,i){var h=H(i,this.width);new u(t,e).h(h[0]).addTo(this),new u(t+h[0]+this.width,e).h(h[1]).addTo(this),t+=h[0],new m("rect",{x:t,y:e-11,width:this.width,height:this.up+this.down}).addTo(this);var s=new m("text",{x:t+this.width/2,y:e+4},this.text);return this.href?new m("a",{"xlink:href":this.href},[s]).addTo(this):s.addTo(this),this.title&&new m("title",{},[this.title]).addTo(this),this}}s.NonTerminal=(...t)=>new D(...t);class O extends m{constructor(t,{href:e,title:i,cls:h=""}={}){super("g",{class:["comment",h].join(" ")}),this.text=""+t,this.href=e,this.title=i,this.cls=h,this.width=this.text.length*w+10,this.height=0,this.up=8,this.down=8,this.needsSpace=!0,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="comment")}format(t,e,i){var h=H(i,this.width);new u(t,e).h(h[0]).addTo(this),new u(t+h[0]+this.width,e+this.height).h(h[1]).addTo(this),t+=h[0];var s=new m("text",{x:t+this.width/2,y:e+5,class:"comment"},this.text);return this.href?new m("a",{"xlink:href":this.href},[s]).addTo(this):s.addTo(this),this.title&&new m("title",{},this.title).addTo(this),this}}s.Comment=(...t)=>new O(...t);class A extends m{constructor(){super("g"),this.width=0,this.height=0,this.up=0,this.down=0,this.needsSpace=!1,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="skip")}format(t,e,i){return new u(t,e).right(i).addTo(this),this}}s.Skip=(...t)=>new A(...t);class R extends m{constructor({width:t=50,up:e=15,height:i=25,down:h=15,needsSpace:s=!0}={}){super("g"),this.width=t,this.height=i,this.up=e,this.down=h,this.needsSpace=!0,n&&(this.attrs["data-updown"]=this.up+" "+this.height+" "+this.down,this.attrs["data-type"]="block")}format(t,e,i){var h=H(i,this.width);return new u(t,e).h(h[0]).addTo(this),new u(t+h[0]+this.width,e).h(h[1]).addTo(this),t+=h[0],new m("rect",{x:t,y:e-this.up,width:this.width,height:this.up+this.height+this.down}).addTo(this),this}}function L(...t){return t.reduce(function(t,e){return void 0!==t?t:e})}function H(t,e){var i=t-e;switch(l){case"left":return[0,i];case"right":return[i,0];default:return[i/2,i/2]}}function W(t){return t instanceof m?t:new C(""+t)}function U(t,e){return e||(e=function(t){return t}),t.map(e).reduce(function(t,e){return t+e},0)}function z(t,e){return e||(e=function(t){return t}),Math.max.apply(null,t.map(e))}s.Block=(...t)=>new R(...t);var G=i(74848);function I({children:t}){const e=(0,h.useRef)(null),i=(0,h.useRef)(null),[s,n]=(0,h.useState)(!1),a=e=>{if(e.current)try{const h=(...t)=>new g(...t),s=(...t)=>new C(...t),n=(...t)=>new D(...t),a=(...t)=>new E(...t),r=(...t)=>new x(...t),d=(...t)=>new b(...t),o=(...t)=>new A(...t),l=(...t)=>new O(...t),c=(...t)=>new k(...t),w=(...t)=>new j(...t),m=t.replace(/ComplexDiagram\(/g,"Diagram(").replace(/Start\([^)]*\),?\s*/g,"").replace(/,?\s*End\([^)]*\)/g,"").trim();try{const t=new Function("Diagram","Terminal","NonTerminal","Optional","Sequence","Choice","Skip","Comment","OneOrMore","ZeroOrMore",`'use strict'; return ${m};`)(h,s,n,a,r,d,o,l,c,w);if(!t||"function"!=typeof t.toSVG)throw new Error("Diagram function did not return a valid diagram object");e.current.innerHTML="";const i=t.toSVG();i.querySelectorAll("a[*|href]").forEach(t=>{const e=t.getAttributeNS("http://www.w3.org/1999/xlink","href");e&&t.setAttribute("href",e)}),e.current.appendChild(i)}catch(i){throw console.error("Error in diagram generation:",i),i}}catch(h){console.error("Error rendering railroad diagram:",h),e.current.innerHTML='<p style="color: red;">Error rendering diagram. Check console for details.</p>'}};(0,h.useEffect)(()=>{a(e)},[t]),(0,h.useEffect)(()=>{if(s){a(i);const t=t=>{"Escape"===t.key&&n(!1)};return document.addEventListener("keydown",t),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",t),document.body.style.overflow=""}}},[s,t]);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{className:"railroad-diagram-wrapper",children:[(0,G.jsx)("button",{className:"railroad-expand-button",onClick:()=>n(!0),"aria-label":"Expand diagram",title:"View full size",children:(0,G.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:(0,G.jsx)("path",{d:"M1.5 1a.5.5 0 0 0-.5.5v4a.5.5 0 0 1-1 0v-4A1.5 1.5 0 0 1 1.5 0h4a.5.5 0 0 1 0 1h-4zM10 .5a.5.5 0 0 1 .5-.5h4A1.5 1.5 0 0 1 16 1.5v4a.5.5 0 0 1-1 0v-4a.5.5 0 0 0-.5-.5h-4a.5.5 0 0 1-.5-.5zM.5 10a.5.5 0 0 1 .5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 0 1h-4A1.5 1.5 0 0 1 0 14.5v-4a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v4a1.5 1.5 0 0 1-1.5 1.5h-4a.5.5 0 0 1 0-1h4a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 1 .5-.5z"})})}),(0,G.jsx)("div",{ref:e,className:"railroad-diagram-container"})]}),s&&(0,G.jsx)("div",{className:"railroad-modal-overlay",onClick:t=>{t.target===t.currentTarget&&n(!1)},children:(0,G.jsxs)("div",{className:"railroad-modal-content",children:[(0,G.jsx)("button",{className:"railroad-modal-close",onClick:()=>n(!1),"aria-label":"Close",title:"Close (ESC)",children:"\xd7"}),(0,G.jsx)("div",{ref:i,className:"railroad-diagram-container railroad-diagram-modal"})]})})]})}}}]);