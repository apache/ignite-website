"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[5687],{10577:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"sql-reference/distribution-zones","title":"Distribution Zones","description":"{/*","source":"@site/versioned_docs/version-3.0.0/sql-reference/distribution-zones.md","sourceDirName":"sql-reference","slug":"/sql-reference/distribution-zones","permalink":"/docs/ignite3/3.0.0/sql-reference/distribution-zones","draft":false,"unlisted":false,"tags":[],"version":"3.0.0","frontMatter":{"title":"Distribution Zones","sidebar_label":"Distribution Zones"},"sidebar":"tutorialSidebar","previous":{"title":"Transactions","permalink":"/docs/ignite3/3.0.0/sql-reference/transactions"},"next":{"title":"Data Types","permalink":"/docs/ignite3/3.0.0/sql-reference/data-types"}}');var t=s(74848),l=s(28453);const d={title:"Distribution Zones",sidebar_label:"Distribution Zones"},r=void 0,a={},o=[{value:"CREATE ZONE",id:"create-zone",level:2},{value:"Keywords and parameters",id:"keywords-and-parameters",level:3},{value:"Examples",id:"examples",level:3},{value:"ALTER ZONE",id:"alter-zone",level:2},{value:"ALTER ZONE RENAME TO new_qualified_zone_name",id:"alter-zone-rename-to-new_qualified_zone_name",level:3},{value:"Keywords and parameters",id:"keywords-and-parameters-1",level:3},{value:"Examples",id:"examples-1",level:3},{value:"ALTER ZONE SET",id:"alter-zone-set",level:3},{value:"Keywords and parameters",id:"keywords-and-parameters-2",level:3},{value:"Examples",id:"examples-2",level:3},{value:"DROP ZONE",id:"drop-zone",level:2},{value:"Keywords and parameters",id:"keywords-and-parameters-3",level:3},{value:"Examples",id:"examples-3",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:["\n",(0,t.jsx)(n.p,{children:"This section describes Apache Ignite 3 distribution zones. In Apache Ignite 3, you can fine-tune distribution of your partitions on nodes for better performance and stability."}),"\n",(0,t.jsx)(n.h2,{id:"create-zone",children:"CREATE ZONE"}),"\n",(0,t.jsx)(n.p,{children:"Creates a new distribution zone."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["This can also be done via the ",(0,t.jsx)(n.a,{href:"/docs/ignite3/3.0.0/developers-guide/java-to-tables",children:"Java API"}),"."]})}),"\n","\n","\n",(0,t.jsx)(n.h3,{id:"keywords-and-parameters",children:"Keywords and parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"IF NOT EXISTS"})," - create a zone only if a different zone with the same name does not exist."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"qualified_zone_name"})," - a name of the distribution zone. Can be specified as a case-sensitive string or case-insensitive identifier. Does not need to exist at the moment of table creation, and can be created before writing data."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"STORAGE PROFILES"})," - Required. Comma-separated list of the profiles of the storage engines to use."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"PARTITIONS"})," - the number of partition the data is divided into. Partitions are then split between nodes for storage."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"REPLICAS"})," - the number of copies of each partition."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"NODES FILTER"})," - specifies the nodes that can be used to store data in the distribution zone based on node attributes. You can configure node attributes by using cli. Filter uses JSONPath rules. If the attribute is not found, all negative comparisons will be valid. For example, ",(0,t.jsx)(n.code,{children:"$[?(@.storage != 'SSD']}"})," will also include nodes without the ",(0,t.jsx)(n.code,{children:"storage"})," attribute specified."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"AUTO SCALE UP"})," - Configures automatic scaling up of the distribution zone. Possible values:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"OFF"})," - disables the automatic distribution zone adjustment."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"integer"})," - the delay in seconds between the new node joining and the start of distribution zone adjustment. Possible values are between 0 and 2147483647. Default value: 5."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"AUTO SCALE DOWN"})," - Configures automatic scaling down of the distribution zone. Possible values:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"OFF"})," - disables the automatic distribution zone adjustment. Default value."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"integer"})," - the delay in seconds between the new node joining and the start of distribution zone adjustment. Possible values are between 0 and 2147483647."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"CONSISTENCY MODE"})," - how the zone handles partition majority losses. If set to ",(0,t.jsx)(n.code,{children:"STRONG CONSISTENCY"}),", the data will become unavailable until majority is restored (typically, this means nodes leaving and returning to the cluster). ",(0,t.jsx)(n.code,{children:"HIGH AVAILABILITY"})," means that the data will be written and read from remaining nodes, accepting possible data loss. Default value: ",(0,t.jsx)(n.code,{children:"STRONG_CONSISTENCY"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"QUORUM SIZE"})," - the size of the majority of nodes in the consensus of a replication group. Quorum size is determined by the replica count."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Minimal"})," value: ",(0,t.jsx)(n.code,{children:"1"})," if there is only one replica and ",(0,t.jsx)(n.code,{children:"2"})," if there is more than one.\n",(0,t.jsx)(n.em,{children:"Maximum"})," value: half the total number of replicas rounded up."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Default values"}),": ",(0,t.jsx)(n.code,{children:"3"})," if there are 5 and more replicas. Otherwise, the smallest of 2 and the total replica count."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Creates an ",(0,t.jsx)(n.code,{children:"exampleZone"})," distribution zone that is specified as a ",(0,t.jsx)(n.em,{children:"case-insensitive"})," identifier:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE ZONE IF NOT EXISTS exampleZone STORAGE PROFILES['default'];\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Creates a ",(0,t.jsx)(n.code,{children:'"myExampleZone"'})," distribution zone that is specified as a ",(0,t.jsx)(n.em,{children:"case-sensitive"})," string:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE ZONE IF NOT EXISTS \"myExampleZone\" STORAGE PROFILES['default'];\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Creates an ",(0,t.jsx)(n.code,{children:"exampleZone"})," distribution zone that will adjust 300 seconds after cluster topology changes before adding nodes:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE ZONE IF NOT EXISTS exampleZone (AUTO SCALE UP 300) STORAGE PROFILES['default'];\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Creates an ",(0,t.jsx)(n.code,{children:"exampleZone"})," distribution zone that will wait 600 seconds before scaling down any idle nodes once the cluster topology changes:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE ZONE IF NOT EXISTS exampleZone (AUTO SCALE DOWN 600) STORAGE PROFILES['default'];\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Creates an ",(0,t.jsx)(n.code,{children:"exampleZone"})," distribution zone where data will only be stored on nodes that have SSD attribute:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE ZONE IF NOT EXISTS exampleZone (NODES FILTER '$[?(@.storage == \"SSD\")]') STORAGE PROFILES['default'];\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["The example above assumes that there are nodes that have the attribute set as shown in the ",(0,t.jsx)(n.a,{href:"/docs/ignite3/3.0.0/sql-reference/distribution-zones",children:"node filtering"})," example."]})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Creates an ",(0,t.jsx)(n.code,{children:"exampleZone"})," distribution zone with consistency mode set to ",(0,t.jsx)(n.code,{children:"HIGH_AVAILABILITY"}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE ZONE IF NOT EXISTS exampleZone (REPLICAS 5, CONSISTENCY MODE 'HIGH_AVAILABILITY') STORAGE PROFILES['default'];\n"})}),"\n",(0,t.jsx)(n.h2,{id:"alter-zone",children:"ALTER ZONE"}),"\n",(0,t.jsx)(n.p,{children:"Modifies a distribution zone."}),"\n",(0,t.jsx)(n.h3,{id:"alter-zone-rename-to-new_qualified_zone_name",children:"ALTER ZONE RENAME TO new_qualified_zone_name"}),"\n","\n",(0,t.jsx)(n.h3,{id:"keywords-and-parameters-1",children:"Keywords and parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"IF EXISTS"})," - do not throw an error if a zone with the specified name does not exist."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"qualified_zone_name"})," - the current name of the distribution zone."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"RENAME TO"})," - renames the selected zone to the new name."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"new_qualified_zone_name"})," - the new name of the distribution zone (assigned by ",(0,t.jsx)(n.code,{children:"RENAME"}),")."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"examples-1",children:"Examples"}),"\n",(0,t.jsxs)(n.p,{children:["Renames the ",(0,t.jsx)(n.code,{children:"exampleZone"})," to ",(0,t.jsx)(n.code,{children:"renamedZone"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"ALTER ZONE IF EXISTS exampleZone RENAME TO renamedZone;\n"})}),"\n",(0,t.jsx)(n.h3,{id:"alter-zone-set",children:"ALTER ZONE SET"}),"\n","\n",(0,t.jsx)(n.h3,{id:"keywords-and-parameters-2",children:"Keywords and parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"IF EXISTS"})," - do not throw an error if a zone with the specified name does not exist."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"qualified_zone_name"})," - a name of the distribution zone."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"SET"})," - assigns values to any or all of the following parameters:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"PARTITIONS"})," - the number of partitions"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"REPLICAS"})," - the number of copies of each partition."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"NODES FILTER"})," - specifies the nodes that can be used to store data in the distribution zone based on node attributes."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"AUTO SCALE"})," - Configures automatic distribution zone adjustment. Possible values:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"OFF"})," - disables the automatic distribution zone adjustment. Default value."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"integer"})," - the delay in seconds between the new node joining and the start of distribution zone adjustment. Possible values are between 0 and 2147483647."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"AUTO SCALE UP"})," - Configures automatic scaling up of the distribution zone. Possible values:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"OFF"})," - disables the automatic distribution zone adjustment. Default value."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"integer"})," - the delay in seconds between the new node joining and the start of distribution zone adjustment. Possible values are between 0 and 2147483647."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"AUTO SCALE DOWN"})," - Configures automatic scaling down of the distribution zone. Possible values:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"OFF"})," - disables the automatic distribution zone adjustment. Default value."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"QUORUM SIZE"})," - the size of the majority of nodes in the consensus of a replication group. Quorum size is determined by the replica count."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Minimal"})," value: ",(0,t.jsx)(n.code,{children:"1"})," if there is only one replica and ",(0,t.jsx)(n.code,{children:"2"})," if there is more than one.\n",(0,t.jsx)(n.em,{children:"Maximum"})," value: half the total number of replicas rounded up."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Default values"}),": ",(0,t.jsx)(n.code,{children:"3"})," if there are 5 and more replicas. Otherwise, the smallest of 2 and the total replica count."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"examples-2",children:"Examples"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Sets the number of data replicas to 10:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"ALTER ZONE IF EXISTS exampleZone SET REPLICAS 10;\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Sets data nodes filter to match the specific region, set the number of data replicas to 5 and quorum size to 3:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"ALTER ZONE IF EXISTS exampleZone SET (REPLICAS 5, QUORUM SIZE 3, NODES FILTER '$[?(@.region == \"US\")]');\n"})}),"\n",(0,t.jsx)(n.h2,{id:"drop-zone",children:"DROP ZONE"}),"\n",(0,t.jsx)(n.p,{children:"Drops an existing distribution zone."}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["This can also be done via the ",(0,t.jsx)(n.a,{href:"/docs/ignite3/3.0.0/developers-guide/java-to-tables",children:"Java API"}),"."]})}),"\n","\n",(0,t.jsx)(n.h3,{id:"keywords-and-parameters-3",children:"Keywords and parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"IF EXISTS"})," - do not throw an error if a zone with the specified name does not exist."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"qualified_zone_name"})," - the name of the distribution zone."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"examples-3",children:"Examples"}),"\n",(0,t.jsx)(n.p,{children:"Drop Person table if the one exists:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"DROP ZONE IF EXISTS exampleZone;\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>r});var i=s(96540);const t={},l=i.createContext(t);function d(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);