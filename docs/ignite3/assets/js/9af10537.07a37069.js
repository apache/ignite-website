"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[4581],{28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>o});var a=r(96540);const t={},s=a.createContext(t);function i(e){const n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(s.Provider,{value:n},e.children)}},82413:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"developers-guide/clients/ado","title":"ADO.NET Integration","description":"{/*","source":"@site/versioned_docs/version-3.0.0/developers-guide/clients/ado.md","sourceDirName":"developers-guide/clients","slug":"/developers-guide/clients/ado","permalink":"/docs/ignite3/3.0.0/developers-guide/clients/ado","draft":false,"unlisted":false,"tags":[],"version":"3.0.0","frontMatter":{"title":"ADO.NET Integration","sidebar_label":"ADO.NET"},"sidebar":"tutorialSidebar","previous":{"title":"Python","permalink":"/docs/ignite3/3.0.0/developers-guide/clients/python"},"next":{"title":"LINQ","permalink":"/docs/ignite3/3.0.0/developers-guide/clients/linq"}}');var t=r(74848),s=r(28453);const i={title:"ADO.NET Integration",sidebar_label:"ADO.NET"},o=void 0,d={},c=[{value:"Getting Started",id:"getting-started",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Installation",id:"installation",level:3},{value:"Connecting to Cluster",id:"connecting-to-cluster",level:2},{value:"Executing SQL Commands",id:"executing-sql-commands",level:2},{value:"Reading Data From Cluster",id:"reading-data-from-cluster",level:2},{value:"Using Parameters",id:"using-parameters",level:2},{value:"Transactions",id:"transactions",level:2},{value:"Full Example",id:"full-example",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:["\n",(0,t.jsxs)(n.p,{children:["Apache Ignite implements ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/dotnet/framework/data/adonet/ado-net-overview",children:"ADO.NET"})," classes, such as ",(0,t.jsx)(n.code,{children:"DbConnection"}),", ",(0,t.jsx)(n.code,{children:"DbCommand"}),", ",(0,t.jsx)(n.code,{children:"DbDataReader"}),", etc.,\r\nallowing you to use standard ADO.NET components to interact with Ignite SQL."]}),"\n",(0,t.jsx)(n.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,t.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(n.p,{children:"To use C# thin client, .NET 8.0 or newer is required."}),"\n",(0,t.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,t.jsxs)(n.p,{children:["C# client is available via NuGet. To add it, use the ",(0,t.jsx)(n.code,{children:"add package"})," command:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"dotnet add package Apache.Ignite --version 3.0.0\n"})}),"\n",(0,t.jsx)(n.h2,{id:"connecting-to-cluster",children:"Connecting to Cluster"}),"\n",(0,t.jsx)(n.p,{children:"To connect to an Apache Ignite cluster, create a new connection with the connection string:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var connStr = "Endpoints=localhost:10800";\n'})}),"\n",(0,t.jsx)(n.p,{children:"The connection string has the following parameters:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Parameter"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Endpoints"}),(0,t.jsx)(n.td,{children:"Required. Comma-separated list of server addresses with ports."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"SocketTimeout"}),(0,t.jsxs)(n.td,{children:["Time span for socket operations timeout in ",(0,t.jsx)(n.code,{children:"hh:mm:ss"})," format. 30 seconds by default."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"OperationTimeout"}),(0,t.jsxs)(n.td,{children:["Time span for operation timeout in ",(0,t.jsx)(n.code,{children:"hh:mm:ss"})," format. No timeout by default."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"HeartbeatInterval"}),(0,t.jsxs)(n.td,{children:["Time span between heartbeat messages to keep connection alive in ",(0,t.jsx)(n.code,{children:"hh:mm:ss.f"})," format. 30 seconds by default."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"ReconnectInterval"}),(0,t.jsxs)(n.td,{children:["Time span between reconnection attempts in ",(0,t.jsx)(n.code,{children:"hh:mm:ss"})," format. 30 seconds by default."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"SslEnabled"}),(0,t.jsxs)(n.td,{children:["Boolean value to enable/disable SSL encryption. ",(0,t.jsx)(n.code,{children:"False"})," by default."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Username"}),(0,t.jsx)(n.td,{children:"Username for authentication."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Password"}),(0,t.jsx)(n.td,{children:"Password for authentication."})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"The example below shows a complete connection string with all parameters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"Endpoints=localhost:10800,localhost:10801;SocketTimeout=00:00:10;OperationTimeout=00:03:30;\r\nHeartbeatInterval=00:00:05.5;ReconnectInterval=00:01:00;SslEnabled=True;Username=user;Password=pass\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Using the connection string, you can establish a connection to an Ignite cluster with the ",(0,t.jsx)(n.code,{children:"IgniteDbConnection"})," class:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var connStr = "Endpoints=localhost:10800";\r\nawait using var conn = new IgniteDbConnection(connStr);\r\nawait conn.OpenAsync();\n'})}),"\n",(0,t.jsx)(n.h2,{id:"executing-sql-commands",children:"Executing SQL Commands"}),"\n",(0,t.jsxs)(n.p,{children:["You can use the ",(0,t.jsx)(n.code,{children:"IgniteDbConnection.CreateCommand"})," method to create a command and then execute it with one of the ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/dotnet/framework/data/adonet/executing-a-command",children:"execution commands"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["The example below does not expect the command to return any rows, and uses the ",(0,t.jsx)(n.code,{children:"ExecuteNonQueryAsync"})," command."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'DbCommand cmd = conn.CreateCommand();\r\ncmd.CommandText = "DROP TABLE IF EXISTS Person";\r\nawait cmd.ExecuteNonQueryAsync();\n'})}),"\n",(0,t.jsx)(n.h2,{id:"reading-data-from-cluster",children:"Reading Data From Cluster"}),"\n",(0,t.jsxs)(n.p,{children:["You can retrieve data from the cluster in a similar way to using ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/dotnet/framework/data/adonet/retrieving-data-using-a-datareader",children:"Data Readers"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"The example below shows how you can get data from your cluster:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'DbCommand cmd = conn.CreateCommand();\r\ncmd.CommandText = "SELECT * FROM Person";\r\nawait using var reader = await cmd.ExecuteReaderAsync();\r\n\r\nwhile (await reader.ReadAsync())\r\n{\r\n    Console.WriteLine($"Person [ID={reader.GetInt32(0)}, Name={reader.GetString(1)}]");\r\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"using-parameters",children:"Using Parameters"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"Apache Ignite only supports input parameters. Parameter types are automatically inferred from the SQL query context, so you do not need to specify the parameter type explicitly."})}),"\n",(0,t.jsxs)(n.p,{children:["Apache Ignite supports parameterized queries using positional parameters. You can use the ",(0,t.jsx)(n.code,{children:"IgniteDbConnection.CreateParameter()"})," method to create parameters that will replace the ",(0,t.jsx)(n.code,{children:"?"})," placeholders in your query text."]}),"\n",(0,t.jsx)(n.p,{children:"The example below shows how you can parametrize your query:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'DbCommand cmd = conn.CreateCommand();\r\ncmd.CommandText = "INSERT INTO Person (ID, Name) VALUES (?, ?)";\r\n\r\nDbParameter idParam = cmd.CreateParameter();\r\nidParam.Value = 1;\r\ncmd.Parameters.Add(idParam);\r\n\r\nDbParameter nameParam = cmd.CreateParameter();\r\nnameParam.Value = "John Doe";\r\ncmd.Parameters.Add(nameParam);\r\n\r\nawait cmd.ExecuteNonQueryAsync();\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Parameters must be added in the exact order they appear in the query. The first ",(0,t.jsx)(n.code,{children:"?"})," corresponds to the first parameter added, the second ",(0,t.jsx)(n.code,{children:"?"})," to the second parameter, etc."]}),"\n",(0,t.jsxs)(n.p,{children:["To pass null values, set the parameter value to ",(0,t.jsx)(n.code,{children:"null"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"DbParameter param = cmd.CreateParameter();\r\nparam.Value = null;\r\ncmd.Parameters.Add(param);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"transactions",children:"Transactions"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Apache Ignite does not support custom isolation levels. All transactions are effectively ",(0,t.jsx)(n.code,{children:"Serializable"}),"."]})}),"\n",(0,t.jsxs)(n.p,{children:["You can use the ",(0,t.jsx)(n.code,{children:"DbConnection.BeginTransaction"})," method to start a transaction."]}),"\n",(0,t.jsx)(n.p,{children:"No data will be committed to the database until the transaction is committed. You can discard all changes with a rollback method:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:"await using DbTransaction tx = await conn.BeginTransactionAsync();\r\ncmd.Transaction = tx;\r\n// ...\r\n// Commit the transaction.\r\nawait tx.CommitAsync();\r\n// Roll back the transaction if needed.\r\n// await tx.RollbackAsync();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"full-example",children:"Full Example"}),"\n",(0,t.jsx)(n.p,{children:"The example below shows how you can work with an Apache Ignite cluster via ADO.NET:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'var connStr = $"Endpoints=localhost:10800";\r\nawait using var conn = new IgniteDbConnection(connStr);\r\nawait conn.OpenAsync();\r\n\r\nDbCommand createTableCmd = conn.CreateCommand();\r\ncreateTableCmd.CommandText = "CREATE TABLE IF NOT EXISTS Person (ID INT PRIMARY KEY, Name VARCHAR)";\r\nawait createTableCmd.ExecuteNonQueryAsync();\r\n\r\nDbCommand insertCmd = conn.CreateCommand();\r\ninsertCmd.CommandText = "INSERT INTO Person (ID, Name) VALUES (?, ?)";\r\n\r\nawait using DbTransaction tx = await conn.BeginTransactionAsync();\r\ninsertCmd.Transaction = tx;\r\n\r\nDbParameter idParam = insertCmd.CreateParameter();\r\ninsertCmd.Parameters.Add(idParam);\r\n\r\nDbParameter nameParam = insertCmd.CreateParameter();\r\ninsertCmd.Parameters.Add(nameParam);\r\n\r\nfor (var i = 1; i <= 3; i++)\r\n{\r\n    idParam.Value = i;\r\n    nameParam.Value = "Person " + i;\r\n    await insertCmd.ExecuteNonQueryAsync();\r\n}\r\n\r\nawait tx.CommitAsync();\r\n\r\nDbCommand selectCmd = conn.CreateCommand();\r\nselectCmd.CommandText = "SELECT * FROM Person WHERE ID > ?";\r\n\r\nDbParameter selectParam = selectCmd.CreateParameter();\r\nselectParam.Value = 1;\r\nselectCmd.Parameters.Add(selectParam);\r\n\r\nawait using var reader = await selectCmd.ExecuteReaderAsync();\r\n\r\nfor (var i = 0; i < reader.FieldCount; i++)\r\n{\r\n    Console.WriteLine($"{reader.GetName(i)}: {reader.GetFieldType(i)}");\r\n}\r\n\r\nwhile (await reader.ReadAsync())\r\n{\r\n    int id = reader.GetInt32(0);\r\n    string name = reader.GetString(1);\r\n\r\n    Console.WriteLine($"Person [ID={id}, Name={name}]");\r\n}\n'})})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}}}]);